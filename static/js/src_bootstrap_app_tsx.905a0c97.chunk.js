(globalThis.webpackChunksen_farming=globalThis.webpackChunksen_farming||[]).push([["src_bootstrap_app_tsx"],{98463:(e,t,s)=>{"use strict";s.r(t),s.d(t,{ReactComponent:()=>h,default:()=>p});var r,a,n,i,o,d,l,c=s(92950);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},u.apply(this,arguments)}function m(e,t){let{title:s,titleId:m,...h}=e;return c.createElement("svg",u({width:257,height:256,viewBox:"0 0 257 256",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":m},h),s?c.createElement("title",{id:m},s):null,r||(r=c.createElement("path",{d:"M0.622803 60C0.622803 26.8629 27.4857 0 60.6228 0H196.623C229.76 0 256.623 26.8629 256.623 60V196C256.623 229.137 229.76 256 196.623 256H60.6228C27.4857 256 0.622803 229.137 0.622803 196V60Z",fill:"url(#paint0_linear_1802_5774)"})),a||(a=c.createElement("path",{d:"M211.234 115.694H216.613C216.977 115.694 221.629 115.549 219.158 109.01C216.541 102.181 208.4 101.745 208.4 101.745L196.042 56.919C196.042 56.919 194.516 49 186.738 49C178.888 49 113.83 49 113.83 49C113.83 49 103.799 49.218 103.799 60.261H113.249L102.055 102.399H91.006V79.877C91.006 79.877 90.9333 72.2486 83.1555 72.2486C75.305 72.2486 72.7609 72.2486 72.7609 72.2486L75.9593 80.4582H81.1929C81.1929 80.4582 81.2656 80.4582 81.3383 80.4582C81.7744 80.4582 83.0828 80.6762 83.0828 83.219C83.0828 86.2704 83.0828 102.617 83.0828 102.617H47.683C47.683 102.617 47.683 102.617 47.6103 102.617C46.6654 102.617 34.8897 102.835 34.8897 114.677C34.8897 127.028 37.1431 148.824 37.1431 148.824C29.0018 154.636 23.6228 164.226 23.6228 175.123C23.6228 192.923 38.088 207.308 55.8969 207.308C73.7059 207.308 88.1711 192.85 88.1711 175.051C88.1711 167.858 85.7723 161.174 81.7744 155.798H93.6228L96.1669 162.555H122.117L124.37 155.507L133.457 155.58C133.457 156.161 133.457 156.67 133.457 157.251C133.457 184.859 155.845 207.308 183.54 207.308C211.162 207.308 233.623 184.931 233.623 157.251C233.477 139.96 224.609 124.703 211.234 115.694ZM55.9696 191.979C46.52 191.979 38.8149 184.278 38.8149 174.833C38.8149 165.388 46.52 157.687 55.9696 157.687C65.4193 157.687 73.1244 165.388 73.1244 174.833C73.1971 184.278 65.492 191.979 55.9696 191.979ZM159.261 63.3124C159.261 62.8765 159.334 60.6243 161.079 58.9533C161.878 58.1541 163.259 57.2096 165.585 57.2096H185.502C186.302 57.2096 190.445 57.5729 191.899 64.1116C192.989 68.8339 198.95 93.8261 199.168 94.9159C199.313 95.4971 199.968 98.4032 198.223 100.728C197.423 101.818 195.824 103.053 192.917 103.053H165.585C163.041 103.053 159.334 101.382 159.334 96.7322V63.3124H159.261ZM118.119 103.344C118.046 103.344 117.974 103.344 117.901 103.344C117.61 103.344 114.775 103.053 113.104 100.801C112.304 99.7836 111.504 98.0399 112.086 95.3518C113.031 90.9927 119.137 62.0773 119.21 61.7867C119.21 61.7141 119.21 61.6414 119.282 61.4961C119.791 59.8978 121.608 57.2096 125.315 57.2096H149.085C151.484 57.2096 155.336 58.9533 155.336 63.5304V97.6767C155.336 97.7493 155.336 97.822 155.336 97.822C155.191 100.002 153.446 103.271 149.158 103.271H118.119V103.344ZM183.54 190.453C165.44 190.453 150.684 175.705 150.684 157.614C150.684 139.524 165.44 124.776 183.54 124.776C201.639 124.776 216.395 139.524 216.395 157.614C216.395 175.705 201.639 190.453 183.54 190.453Z",fill:"#212433"})),n||(n=c.createElement("path",{opacity:.5,d:"M198.223 100.728C197.423 101.818 195.824 103.053 192.917 103.053H165.585C163.041 103.053 159.334 101.382 159.334 96.7323V63.3125C159.334 62.8766 159.407 60.6244 161.151 58.9534C161.951 58.1542 163.332 57.2097 165.658 57.2097H185.575C186.374 57.2097 190.518 57.573 191.972 64.1116C193.062 68.834 199.022 93.8262 199.241 94.916C199.313 95.5699 199.967 98.4759 198.223 100.728Z",fill:"#212433"})),i||(i=c.createElement("path",{opacity:.5,d:"M155.336 63.5303V97.6766C155.336 97.7493 155.336 97.8219 155.336 97.8219C155.191 100.002 153.446 103.271 149.158 103.271H118.119C118.047 103.271 117.974 103.271 117.901 103.271C117.61 103.271 114.776 102.98 113.104 100.728C112.304 99.7109 111.505 97.9673 112.086 95.2791C113.031 90.92 119.137 62.0046 119.21 61.714C119.21 61.6414 119.21 61.5687 119.282 61.4234C119.791 59.8251 121.608 57.137 125.316 57.137H149.085C151.484 57.2096 155.336 58.9533 155.336 63.5303Z",fill:"#212433"})),o||(o=c.createElement("path",{opacity:.5,d:"M183.54 127.464C166.967 127.464 153.446 140.977 153.446 157.542C153.446 174.106 166.967 187.62 183.54 187.62C200.113 187.62 213.633 174.106 213.633 157.542C213.633 140.977 200.113 127.464 183.54 127.464ZM183.54 172.944C175.035 172.944 168.202 166.042 168.202 157.614C168.202 149.114 175.108 142.285 183.54 142.285C192.044 142.285 198.877 149.187 198.877 157.614C198.877 166.042 191.972 172.944 183.54 172.944Z",fill:"#212433"})),d||(d=c.createElement("path",{opacity:.5,d:"M55.9694 160.375C48.0463 160.375 41.5769 166.841 41.5769 174.76C41.5769 182.679 48.0463 189.145 55.9694 189.145C63.8926 189.145 70.362 182.679 70.362 174.76C70.4346 166.841 63.9653 160.375 55.9694 160.375ZM55.9694 181.807C52.1169 181.807 48.9185 178.683 48.9185 174.76C48.9185 170.91 52.0442 167.713 55.9694 167.713C59.822 167.713 63.0203 170.837 63.0203 174.76C63.0203 178.683 59.8947 181.807 55.9694 181.807Z",fill:"#212433"})),l||(l=c.createElement("defs",null,c.createElement("linearGradient",{id:"paint0_linear_1802_5774",x1:.999999,y1:-114739e-11,x2:257,y2:256,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#FFD666"}),c.createElement("stop",{offset:1,stopColor:"#FFE58F"})))))}const h=c.forwardRef(m),p=s.p+"static/media/logo.4510beb32107f8e07e512c69e06f7545.svg"},45597:(e,t,s)=>{"use strict";Object.defineProperty(t,"X$",{value:!0}),Object.defineProperty(t,"jY",{enumerable:!0,get:function(){return i.default}}),t.h0=void 0,Object.defineProperty(t,"ng",{enumerable:!0,get:function(){return o.default}});var r=d(s(70854)),a=d(s(27803)),n=d(s(85468)),i=d(s(98463)),o=d(s(83272));function d(e){return e&&e.__esModule?e:{default:e}}const l=[r.default,a.default,n.default];t.h0=l},28871:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Page:()=>Lt,__esModule:()=>Nt.X$,logo:()=>Nt.jY,panels:()=>Nt.h0,readme:()=>Nt.ng});var r=s(55754),a=s(78385),n=s(45055),i=s(69716),o=s(94751);const d={appId:"sen_farming",url:"https://descartesnetwork.github.io/sen-farming/index.js"},l={development:{...d},staging:{...d},production:{...d}};var c=s(42224),u=s(10119),m=s(98868),h=s(33804),p=s(81165),y=s(95418),f=s(97429).Buffer;const g=s(70320),w=["Invalid instruction","Invalid owner","Incorrect program id","Already constructed","Operation overflowed","Farm unmatched","Farm frozen","Zero value","Insufficient funds","Must fully harvested first","Must fully unstaked first","Inconsistent treasury balance"],x=e=>f.from(u.sha256.digest(`account:${(0,m.Z)(e,{pascalCase:!0})}`)).slice(0,8),b={version:"0.1.0",name:"sen_utility",instructions:[],accounts:[{name:"farm",type:{kind:"struct",fields:[{name:"owner",type:"publicKey"},{name:"state",type:"u8"},{name:"mintStake",type:"publicKey"},{name:"treasuryStake",type:"publicKey"},{name:"mintReward",type:"publicKey"},{name:"treasuryReward",type:"publicKey"},{name:"genesisTimestamp",type:"i64"},{name:"totalShares",type:"u64"},{name:"reward",type:"u64"},{name:"period",type:"u64"},{name:"compensation",type:"i128"}]}},{name:"debt",type:{kind:"struct",fields:[{name:"farm",type:"publicKey"},{name:"owner",type:"publicKey"},{name:"shares",type:"u64"},{name:"debt",type:"u128"},{name:"isInitialized",type:"bool"}]}}],events:[],errors:[]};class j extends p.default{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y.DEFAULT_FARMING_PROGRAM_ADDRESS,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.DEFAULT_SPLT_PROGRAM_ADDRESS,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.DEFAULT_SPLATA_PROGRAM_ADDRESS,r=arguments.length>3?arguments[3]:void 0;if(super(r,w),this.farmingProgramId=void 0,this.spltProgramId=void 0,this.splataProgramId=void 0,this._splt=void 0,this.watch=(e,t)=>this.connection.onProgramAccountChange(this.farmingProgramId,(t=>{let{accountId:s,accountInfo:{data:r}}=t;const a=s.toBase58(),n=new g.struct(y.schema.FARM_SCHEMA).space,i=new g.struct(y.schema.DEBT_SCHEMA).space;let o=null,d={};return r.length===n&&(o="farm",d=this.parseFarmData(r)),r.length===i&&(o="debt",d=this.parseDebtData(r)),o?e(null,{type:o,address:a,data:d}):e("Unmatched type",null)}),"confirmed",t),this.unwatch=async e=>{if(e)return await this.connection.removeProgramAccountChangeListener(e)},this.deriveDebtAddress=async(e,t)=>{if(!y.account.isAddress(e))throw new Error("Invalid owner address");if(!y.account.isAddress(t))throw new Error("Invalid farm address");const s=y.account.fromAddress(e),r=y.account.fromAddress(t),a=[s.toBuffer(),r.toBuffer(),this.farmingProgramId.toBuffer()],[n]=await c.PublicKey.findProgramAddress(a,this.farmingProgramId);return n.toBase58()},this.parseFarmData=e=>{let t=x("farm");const s=new h.$r(b,this.farmingProgramId,new h.Y7(null,null,{skipPreflight:!1})).coder.accounts.decode("farm",f.concat([t,e]));return{compensation:BigInt(s.compensation.toString()),genesis_timestamp:BigInt(s.genesisTimestamp.toString()),mint_reward:s.mintReward.toString(),mint_stake:s.mintStake.toString(),owner:s.owner.toString(),period:BigInt(s.period.toString()),reward:BigInt(s.reward.toString()),state:s.state,total_shares:BigInt(s.totalShares.toString()),treasury_reward:s.treasuryReward.toString(),treasury_stake:s.treasuryStake.toString()}},this.getFarmData=async e=>{if(!y.account.isAddress(e))throw new Error("Invalid farm address");const t=y.account.fromAddress(e),{data:s}=await this.connection.getAccountInfo(t)||{};if(!s)throw new Error(`Cannot read data of ${e}`);return this.parseFarmData(s)},this.parseDebtData=e=>{let t=x("debt");const s=new h.$r(b,this.farmingProgramId,new h.Y7(null,null,{skipPreflight:!1})).coder.accounts.decode("debt",f.concat([t,e]));return{farm:s.farm.toString(),owner:s.owner.toString(),shares:BigInt(s.shares.toString()),debt:BigInt(s.debt.toString()),is_initialized:s.isInitialized}},this.getDebtData=async e=>{if(!y.account.isAddress(e))throw new Error("Invalid debt address");const t=y.account.fromAddress(e),{data:s}=await this.connection.getAccountInfo(t)||{};if(!s)throw new Error(`Cannot read data of ${e}`);return this.parseDebtData(s)},this.initializeFarm=async(e,t,s,r,a,n)=>{if(!y.account.isAddress(s))throw new Error("Invalid owner address");if(!y.account.isAddress(r))throw new Error("Invalid mint stake address");if(!y.account.isAddress(a))throw new Error("Invalid mint reward address");const i=await y.account.createStrictAccount(this.farmingProgramId),o=i.publicKey.toBase58(),d=y.account.fromAddress(s),l=y.account.fromAddress(r),u=y.account.fromAddress(a),m=await n.getAddress(),h=y.account.fromAddress(m),p=[i.publicKey.toBuffer()],f=await c.PublicKey.createProgramAddress(p,this.farmingProgramId),w=f.toBase58(),x=y.account.fromAddress(await this._splt.deriveAssociatedAddress(w,r)),b=y.account.fromAddress(await this._splt.deriveAssociatedAddress(w,a));let j=new c.Transaction;j=await this.addRecentCommitment(j);const A=new g.struct([{key:"code",type:"u8"},{key:"reward",type:"u64"},{key:"period",type:"u64"}],{code:0,reward:e,period:t}),S=new c.TransactionInstruction({keys:[{pubkey:h,isSigner:!0,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:i.publicKey,isSigner:!0,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:x,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:this.spltProgramId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:this.splataProgramId,isSigner:!1,isWritable:!1}],programId:this.farmingProgramId,data:A.toBuffer()});j.add(S),j.feePayer=h,j=await n.signTransaction(j),j=await this.selfSign(j,i);return{txId:await this.sendTransaction(j),farmAddress:o}},this.initializeAccounts=async(e,t,s)=>{if(!y.account.isAddress(e))throw new Error("Invalid farm address");if(!y.account.isAddress(t))throw new Error("Invalid owner address");const{mint_reward:r}=await this.getFarmData(e),a=await this._splt.deriveAssociatedAddress(t,r),n=await this.deriveDebtAddress(t,e),i=y.account.fromAddress(t),o=y.account.fromAddress(e),d=y.account.fromAddress(r),l=y.account.fromAddress(a),u=y.account.fromAddress(n),m=await s.getAddress(),h=y.account.fromAddress(m);let p=new c.Transaction;p=await this.addRecentCommitment(p);const f=new g.struct([{key:"code",type:"u8"}],{code:1}),w=new c.TransactionInstruction({keys:[{pubkey:h,isSigner:!0,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:this.spltProgramId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:this.splataProgramId,isSigner:!1,isWritable:!1}],programId:this.farmingProgramId,data:f.toBuffer()});p.add(w),p.feePayer=h,p=await s.signTransaction(p);return{txId:await this.sendTransaction(p),rewardedAddress:a,debtAddress:n}},this.stake=async(e,t,s,r,a)=>{if(!y.account.isAddress(t))throw new Error("Invalid source address");if(!y.account.isAddress(s))throw new Error("Invalid rewarded address");if(!y.account.isAddress(r))throw new Error("Invalid farm address");const n=await a.getAddress(),i=y.account.fromAddress(n),{treasury_stake:o,mint_stake:d,treasury_reward:l,mint_reward:u}=await this.getFarmData(r),m=await this.deriveDebtAddress(n,r),h=y.account.fromAddress(r),p=y.account.fromAddress(t),f=y.account.fromAddress(o),w=y.account.fromAddress(d),x=y.account.fromAddress(s),b=y.account.fromAddress(l),j=y.account.fromAddress(u),A=y.account.fromAddress(m),S=[h.toBuffer()],k=await c.PublicKey.createProgramAddress(S,this.farmingProgramId);let C=new c.Transaction;C=await this.addRecentCommitment(C);const v=new g.struct([{key:"code",type:"u8"},{key:"amount",type:"u64"}],{code:2,amount:e}),T=new c.TransactionInstruction({keys:[{pubkey:i,isSigner:!0,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:A,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:x,isSigner:!1,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:j,isSigner:!1,isWritable:!1},{pubkey:k,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:this.spltProgramId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:this.splataProgramId,isSigner:!1,isWritable:!1}],programId:this.farmingProgramId,data:v.toBuffer()});C.add(T),C.feePayer=i,C=await a.signTransaction(C);return{txId:await this.sendTransaction(C),debtAddress:m}},this.unstake=async(e,t,s,r,a)=>{if(!y.account.isAddress(t))throw new Error("Invalid destination address");if(!y.account.isAddress(s))throw new Error("Invalid rewarded address");if(!y.account.isAddress(r))throw new Error("Invalid farm address");const n=await a.getAddress(),i=y.account.fromAddress(n),{treasury_stake:o,mint_stake:d,treasury_reward:l,mint_reward:u}=await this.getFarmData(r),m=await this.deriveDebtAddress(n,r),h=y.account.fromAddress(r),p=y.account.fromAddress(m),f=y.account.fromAddress(t),w=y.account.fromAddress(o),x=y.account.fromAddress(d),b=y.account.fromAddress(s),j=y.account.fromAddress(l),A=y.account.fromAddress(u),S=[h.toBuffer()],k=await c.PublicKey.createProgramAddress(S,this.farmingProgramId);let C=new c.Transaction;C=await this.addRecentCommitment(C);const v=new g.struct([{key:"code",type:"u8"},{key:"amount",type:"u64"}],{code:3,amount:e}),T=new c.TransactionInstruction({keys:[{pubkey:i,isSigner:!0,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!0},{pubkey:x,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:j,isSigner:!1,isWritable:!0},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:k,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:this.spltProgramId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:this.splataProgramId,isSigner:!1,isWritable:!1}],programId:this.farmingProgramId,data:v.toBuffer()});C.add(T),C.feePayer=i,C=await a.signTransaction(C);return{txId:await this.sendTransaction(C),debtAddress:m}},this.harvest=async(e,t,s)=>{if(!y.account.isAddress(e))throw new Error("Invalid farm address");if(!y.account.isAddress(t))throw new Error("Invalid rewarded address");const r=await s.getAddress(),a=y.account.fromAddress(r),{treasury_stake:n,treasury_reward:i,mint_reward:o}=await this.getFarmData(e),d=await this.deriveDebtAddress(r,e),l=y.account.fromAddress(e),u=y.account.fromAddress(n),m=y.account.fromAddress(t),h=y.account.fromAddress(i),p=y.account.fromAddress(o),f=y.account.fromAddress(d),w=[l.toBuffer()],x=await c.PublicKey.createProgramAddress(w,this.farmingProgramId);let b=new c.Transaction;b=await this.addRecentCommitment(b);const j=new g.struct([{key:"code",type:"u8"}],{code:4}),A=new c.TransactionInstruction({keys:[{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:x,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:this.spltProgramId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:this.splataProgramId,isSigner:!1,isWritable:!1}],programId:this.farmingProgramId,data:j.toBuffer()});b.add(A),b.feePayer=a,b=await s.signTransaction(b);return{txId:await this.sendTransaction(b),debtAddress:d}},this.seed=async(e,t,s,r)=>{if(!y.account.isAddress(t))throw new Error("Invalid farm address");if(!y.account.isAddress(s))throw new Error("Invalid source address");const{treasury_reward:a}=await this.getFarmData(t),n=y.account.fromAddress(t),i=y.account.fromAddress(s),o=y.account.fromAddress(a),d=await r.getAddress(),l=y.account.fromAddress(d);let u=new c.Transaction;u=await this.addRecentCommitment(u);const m=new g.struct([{key:"code",type:"u8"},{key:"amount",type:"u64"}],{code:7,amount:e}),h=new c.TransactionInstruction({keys:[{pubkey:l,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:this.spltProgramId,isSigner:!1,isWritable:!1}],programId:this.farmingProgramId,data:m.toBuffer()});u.add(h),u.feePayer=l,u=await r.signTransaction(u);return{txId:await this.sendTransaction(u)}},this.unseed=async(e,t,s,r)=>{if(!y.account.isAddress(t))throw new Error("Invalid farm address");if(!y.account.isAddress(s))throw new Error("Invalid destination address");const{treasury_reward:a}=await this.getFarmData(t),n=y.account.fromAddress(t),i=y.account.fromAddress(s),o=y.account.fromAddress(a),d=await r.getAddress(),l=y.account.fromAddress(d),u=[n.toBuffer()],m=await c.PublicKey.createProgramAddress(u,this.farmingProgramId);let h=new c.Transaction;h=await this.addRecentCommitment(h);const p=new g.struct([{key:"code",type:"u8"},{key:"amount",type:"u64"}],{code:8,amount:e}),f=new c.TransactionInstruction({keys:[{pubkey:l,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:this.spltProgramId,isSigner:!1,isWritable:!1}],programId:this.farmingProgramId,data:p.toBuffer()});h.add(f),h.feePayer=l,h=await r.signTransaction(h);return{txId:await this.sendTransaction(h)}},this.freeze=async(e,t)=>{if(!y.account.isAddress(e))throw new Error("Invalid farmaddress");const s=y.account.fromAddress(e),r=await t.getAddress(),a=y.account.fromAddress(r);let n=new c.Transaction;n=await this.addRecentCommitment(n);const i=new g.struct([{key:"code",type:"u8"}],{code:5}),o=new c.TransactionInstruction({keys:[{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0}],programId:this.farmingProgramId,data:i.toBuffer()});n.add(o),n.feePayer=a,n=await t.signTransaction(n);return{txId:await this.sendTransaction(n)}},this.thaw=async(e,t)=>{if(!y.account.isAddress(e))throw new Error("Invalid farm address");const s=y.account.fromAddress(e),r=await t.getAddress(),a=y.account.fromAddress(r);let n=new c.Transaction;n=await this.addRecentCommitment(n);const i=new g.struct([{key:"code",type:"u8"}],{code:6}),o=new c.TransactionInstruction({keys:[{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0}],programId:this.farmingProgramId,data:i.toBuffer()});n.add(o),n.feePayer=a,n=await t.signTransaction(n);return{txId:await this.sendTransaction(n)}},this.transferFarmOwnership=async(e,t,s)=>{if(!y.account.isAddress(e))throw new Error("Invalid farm address");if(!y.account.isAddress(t))throw new Error("Invalid new owner address");const r=y.account.fromAddress(e),a=y.account.fromAddress(t),n=await s.getAddress(),i=y.account.fromAddress(n);let o=new c.Transaction;o=await this.addRecentCommitment(o);const d=new g.struct([{key:"code",type:"u8"}],{code:9}),l=new c.TransactionInstruction({keys:[{pubkey:i,isSigner:!0,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1}],programId:this.farmingProgramId,data:d.toBuffer()});o.add(l),o.feePayer=i,o=await s.signTransaction(o);return{txId:await this.sendTransaction(o)}},this.closeDebt=async(e,t)=>{if(!y.account.isAddress(e))throw new Error("Invalid farm address");const s=await t.getAddress(),r=y.account.fromAddress(s),a=await this.deriveDebtAddress(s,e),n=y.account.fromAddress(e),i=y.account.fromAddress(a);let o=new c.Transaction;o=await this.addRecentCommitment(o);const d=new g.struct([{key:"code",type:"u8"}],{code:10}),l=new c.TransactionInstruction({keys:[{pubkey:r,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0}],programId:this.farmingProgramId,data:d.toBuffer()});o.add(l),o.feePayer=r,o=await t.signTransaction(o);return{txId:await this.sendTransaction(o)}},this.closeFarm=async(e,t)=>{if(!y.account.isAddress(e))throw new Error("Invalid farm address");const s=await t.getAddress(),r=y.account.fromAddress(s),{treasury_reward:a,mint_reward:n}=await this.getFarmData(e),i=await this._splt.deriveAssociatedAddress(s,n),o=y.account.fromAddress(e),d=y.account.fromAddress(a),l=y.account.fromAddress(i),u=[o.toBuffer()],m=await c.PublicKey.createProgramAddress(u,this.farmingProgramId);let h=new c.Transaction;h=await this.addRecentCommitment(h);const p=new g.struct([{key:"code",type:"u8"}],{code:11}),f=new c.TransactionInstruction({keys:[{pubkey:r,isSigner:!0,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:this.spltProgramId,isSigner:!1,isWritable:!1}],programId:this.farmingProgramId,data:p.toBuffer()});h.add(f),h.feePayer=r,h=await t.signTransaction(h);return{txId:await this.sendTransaction(h)}},this.rid=async(e,t,s,r)=>{if(!y.account.isAddress(e))throw new Error("Invalid destination address");if(!y.account.isAddress(t))throw new Error("Invalid rewarded address");if(!y.account.isAddress(s))throw new Error("Invalid farm address");const a=await r.getAddress(),n=y.account.fromAddress(a),{treasury_stake:i,mint_stake:o,treasury_reward:d,mint_reward:l}=await this.getFarmData(s),u=await this.deriveDebtAddress(a,s),m=y.account.fromAddress(s),h=y.account.fromAddress(u),p=y.account.fromAddress(e),f=y.account.fromAddress(i),w=y.account.fromAddress(o),x=y.account.fromAddress(t),b=y.account.fromAddress(d),j=y.account.fromAddress(l),A=[m.toBuffer()],S=await c.PublicKey.createProgramAddress(A,this.farmingProgramId);let k=new c.Transaction;k=await this.addRecentCommitment(k);const C=new g.struct([{key:"code",type:"u8"}],{code:12}),v=new c.TransactionInstruction({keys:[{pubkey:n,isSigner:!0,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:x,isSigner:!1,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:j,isSigner:!1,isWritable:!1},{pubkey:S,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:this.spltProgramId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:this.splataProgramId,isSigner:!1,isWritable:!1}],programId:this.farmingProgramId,data:C.toBuffer()});k.add(v),k.feePayer=n,k=await r.signTransaction(k);return{txId:await this.sendTransaction(k),debtAddress:u}},!y.account.isAddress(e))throw new Error("Invalid farming program address");if(!y.account.isAddress(t))throw new Error("Invalid SPL token program address");if(!y.account.isAddress(s))throw new Error("Invalid SPL associated token program address");this.farmingProgramId=y.account.fromAddress(e),this.spltProgramId=y.account.fromAddress(t),this.splataProgramId=y.account.fromAddress(s),this._splt=new y.SPLT(t,s,r)}}const A=j,S={devnet:{spltAddress:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",splataAddress:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",senAddress:"5YwUkPdXLoujGkZuo9B4LsLKj3hdkDcfP4derpspifSJ",farmingAddress:"CpEsjrLhBkcuApn5uEE2tZCwxyCQKmT6S4YgT9zuLW2J",get farming(){return new A(this.farmingAddress,this.spltAddress,this.splataAddress,a.rpc)},senOwners:["GJLqpmDxxrV9xruee2vFvEoTho7VVQHRtuHH8nfoAE54"]},testnet:{spltAddress:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",splataAddress:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",senAddress:"5YwUkPdXLoujGkZuo9B4LsLKj3hdkDcfP4derpspifSJ",farmingAddress:"CpEsjrLhBkcuApn5uEE2tZCwxyCQKmT6S4YgT9zuLW2J",get farming(){return new A(this.farmingAddress,this.spltAddress,this.splataAddress,a.rpc)},senOwners:["GJLqpmDxxrV9xruee2vFvEoTho7VVQHRtuHH8nfoAE54"]},mainnet:{spltAddress:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",splataAddress:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",senAddress:"SENBBKVCM7homnf5RX9zqpf1GFe935hnbU4uVzY1Y6M",farmingAddress:"DTvdh6Q13SfYxMoWyibBUmQAUqd2pDPSpjdku5a9NLSF",get farming(){return new A(this.farmingAddress,this.spltAddress,this.splataAddress,a.rpc)},senOwners:["Cs6jYywHTAgdvjxn8xG4VkJJH8DXXy7zbtatzMUWoCMG"]}},k={development:{farmRoute:"/app/senhub"},staging:{farmRoute:"/app/sen_farming"},production:{farmRoute:"/app/sen_farming"}},C={manifest:l[a.env],sol:S[a.net],route:k[a.env]};var v=s(92950);const T={address:"",icon:"",name:"TOKEN",price:0,priceChange:0,rank:0,symbol:"TOKEN",totalVolume:0},I=e=>{const[t,s]=(0,v.useState)(T),{tokenProvider:r}=(0,a.useMint)(),n=(0,v.useCallback)((async()=>{try{var t;const n=await r.findByAddress(e),i=null===n||void 0===n||null===(t=n.extensions)||void 0===t?void 0:t.coingeckoId,o=await a.util.fetchCGK(i);return s(o)}catch(n){return s(T)}}),[e,r]);return(0,v.useEffect)((()=>{n()}),[n]),t},P=e=>{const{tokenProvider:t}=(0,a.useMint)(),{pools:s}=(0,a.usePool)(),[r,n]=(0,v.useState)([]),i=(0,v.useCallback)((async()=>{const r=await t.findByAddress(e);if(r)return n([r]);const a=Object.values(s).find((t=>{let{mint_lpt:s}=t;return s===e}));if(!a)return n([void 0]);const{mint_a:i,mint_b:o}=a,d=await t.findByAddress(i),l=await t.findByAddress(o);return n([d,l])}),[e,s,t]);return(0,v.useEffect)((()=>{i()}),[i]),r};var E=s(45263);const _=e=>{let{mintAddress:t,size:s=24,icon:r=(0,E.jsx)(i.Z,{name:"diamond-outline"}),isReserve:a=!1}=e;const n=P(t),d=(0,v.useMemo)((()=>{const e=JSON.parse(JSON.stringify(n));return a?e.reverse():e}),[a,n]);return(0,E.jsx)(o.Avatar.Group,{style:{display:"block",whiteSpace:"nowrap"},children:d.map(((e,t)=>(0,E.jsx)(o.Avatar,{src:null===e||void 0===e?void 0:e.logoURI,size:s,style:{backgroundColor:"#2D3355",border:"none"},children:r},(null===e||void 0===e?void 0:e.address)||t)))})},R=e=>{let{mintAddress:t,separator:s=" \u2022 ",isReverse:r=!1}=e;const n=P(t),i=(0,v.useMemo)((()=>{let e=n.map((e=>{if(!e)return a.util.shortenAddress(t);const{name:s,address:r,symbol:i}=e;return 1===n.length&&s?s:i||a.util.shortenAddress(r)}));return r&&e.reverse(),e.join(s),1===n.length?e:`${e} LPT`}),[r,t,s,n]);return(0,E.jsx)("span",{children:i})},W=e=>{let{mintAddress:t,separator:s=" \u2022 ",isReverse:r=!1}=e;const a=P(t),n=(0,v.useMemo)((()=>{const e=a.map((e=>{const s=`${null===t||void 0===t?void 0:t.substr(0,3)}...`;return e?e.symbol:s}));return r&&e.reverse(),e.join(s)}),[r,t,s,a]);return(0,E.jsx)("span",{children:n})},B=()=>{const{tokenProvider:e,getMint:t}=(0,a.useMint)(),{pools:s}=(0,a.usePool)(),r=(0,v.useCallback)((async(t,s)=>{try{var r;const n=await e.findByAddress(t),i=null===n||void 0===n||null===(r=n.extensions)||void 0===r?void 0:r.coingeckoId;if(!i)throw new Error("Cant not find coingeckoId");const o=await a.util.fetchCGK(i);return Number(y.utils.undecimalize(s,n.decimals))*o.price}catch(n){return 0}}),[e]),n=(0,v.useCallback)((async a=>{let{mintAddress:i,amount:o}=a;if(await e.findByAddress(i))return r(i,o);const d=Object.values(s).find((e=>e.mint_lpt===i));if(!d)return 0;const{reserve_a:l,reserve_b:c,mint_a:u,mint_b:m}=d;if(l*c===BigInt(0))return 0;const{[i]:{supply:h}}=await t({address:i}),{deltaA:p,deltaB:f}=y.Swap.oracle.withdraw(o,h,l,c);return await n({mintAddress:u,amount:p})+await n({mintAddress:m,amount:f})}),[t,r,e,s]);return{getTotalValue:n}},{sol:{senOwners:F}}=C,z=()=>{const e=(0,r.useSelector)((e=>e.farms)),[t,s]=(0,v.useState)({}),a=(0,v.useCallback)((t=>{const s=e[t];return F.includes(s.owner)}),[e]),n=(0,v.useCallback)((e=>{const t={};for(const s in e)a(s)&&(t[s]=e[s]);s(t)}),[a]);return(0,v.useEffect)((()=>{n(e)}),[e,n]),{sentreFarms:t,filterSentreFarms:n,checkSentreFarm:a}},{sol:{senAddress:M}}=C,D=()=>{const{ui:{width:e}}=(0,a.useUI)(),t=(0,r.useSelector)((e=>e.farms)),s=I(M),n=(()=>{const[e,t]=(0,v.useState)(0),{sentreFarms:s}=z(),{getTotalValue:r}=B(),a=(0,v.useCallback)((async()=>{let e=0;await Promise.all(Object.values(s).map((async t=>{const{total_shares:s,mint_stake:a}=t,n=await r({mintAddress:a,amount:s});e+=n}))),t(e)}),[s,r]);return(0,v.useEffect)((()=>{a()}),[a]),e})(),d=e>768,l=d?void 0:24,c=d?32:16,u=d?8:4,m=d?"vertical":"horizontal",h=d?"pause-outline":"reorder-two-outline",p=(0,v.useMemo)((()=>{let e=0;for(const s in t)t[s].total_shares&&e++;return e}),[t]);return(0,E.jsx)(o.Card,{bordered:!1,className:(d?"":"banner-farming-mobile ")+"banner-farming",children:(0,E.jsxs)(o.Row,{gutter:[12,c],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Typography.Title,{level:4,style:{color:"#212433"},children:"Sen Farming"})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Row,{gutter:[12,12],children:[(0,E.jsx)(o.Col,{span:l,children:(0,E.jsxs)(o.Space,{direction:"vertical",size:u,children:[(0,E.jsx)(o.Typography.Text,{style:{color:"#212433"},children:"Total Sentre Farms TVL"}),(0,E.jsx)(o.Typography.Title,{level:2,style:{color:"#F9575E"},children:a.util.numeric(n).format("0,0.[00]$")})]})}),d&&(0,E.jsx)(o.Col,{children:(0,E.jsx)(o.Divider,{type:"vertical",style:{height:"100%"}})}),(0,E.jsx)(o.Col,{span:l,children:(0,E.jsxs)(o.Space,{direction:"vertical",size:u,children:[(0,E.jsx)(o.Typography.Text,{style:{color:"#212433"},children:"Active Farms"}),(0,E.jsx)(o.Typography.Title,{level:2,style:{color:"#F9575E"},children:p})]})}),d&&(0,E.jsx)(o.Col,{children:(0,E.jsx)(o.Divider,{type:"vertical",style:{height:"100%"}})}),(0,E.jsx)(o.Col,{span:l,children:(0,E.jsxs)(o.Space,{direction:m,size:0,align:"center",children:[(0,E.jsxs)(o.Typography.Title,{level:4,style:{color:"#212433"},children:["1 ",(0,E.jsx)(W,{mintAddress:M})]}),(0,E.jsx)(i.Z,{style:{color:"#212433"},name:h}),(0,E.jsx)(o.Typography.Title,{level:4,style:{color:"#F9575E"},children:a.util.numeric(s.price).format("0,0.[0000]$")})]})})]})})]})})};var Z=s(58421);let O;const N=(0,v.forwardRef)(((e,t)=>{let{max:s,onValue:r=(()=>{}),onChange:a=(()=>{}),...n}=e;const[d,l]=(0,v.useState)(""),[c,u]=(0,v.useState)(null),m=(0,v.useRef)(t),h=(0,v.useCallback)((e=>{const t=e=>{O&&(clearTimeout(O),O=void 0),l(e),O=setTimeout((()=>l("")),500)};return/^\d*(\.\d*)?$/.test(e)?s&&parseFloat(e)>parseFloat(s.toString())?t("Not enough balance"):r(e):t("Invalid character")}),[s,r]);return null!==c&&setTimeout((()=>{var e;return null===m||void 0===m||null===(e=m.current)||void 0===e?void 0:e.setSelectionRange(c,c)}),50),(0,E.jsx)(o.Tooltip,{title:(0,E.jsxs)(o.Space,{children:[(0,E.jsx)(i.Z,{name:"warning"}),d]}),visible:!!d,children:(0,E.jsx)(o.Input,{...n,onChange:e=>{a(e),u(e.target.selectionStart),h(e.target.value||"")},ref:m})})})),K=(e,t)=>window.notify({type:"success",description:`${e} successfully. Click to view details.`,onClick:()=>window.open(a.util.explorer(t),"_blank")}),L=e=>(console.log("error:",e),window.notify({type:"error",description:e.message})),V=e=>{const[t,s]=(0,v.useState)(void 0),{getDecimals:r}=(0,a.useMint)(),n=(0,v.useCallback)((async()=>{try{const t=await r(e);return s(t)}catch(t){return s(void 0)}}),[e,r]);return(0,v.useEffect)((()=>{n()}),[n]),t},H={Hour:BigInt(3600),Day:BigInt(86400),Month:BigInt(2592e3),Year:BigInt(31536e3)},Y=e=>{let{mintAddress:t,onClose:s=(()=>{}),setVisibleInputTokenModal:r=(()=>{})}=e;const{sol:{senAddress:n,farming:d}}=C,[l,c]=(0,v.useState)(""),[u,m]=(0,v.useState)(""),[h,p]=(0,v.useState)("Hour"),[f,g]=(0,v.useState)(!1),w=V(n),{wallet:{address:x}}=(0,a.useWallet)(),b=!l||!u||!y.account.isAddress(t);return(0,E.jsxs)(o.Row,{gutter:[16,16],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Typography.Title,{level:4,children:"New farm"})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Card,{style:{borderRadius:8},bodyStyle:{padding:16},bordered:!1,children:(0,E.jsxs)(o.Row,{gutter:[16,16],children:[(0,E.jsx)(o.Col,{span:12,children:(0,E.jsxs)(o.Space,{direction:"vertical",children:[(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"Input"}),(0,E.jsxs)(o.Space,{size:12,style:{cursor:"pointer"},onClick:()=>r(!0),children:[(0,E.jsx)(_,{mintAddress:t}),y.account.isAddress(t)?(0,E.jsx)(W,{mintAddress:t}):(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"Select token type"}),(0,E.jsx)(i.Z,{name:"chevron-forward-outline",style:{color:"#7A7B85"}})]})]})}),(0,E.jsx)(o.Col,{span:12,children:(0,E.jsxs)(o.Space,{direction:"vertical",children:[(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"Output"}),(0,E.jsxs)(o.Space,{size:12,style:{cursor:"pointer"},children:[(0,E.jsx)(_,{mintAddress:n}),(0,E.jsx)(W,{mintAddress:n})]})]})})]})})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Row,{gutter:[0,0],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Typography.Text,{type:"secondary",className:"caption",children:"Reward"})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(N,{size:"large",placeholder:"0",value:l,onValue:c,prefix:(0,E.jsx)(o.Typography.Text,{children:"SNTR"})})})]})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Row,{gutter:[0,0],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Typography.Text,{type:"secondary",className:"caption",children:["Number of ",h]})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(N,{size:"large",placeholder:"0",value:u,onValue:m,suffix:(0,E.jsx)(o.Button,{type:"text",size:"small",icon:(0,E.jsx)(i.Z,{name:"time-outline"}),onClick:()=>{const e=Object.keys(H),t=(e.findIndex((e=>e===h))+1)%e.length;return p(e[t])},children:h})})})]})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Button,{type:"primary",onClick:async()=>{if(!y.account.isAddress(t))return L({message:`Invalid mint address: ${t}`});g(!0);const{wallet:e}=window.sentre;if(!e||!h||!u||!w)return;const r=y.utils.decimalize(l,w),a=Number(null===H||void 0===H?void 0:H[h])*Number(u);try{const{txId:i}=await d.initializeFarm(r,BigInt(a),x,t,n,e);return s(),K("Create a new farm",i)}catch(i){return L({message:i.message})}finally{return g(!1)}},disabled:b,block:!0,loading:f,children:"Confirm"})})]})},U=e=>{let{accountAddress:t,onClick:s=(()=>{})}=e;const{accounts:{[t]:{mint:r}}}=(0,a.useAccount)(),n=(0,v.useMemo)((()=>t.substring(0,4)+" ... "+t.substring(t.length-4,t.length)),[t]);return(0,E.jsx)(o.Card,{onClick:()=>s(r),className:"account-card",bodyStyle:{padding:12,cursor:"pointer"},bordered:!1,children:(0,E.jsxs)(o.Row,{gutter:[8,8],wrap:!1,align:"middle",children:[(0,E.jsx)(o.Col,{flex:"auto",children:(0,E.jsxs)(o.Space,{direction:"vertical",size:0,children:[(0,E.jsxs)(o.Space,{children:[(0,E.jsx)(_,{mintAddress:r}),(0,E.jsx)(R,{mintAddress:r})]}),(0,E.jsxs)(o.Space,{children:[(0,E.jsxs)(o.Space,{size:4,children:[(0,E.jsx)(o.Typography.Text,{type:"secondary",style:{fontSize:12},children:"Account Address:"}),(0,E.jsx)(o.Typography.Text,{children:n})]}),(0,E.jsx)(o.Button,{type:"text",size:"small",onClick:e=>{e.stopPropagation(),window.open(a.util.explorer(t))},icon:(0,E.jsx)(i.Z,{name:"open-outline"})})]})]})}),(0,E.jsx)(o.Col,{children:(0,E.jsx)(o.Button,{type:"text",icon:(0,E.jsx)(i.Z,{name:"arrow-forward-outline"})})})]})})},G=e=>{let{onChange:t}=e;const[s,r]=(0,v.useState)("");return(0,v.useEffect)((()=>t(s)),[s,t]),(0,E.jsx)(o.Card,{className:"account-card",bodyStyle:{padding:6},bordered:!1,children:(0,E.jsx)(o.Input,{placeholder:"Search",value:s,size:"small",bordered:!1,prefix:(0,E.jsx)(o.Button,{type:"text",style:{marginLeft:-7},size:"small",onClick:s?()=>r(""):()=>{},icon:(0,E.jsx)(i.Z,{name:s?"close-outline":"search-outline"})}),onChange:e=>r(e.target.value)})})},$=e=>{let{onChange:t,onHideInputTokenModal:s=(()=>{})}=e;const{searchedAccount:r,accountAddresses:n,onSearch:i}=(()=>{const[e,t]=(0,v.useState)(),{accounts:s}=(0,a.useAccount)(),{tokenProvider:r}=(0,a.useMint)(),n=(0,v.useMemo)((()=>Object.keys(s)),[s]),i=(0,v.useCallback)((async e=>{if(!e||e.length<3)return t(void 0);const a=(await r.find(e)).map((e=>{let{address:t}=e;return t}));let i=[];return n.forEach((e=>{var t;if(a.includes(null===(t=s[e])||void 0===t?void 0:t.mint))return i.push(e)})),t(i)}),[n,s,r]);return{searchedAccount:e,accountAddresses:n,onSearch:i}})(),d=e=>(s(!1),t(e));return(0,E.jsxs)(o.Row,{gutter:[16,16],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Typography.Title,{level:4,children:"Select token type"})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(G,{onChange:i})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Row,{gutter:[16,16],style:{height:300,overflow:"auto"},children:(r||n).map(((e,t)=>(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(Z.ZP,{height:72,overflow:!0,children:(0,E.jsx)(U,{accountAddress:e,onClick:d})})},e+t)))})})]})},J=e=>{let{size:t="small"}=e;const[s,r]=(0,v.useState)(!1),[a,n]=(0,v.useState)(""),[d,l]=(0,v.useState)(!1);return(0,E.jsxs)(o.Row,{children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Button,{style:{background:"transparent"},onClick:()=>r(!0),size:t,children:"New Farm"})}),(0,E.jsx)(o.Modal,{visible:s,onCancel:()=>r(!1),footer:!1,closeIcon:(0,E.jsx)(i.Z,{name:"close-outline"}),children:(0,E.jsx)(Y,{mintAddress:a,onClose:()=>{r(!1),n("")},setVisibleInputTokenModal:l})}),(0,E.jsx)(o.Modal,{visible:d,onCancel:()=>l(!1),footer:!1,closeIcon:(0,E.jsx)(i.Z,{name:"close-outline"}),children:(0,E.jsx)($,{onChange:e=>{n(e)},onHideInputTokenModal:l})})]})},X=e=>{let{label:t="",tooltip:s,value:r="",mintAddress:a}=e;return(0,E.jsxs)(o.Space,{direction:"vertical",size:4,children:[(0,E.jsxs)(o.Space,{size:4,children:[(0,E.jsxs)(o.Space,{size:4,children:[a&&(0,E.jsx)(_,{mintAddress:a}),(0,E.jsx)(o.Typography.Text,{type:"secondary",children:t})]}),s&&(0,E.jsx)(o.Tooltip,{title:s,children:(0,E.jsx)(o.Button,{type:"text",shape:"circle",size:"small",icon:(0,E.jsx)(o.Typography.Text,{type:"secondary",children:(0,E.jsx)(i.Z,{name:"information-circle-outline"})})})})]}),(0,E.jsxs)(o.Space,{children:[(0,E.jsx)(o.Typography.Title,{level:5,children:r}),a&&(0,E.jsx)(W,{mintAddress:a})]})]})},{sol:{farming:Q}}=C,q=e=>{const[t,s]=(0,v.useState)(""),{debts:{[t]:n}}=(0,r.useSelector)((e=>e)),{wallet:{address:i}}=(0,a.useWallet)(),o=(0,v.useCallback)((async()=>{if(!y.account.isAddress(e))return s("");const t=await Q.deriveDebtAddress(i,e);return s(t)}),[e,i]);return(0,v.useEffect)((()=>{o()}),[o]),{address:t,data:n}};var ee=s(21111),te=s.n(ee);const se=e=>{const{accounts:t}=(0,a.useAccount)(),{wallet:{address:s}}=(0,a.useWallet)(),n=(0,r.useSelector)((t=>t.farms[e])),[i,o]=(0,v.useState)(),d=(0,v.useCallback)((async()=>{if(!(null===n||void 0===n?void 0:n.mint_stake))return o(void 0);const{splt:e}=window.sentre,r=await e.deriveAssociatedAddress(s,n.mint_stake),a=t[r];return te()(a,null===i||void 0===i?void 0:i.data)?void 0:o({address:r,data:a})}),[null===i||void 0===i?void 0:i.data,t,n.mint_stake,s]);return(0,v.useEffect)((()=>{d()}),[d]),i},re=(e,t)=>{if(null===e||0===Object.keys(e).length)return 0;if(null===t||0===Object.keys(t).length)return 0;if(!t.total_shares)return 0;const r=e.shares,a=t.compensation,n=(s.g.BigInt(Math.floor(Date.now()/1e3))-t.genesis_timestamp)/t.period,i=s.g.BigInt(10**18),o=(i*t.reward/t.total_shares*n+a)*r/i,d=y.utils.undecimalize(o-e.debt,9);return Number(d)},ae="The treasury doesn't have enough balance for the claim.",ne="Invalid wallet address.",ie="Invalid farm address.",oe="Invalid debt address.",de="Cannot fetch data of debts";var le=s(19289),ce=s(48744),ue=s.n(ce),me=s(97429).Buffer;BigInt.prototype.toJSON=function(){return this.toString()};const he={serializableCheck:{isSerializable:e=>"undefined"===typeof e||null===e||"string"===typeof e||"boolean"===typeof e||"number"===typeof e||Array.isArray(e)||(e=>{if(null===e)return!1;const t=Object.getPrototypeOf(e);return null!==t&&null===Object.getPrototypeOf(t)})(e)||"bigint"===typeof e||e instanceof c.PublicKey||e instanceof ue()||me.isBuffer(e)}};const pe=class{constructor(){this._publicKey=new c.PublicKey("GuestAccount11111111111111111111111111111111"),this._init=async()=>{var e;const t=await(null===(e=this._wallet)||void 0===e?void 0:e.getAddress());t&&(this._publicKey=new c.PublicKey(t))},this.signTransaction=async e=>this._wallet.signTransaction(e),this.signAllTransactions=async e=>{let t=[];for(const s of e){const e=await this.signTransaction(s);t.push(e)}return t},this._init()}get _wallet(){var e;return null===(e=window.sentre)||void 0===e?void 0:e.wallet}get publicKey(){return console.warn("This is an async getter for interface consistency. Please do not fully rely on this function."),this._publicKey}};var ye=s(97429).Buffer;const fe=e=>ye.from(u.sha256.digest(`account:${(0,m.Z)(e,{pascalCase:!0})}`)).slice(0,8),ge={version:"0.1.0",name:"sen_utility",instructions:[],accounts:[{name:"farm",type:{kind:"struct",fields:[{name:"owner",type:"publicKey"},{name:"state",type:"u8"},{name:"mintStake",type:"publicKey"},{name:"treasuryStake",type:"publicKey"},{name:"mintReward",type:"publicKey"},{name:"treasuryReward",type:"publicKey"},{name:"genesisTimestamp",type:"i64"},{name:"totalShares",type:"u64"},{name:"reward",type:"u64"},{name:"period",type:"u64"},{name:"compensation",type:"i128"}]}},{name:"debt",type:{kind:"struct",fields:[{name:"farm",type:"publicKey"},{name:"owner",type:"publicKey"},{name:"shares",type:"u64"},{name:"debt",type:"u128"},{name:"isInitialized",type:"bool"}]}}],events:[],errors:[]},we=()=>{const e=new c.Connection(a.rpc),t=new pe,s=new h.Y7(e,t,{commitment:"confirmed"});return new h.$r(ge,C.sol.farmingAddress,s)},{sol:{farming:xe,senAddress:be}}=C,je="farms",Ae=(0,le.createAsyncThunk)("farms/getFarms",(async(e,t)=>{let{getState:s}=t;const{farms:r}=s();if(Object.keys(r).length)return r;const a=await xe.connection.getProgramAccounts(xe.farmingProgramId,{filters:[{dataSize:209},{memcmp:{bytes:be,offset:97}}]});let n={};return a.forEach((e=>{let{pubkey:t,account:{data:s}}=e;const r=t.toBase58(),a=(e=>{let t=fe("farm");const s=we().coder.accounts.decode("farm",ye.concat([t,e]));return{compensation:BigInt(s.compensation.toString()),genesis_timestamp:BigInt(s.genesisTimestamp.toString()),mint_reward:s.mintReward.toString(),mint_stake:s.mintStake.toString(),owner:s.owner.toString(),period:BigInt(s.period.toString()),reward:BigInt(s.reward.toString()),state:s.state,total_shares:BigInt(s.totalShares.toString()),treasury_reward:s.treasuryReward.toString(),treasury_stake:s.treasuryStake.toString()}})(s);n[r]=a})),n})),Se=(0,le.createAsyncThunk)("farms/getFarm",(async(e,t)=>{let{address:s}=e,{getState:r}=t;if(!y.account.isAddress(s))throw new Error("Invalid farm address");const{farms:{[s]:a}}=r();if(a)return{[s]:a};return{[s]:await xe.getFarmData(s)}})),ke=(0,le.createAsyncThunk)("farms/upsetFarm",(async e=>{let{address:t,data:s}=e;if(!y.account.isAddress(t))throw new Error("Invalid farm address");if(!s)throw new Error("Data is empty");return{[t]:s}})),Ce=(0,le.createAsyncThunk)("farms/deleteFarm",(async e=>{let{farmAddress:t}=e;if(!y.account.isAddress(t))throw new Error("Invalid address");return{farmAddress:t}})),ve=(0,le.createSlice)({name:je,initialState:{},reducers:{},extraReducers:e=>{e.addCase(Ae.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(Se.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(ke.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(Ce.fulfilled,((e,t)=>{let{payload:s}=t;delete e[s.farmAddress]}))}}).reducer,{sol:{farming:Te}}=C,Ie="debts",Pe=(0,le.createAsyncThunk)("debts/getDebts",(async e=>{let{owner:t}=e;if(!y.account.isAddress(t))throw new Error("Invalid owner/wallet address");const s=await Te.connection.getProgramAccounts(Te.farmingProgramId,{filters:[{dataSize:89},{memcmp:{bytes:t,offset:32}}]});let r={};return s.forEach((e=>{let{pubkey:t,account:{data:s}}=e;const a=t.toBase58(),n=(e=>{let t=fe("debt");const s=we().coder.accounts.decode("debt",ye.concat([t,e]));return{farm:s.farm.toString(),owner:s.owner.toString(),shares:BigInt(s.shares.toString()),debt:BigInt(s.debt.toString()),is_initialized:s.isInitialized}})(s);return r[a]=n})),r})),Ee=(0,le.createAsyncThunk)("debts/getDebt",(async(e,t)=>{let{address:s}=e,{getState:r}=t;const{debts:{[s]:a}}=r();if(a)return{[s]:a};return{[s]:await Te.getDebtData(s)}})),_e=(0,le.createAsyncThunk)("debts/upsetDebt",(async e=>{let{address:t,data:s}=e;if(!y.account.isAddress(t))throw new Error("Invalid address");if(!s)throw new Error("Data is empty");return{[t]:s}})),Re=(0,le.createAsyncThunk)("debts/deleteDebt",(async e=>{let{address:t}=e;if(!y.account.isAddress(t))throw new Error("Invalid address");return{address:t}})),We=(0,le.createSlice)({name:Ie,initialState:{},reducers:{},extraReducers:e=>{e.addCase(Pe.fulfilled,((e,t)=>{let{payload:s}=t;return s})).addCase(Ee.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(_e.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(Re.fulfilled,((e,t)=>{let{payload:s}=t;delete e[s.address]}))}}).reducer,Be="main",Fe=(0,le.createAsyncThunk)("main/setSearch",(async(e,t)=>{let{search:s}=e,{getState:r}=t;return{search:s}})),ze=(0,le.createSlice)({name:Be,initialState:{search:""},reducers:{},extraReducers:e=>{e.addCase(Fe.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)}))}}).reducer,Me=(0,le.configureStore)({middleware:e=>e(he),devTools:!1,reducer:{farms:ve,debts:We,main:ze}}),{sol:{farming:De}}=C;class Ze{async checkSeedBalance(e){const{splt:t,wallet:s}=window.sentre;if(!s)throw new Error("Please connect wallet first!");const r=Me.getState().farms[e],a=await s.getAddress();if(!y.account.isAddress(a))throw new Error(ne);const n=await De.deriveDebtAddress(a,e);if(!y.account.isAddress(n))throw new Error(oe);const i=Me.getState().debts[n];if(!i)throw new Error(de);const o=re(i,r),{treasury_reward:d,treasury_stake:l,total_shares:c}=r;let{amount:u}=await t.getAccountData(d);d===l&&(u-=c);if(Number(y.utils.undecimalize(u,9))<o)throw new Error(ae)}async validate(e){if(!y.account.isAddress(e))throw new Error(ie);return await this.checkSeedBalance(e)}}const{sol:{senAddress:Oe,farming:Ne}}=C,Ke=e=>{let{farmAddress:t,onClose:s}=e;const n=(0,r.useSelector)((e=>{var s;return null===(s=e.farms)||void 0===s?void 0:s[t]})),{wallet:{address:d}}=(0,a.useWallet)(),{data:l}=q(t),c=se(t),[u,m]=(0,v.useState)(),[h,p]=(0,v.useState)(!0),[f,g]=(0,v.useState)(!1),w=V(n.mint_stake),x=(0,v.useCallback)((async e=>(await m(e),e?await p(!1):await p(!0))),[]),b=(0,v.useMemo)((()=>{if(w)return y.utils.undecimalize(null===l||void 0===l?void 0:l.shares,w)}),[null===l||void 0===l?void 0:l.shares,w]);return(0,E.jsxs)(o.Row,{gutter:[16,16],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Space,{align:"start",children:[(0,E.jsx)(i.Z,{name:"alert-circle-outline"}),(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"The pending reward will be automatically harvested when you unstake."})]})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Card,{bodyStyle:{padding:12},style:{boxShadow:"none",borderRadius:8},children:(0,E.jsxs)(o.Space,{style:{width:"100%"},direction:"vertical",children:[(0,E.jsxs)(o.Row,{children:[(0,E.jsx)(o.Col,{flex:"auto",children:(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"Amount"})}),(0,E.jsx)(o.Col,{children:(0,E.jsxs)(o.Space,{size:6,children:[(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"Available:"}),(0,E.jsx)(o.Typography.Text,{children:a.util.numeric(b).format("0,0.[00]")}),(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"LPT"})]})})]}),(0,E.jsx)(N,{placeholder:"0",value:u,onValue:x,bordered:!1,size:"large",style:{padding:0},suffix:(0,E.jsx)(o.Button,{type:"text",style:{marginRight:-7},onClick:()=>x(b),children:"MAX"}),max:b})]})})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Button,{type:"primary",icon:(0,E.jsx)(i.Z,{name:"remove-outline"}),onClick:async()=>{g(!0);try{const{splt:e,wallet:r}=window.sentre;if(!r)throw Error("Please connect wallet first");if(!u||!c||!w)return;const a=y.utils.decimalize(u,w),n=await e.deriveAssociatedAddress(d,Oe),i=new Ze;await i.validate(t);const{txId:o}=await Ne.unstake(a,c.address,n,t,r);return s(!1),K("Unstaked",o)}catch(e){return L(e)}finally{g(!1)}},block:!0,disabled:h,loading:f,children:"Unstake"})})]})},{sol:{senAddress:Le,farming:Ve}}=C,He=e=>{let{farmAddress:t,onClose:s}=e;const n=(0,r.useSelector)((e=>{var s;return null===(s=e.farms)||void 0===s?void 0:s[t]})),{wallet:{address:d}}=(0,a.useWallet)(),{accounts:l}=(0,a.useAccount)(),{data:c}=q(t),u=se(t),[m,h]=(0,v.useState)(),[p,f]=(0,v.useState)(!0),[g,w]=(0,v.useState)(!1),x=V(n.mint_stake),b=(0,v.useCallback)((async e=>(await h(e),e?await f(!1):await f(!0))),[]),j=(0,v.useMemo)((()=>{if(x)return y.utils.undecimalize(BigInt((null===u||void 0===u?void 0:u.data.amount)||0),x)}),[null===u||void 0===u?void 0:u.data.amount,x]);return(0,E.jsxs)(o.Row,{gutter:[16,16],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Space,{align:"start",children:[(0,E.jsx)(i.Z,{name:"alert-circle-outline"}),(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"The pending reward will be automatically harvested when you stake more."})]})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Card,{bodyStyle:{padding:12},style:{boxShadow:"none",borderRadius:8},children:(0,E.jsxs)(o.Space,{style:{width:"100%"},direction:"vertical",children:[(0,E.jsxs)(o.Row,{children:[(0,E.jsx)(o.Col,{flex:"auto",children:(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"Amount"})}),(0,E.jsx)(o.Col,{children:(0,E.jsxs)(o.Space,{size:6,children:[(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"Available:"}),(0,E.jsx)(o.Typography.Text,{children:a.util.numeric(j).format("0,0.[00]")}),(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"LPT"})]})})]}),(0,E.jsx)(N,{placeholder:"0",value:m,onValue:b,bordered:!1,size:"large",style:{padding:0},suffix:(0,E.jsx)(o.Button,{type:"text",style:{marginRight:-15},onClick:()=>b(j),children:"MAX"}),max:j})]})})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Button,{type:"primary",icon:(0,E.jsx)(i.Z,{name:"add-outline"}),onClick:async()=>{w(!0);try{const{splt:e,wallet:r}=window.sentre;if(!r)throw Error("Please connect wallet first");if(!m||!u||!x)return;const a=await e.deriveAssociatedAddress(d,Le);void 0===(null===c||void 0===c?void 0:c.shares)&&await Ve.initializeAccounts(t,d,r),l[a]||await e.initializeAccount(Le,d,r);const n=new Ze;await n.validate(t);const{txId:i}=await Ve.stake(y.utils.decimalize(m,x),u.address,a,t,r);return s(!1),K("Staked",i)}catch(e){return L(e)}finally{w(!1)}},block:!0,disabled:p,loading:g,children:"Stake"})})]})},Ye=e=>{let{title:t}=e;return(0,E.jsxs)(o.Space,{children:[(0,E.jsx)(i.Z,{style:{fontSize:18},name:"alert-circle-outline"}),(0,E.jsx)(o.Typography.Text,{type:"secondary",ellipsis:!0,children:t})]})};var Ue=s(51518),Ge=s.n(Ue);const $e=e=>{let{address:t,onCopy:s,copieAddress:r,description:a=!1,title:n}=e;return(0,E.jsxs)(o.Row,{gutter:[0,8],children:[(0,E.jsx)(o.Col,{xs:{span:24},sm:{span:10},md:{span:10},lg:{span:10},flex:"auto",children:(0,E.jsx)(Ye,{title:n})}),(0,E.jsx)(o.Col,{xs:{span:22},sm:{span:14},md:{span:14},lg:{span:14},flex:"auto",children:y.account.isAddress(t)&&(0,E.jsx)(o.Typography.Text,{children:t})}),(0,E.jsx)(o.Col,{children:(0,E.jsx)(o.Tooltip,{title:"Copied",visible:t===r,children:(0,E.jsx)(Ue.CopyToClipboard,{text:t,onCopy:e=>s(e),children:(0,E.jsx)(o.Button,{type:"text",size:"small",style:{marginRight:-7},icon:(0,E.jsx)(i.Z,{name:"copy-outline"})})})})}),a?(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Typography.Paragraph,{type:"secondary",style:{fontSize:12},children:"Tips: You can use this address for searching the pool coresponding to the farm in Sen LP."})}):null]})},Je=e=>{const[t,s]=(0,v.useState)(0),{farms:{[e]:a}}=(0,r.useSelector)((e=>e)),{treasury_stake:n,treasury_reward:i,mint_reward:o,total_shares:d}=a||{},l=V(o),{symbol:c}=I(o),u=(0,v.useCallback)((async()=>{if(void 0===l)return s(0);try{const{splt:e}=window.sentre;let{amount:t}=await e.getAccountData(i);i===n&&(t-=d);const r=Number(y.utils.undecimalize(t,l));s(r)}catch(e){s(0)}}),[l,d,i,n]);return(0,v.useEffect)((()=>{u()}),[u]),{budget:t,budgetSymbol:c}},Xe=e=>{let{farmAddress:t}=e;const{tokenProvider:s}=(0,a.useMint)(),{pools:n}=(0,a.usePool)(),{budget:i,budgetSymbol:d}=Je(t),l=(0,r.useSelector)((e=>e.farms)),[c,u]=(0,v.useState)(""),[m,h]=(0,v.useState)(""),{mint_stake:p,period:f,reward:g,mint_reward:w}=l[t]||{},x=V(p);(0,v.useEffect)((()=>{(async()=>{const{symbol:e}=await s.findByAddress(w)||{};h(e||"TOKEN")})()}),[w,s]);const b=Object.keys(n).find((e=>{const{mint_lpt:t}=n[e];return t===p})),j=async e=>{e&&(await u(e),await a.util.asyncWait(1500),await u(""))},A=(0,v.useMemo)((()=>x?y.utils.undecimalize(g,x):0),[x,g]),S=(0,v.useMemo)((()=>{let e=Number(f)/86400,t="days";return e>29&&(e/=30,t=e>1?"months":"month"),e<2&&(e*=24,t=e>1?"hours":"hour"),`${A} ${d} / ${Math.floor(e)} ${t}`}),[A,f,d]);return(0,E.jsxs)(o.Row,{gutter:[24,24],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)($e,{title:"Farming address:",address:t,onCopy:e=>j(e),copieAddress:c})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)($e,{title:b?"Pool address:":"Stake mint address:",address:b||p,onCopy:e=>j(e),copieAddress:c,description:!0})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Space,{align:"baseline",children:[(0,E.jsx)(Ye,{title:"Rewarding:"}),(0,E.jsx)(o.Typography.Text,{style:{wordBreak:"break-all"},children:S})]})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Space,{align:"baseline",children:[(0,E.jsx)(Ye,{title:"Budget:"}),(0,E.jsx)(o.Typography.Text,{style:{wordBreak:"break-all"},children:a.util.numeric(i).format("0,0.[00]")}),(0,E.jsx)(o.Typography.Text,{type:"secondary",children:m})]})})]})},{sol:{senAddress:Qe,farming:qe}}=C,et=e=>{let{farmAddress:t,onChange:s=(()=>{})}=e;const{accounts:n}=(0,a.useAccount)(),{wallet:{address:d}}=(0,a.useWallet)(),l=(0,r.useSelector)((e=>e.farms)),[c,u]=(0,v.useState)(""),[m,h]=(0,v.useState)("0"),[p,f]=(0,v.useState)(!1),{mint_reward:g}=(null===l||void 0===l?void 0:l[t])||{},w=V(g);(0,v.useEffect)((()=>{(async()=>{if(w)try{const{splt:e}=window.sentre,t=await e.deriveAssociatedAddress(d,g),{amount:s}=n[t]||{};h(s?y.utils.undecimalize(s,w):"0")}catch(e){h("0")}})()}),[d,n,g,w]);return(0,E.jsxs)(o.Row,{gutter:[16,16],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Card,{style:{boxShadow:"unset",borderRadius:8},bodyStyle:{padding:8},children:(0,E.jsxs)(o.Row,{gutter:[0,0],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Row,{gutter:[0,0],wrap:!1,style:{margin:"6px 12px 0px 12px",fontSize:12},children:[(0,E.jsx)(o.Col,{flex:"auto",children:(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"Amount"})}),(0,E.jsx)(o.Col,{children:(0,E.jsxs)(o.Space,{size:6,children:[(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"Available:"}),(0,E.jsx)(o.Typography.Text,{children:a.util.numeric(m).format("0,0.[00]")}),(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"SNTR"})]})})]})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(N,{placeholder:"0",value:c,onValue:u,suffix:(0,E.jsx)(o.Button,{type:"text",onClick:()=>u(m),size:"small",style:{marginRight:-7},children:"MAX"}),bordered:!1,max:m})})]})})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Button,{type:"primary",icon:(0,E.jsx)(i.Z,{name:"add-outline"}),onClick:async()=>{f(!0);const{wallet:e,splt:r}=window.sentre;if(!e)return;const a=await r.deriveAssociatedAddress(d,Qe),n=y.utils.decimalize(c,9);try{const{txId:r}=await qe.seed(n,t,a,e);return s(r),K("Seed",r)}catch(i){return L(i)}finally{f(!1)}},block:!0,disabled:!c,loading:p,children:"Seed"})})]})},{sol:{farming:tt}}=C,st=e=>{let{farmAddress:t,onChange:s=(()=>{})}=e;const{wallet:{address:n}}=(0,a.useWallet)(),d=(0,r.useSelector)((e=>e.farms)),[l,c]=(0,v.useState)(""),[u,m]=(0,v.useState)("0"),[h,p]=(0,v.useState)(!1),{treasury_reward:f,mint_reward:g}=d[t]||{},w=V(g),{symbol:x}=I(g);(0,v.useEffect)((()=>{(async()=>{if(w)try{const{splt:e}=window.sentre,{amount:t}=await e.getAccountData(f);m(t?y.utils.undecimalize(t,w):"0")}catch(e){m("0")}})()}),[w,f]);return(0,E.jsxs)(o.Row,{gutter:[16,16],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Card,{style:{boxShadow:"unset",borderRadius:8},bodyStyle:{padding:8},children:(0,E.jsxs)(o.Row,{gutter:[0,0],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Row,{gutter:[0,0],wrap:!1,style:{margin:"6px 12px 0px 12px",fontSize:12},children:[(0,E.jsx)(o.Col,{flex:"auto",children:(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"Amount"})}),(0,E.jsx)(o.Col,{children:(0,E.jsxs)(o.Space,{size:6,children:[(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"Available:"}),(0,E.jsx)(o.Typography.Text,{children:a.util.numeric(u).format("0,0.[00]")}),(0,E.jsx)(o.Typography.Text,{type:"secondary",children:x})]})})]})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(N,{placeholder:"0",value:l,onValue:c,suffix:(0,E.jsx)(o.Button,{type:"text",onClick:()=>c(u),size:"small",style:{marginRight:-7},children:"MAX"}),bordered:!1,max:u})})]})})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Button,{type:"primary",icon:(0,E.jsx)(i.Z,{name:"remove-outline"}),onClick:async()=>{p(!0);const{wallet:e,splt:r}=window.sentre;if(!e||!w)return;const a=await r.deriveAssociatedAddress(n,g),i=y.utils.decimalize(l,w);try{const{txId:r}=await tt.unseed(i,t,a,e);return s(r),K("Unseed",r)}catch(o){return L(o)}finally{p(!1)}},block:!0,disabled:!l,loading:h,children:"Unseed"})})]})};let rt,at;!function(e){e[e.POLICY_AGREEMENT=0]="POLICY_AGREEMENT",e[e.FARM_CREATING_CONFIRMATION=1]="FARM_CREATING_CONFIRMATION"}(rt||(rt={})),function(e){e[e.isActive=1]="isActive",e[e.isFreeze=2]="isFreeze"}(at||(at={}));const{sol:{farming:nt}}=C,it=e=>{let{farmAddress:t,onChange:s=(()=>{})}=e;const a=(0,r.useSelector)((e=>e.farms)),[n,d]=(0,v.useState)(!1),{state:l}=(null===a||void 0===a?void 0:a[t])||{},c=l===at.isActive,u=c?{backgroundColor:"#40A9FF",color:"#fff"}:{},m=c?"snow-outline":"sunny-outline",h=c?"Freeze":"Thaw";return(0,E.jsxs)(o.Row,{gutter:[16,16],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Space,{className:"caption",align:"start",children:[(0,E.jsx)(i.Z,{name:"information-circle-outline"}),(0,E.jsx)(o.Typography.Text,{type:"secondary",children:'Freezing a farm will prevent all actions, but "seed" and "unseed", until the farm has been thawed.'})]})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Button,{type:"primary",style:{...u,border:"unset"},icon:(0,E.jsx)(i.Z,{name:m}),onClick:c?async()=>{const{wallet:e}=window.sentre;if(e){d(!0);try{const{txId:r}=await nt.freeze(t,e);return s(r),K("Freeze the farm",r)}catch(r){return L(r)}finally{d(!1)}}}:async()=>{const{wallet:e}=window.sentre;if(e){d(!0);try{const{txId:r}=await nt.thaw(t,e);return s(r),K("Thaw the farm",r)}catch(r){return L(r)}finally{d(!1)}}},block:!0,disabled:!l,loading:n,children:h})})]})},{sol:{farming:ot}}=C,dt=e=>{let{farmAddress:t,onChange:s=(()=>{})}=e;const a=(0,r.useSelector)((e=>e.farms)),[n,d]=(0,v.useState)(!1),{total_shares:l}=(null===a||void 0===a?void 0:a[t])||{},c=(0,r.useDispatch)();return(0,E.jsxs)(o.Row,{gutter:[16,16],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Space,{className:"caption",children:[(0,E.jsx)(i.Z,{name:"information-circle-outline"}),(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"The farm can be closed only all farmers unstaked their tokens!"})]})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Button,{type:"primary",icon:(0,E.jsx)(i.Z,{name:"trash-outline"}),onClick:async()=>{const{wallet:e}=window.sentre;if(e){d(!0);try{const{txId:r}=await ot.closeFarm(t,e);return s(r),c(Ce({farmAddress:t})),K("Close the farm",r)}catch(r){return L(r)}finally{d(!1)}}},block:!0,disabled:!!l,loading:n,children:"Close Farm"})})]})},lt=e=>{let{label:t="",title:s=""}=e;return(0,E.jsxs)(o.Row,{gutter:[16,16],children:[(0,E.jsx)(o.Col,{flex:"auto",children:(0,E.jsx)(o.Typography.Text,{type:"secondary",children:t})}),(0,E.jsx)(o.Col,{children:(0,E.jsx)(o.Typography.Text,{children:s})})]})},ct=e=>{let{farmAddress:t}=e;const s=(0,r.useSelector)((e=>{var s;return null===(s=e.farms)||void 0===s?void 0:s[t]})),[n,d]=(0,v.useState)(!1),[l,c]=(0,v.useState)(!1),{budget:u,budgetSymbol:m}=Je(t),{mint_stake:h,period:p,reward:f}=s||{},g=V(h),w=(0,v.useMemo)((()=>g?y.utils.undecimalize(f,g):0),[g,f]),x=(0,v.useMemo)((()=>{let e=Number(p)/86400,t="days";return e>29&&(e/=30,t=e>1?"months":"month"),e<2&&(e*=24,t=e>1?"hours":"hour"),`${w} ${m} / ${Math.floor(e)} ${t}`}),[w,p,m]);return(0,E.jsxs)(v.Fragment,{children:[(0,E.jsx)(o.Button,{onClick:()=>d(!0),children:"Manage"}),(0,E.jsx)(o.Modal,{visible:n,onCancel:()=>d(!1),closeIcon:(0,E.jsx)(i.Z,{name:"close"}),footer:null,destroyOnClose:!0,centered:!0,children:(0,E.jsxs)(o.Row,{gutter:[16,16],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Space,{style:{lineHeight:1},children:[(0,E.jsx)(i.Z,{name:"leaf"}),(0,E.jsx)(o.Typography.Title,{level:5,style:{margin:0},children:"Farm Management"})]})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Card,{style:{borderRadius:8},bodyStyle:{padding:16},bordered:!1,children:(0,E.jsxs)(o.Row,{gutter:[8,8],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Row,{gutter:[0,0],children:[(0,E.jsx)(o.Col,{flex:"auto",children:(0,E.jsxs)(o.Space,{size:12,style:{fontWeight:600},children:[(0,E.jsx)(_,{mintAddress:h,size:32}),(0,E.jsx)(W,{mintAddress:h})]})}),(0,E.jsx)(o.Col,{children:(0,E.jsxs)(o.Space,{size:2,children:[(0,E.jsx)(o.Typography.Text,{type:"secondary",style:{fontSize:12},children:a.util.shortenAddress(t)}),(0,E.jsx)(o.Tooltip,{visible:l,title:"Copied",children:(0,E.jsx)(Ge(),{text:t,children:(0,E.jsx)(o.Button,{type:"text",size:"small",onClick:async()=>{c(!0),await a.util.asyncWait(1500),c(!1)},icon:(0,E.jsx)(i.Z,{name:"copy-outline"})})})}),(0,E.jsx)(o.Button,{type:"text",size:"small",onClick:()=>window.open(a.util.explorer(t),"_blank"),icon:(0,E.jsx)(i.Z,{name:"open-outline"})})]})})]})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(lt,{label:"Budget",title:`${u} ${m}`})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(lt,{label:"Reward",title:x})})]})})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Tabs,{children:[(0,E.jsx)(o.Tabs.TabPane,{tab:"Seed",children:(0,E.jsx)(et,{farmAddress:t,onChange:()=>d(!1)})},"seed"),(0,E.jsx)(o.Tabs.TabPane,{tab:"Unseed",children:(0,E.jsx)(st,{farmAddress:t,onChange:()=>d(!1)})},"unseed"),(0,E.jsx)(o.Tabs.TabPane,{tab:"Freeze/Thaw",children:(0,E.jsx)(it,{farmAddress:t,onChange:()=>d(!1)})},"freeze-thaw"),(0,E.jsx)(o.Tabs.TabPane,{tab:"Ownership",disabled:!0,children:"TBD"},"ownership"),(0,E.jsx)(o.Tabs.TabPane,{tab:"Close",children:(0,E.jsx)(dt,{farmAddress:t,onChange:()=>d(!1)})},"close")]})})]})})]})},{sol:{senAddress:ut,farming:mt}}=C,ht=e=>{let{farmAddress:t,onClose:s}=e;const n=(0,r.useSelector)((e=>{var s;return null===(s=e.farms)||void 0===s?void 0:s[t]})),{data:d}=q(t),{wallet:{address:l}}=(0,a.useWallet)(),[c,u]=(0,v.useState)(!1),m=y.utils.undecimalize(null===d||void 0===d?void 0:d.shares,9);return(0,E.jsxs)(o.Row,{gutter:[16,16],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Space,{align:"start",children:[(0,E.jsx)(i.Z,{name:"alert-circle-outline"}),(0,E.jsx)(o.Typography.Text,{children:"When the reward budget is too low, you may be not able to unstake. Exiting the farm means you give up on rewards and merely get back your tokens."})]})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Card,{style:{borderRadius:8,boxShadow:"unset"},bodyStyle:{padding:12},children:(0,E.jsxs)(o.Row,{gutter:[0,0],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Typography.Text,{className:"caption",type:"secondary",children:"Amount"})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(N,{placeholder:"0",value:m,size:"small",bordered:!1})})]})})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Button,{type:"primary",icon:(0,E.jsx)(i.Z,{name:"remove"}),onClick:async()=>{u(!0);const{splt:e,wallet:r}=window.sentre,{mint_stake:a}=n;if(!r||!y.account.isAddress(a))return;const i=await e.deriveAssociatedAddress(l,ut),o=await e.deriveAssociatedAddress(l,a);try{const{txId:e}=await mt.rid(o,i,t,r);return s(!1),K("Exit",e)}catch(d){return L(d)}finally{u(!1)}},block:!0,disabled:!m,loading:c,children:"Exit"})})]})},pt=e=>{const{farms:{[e]:t}}=(0,r.useSelector)((e=>e)),{getTotalValue:s}=B(),[a,n]=(0,v.useState)(0),i=(0,v.useCallback)((async()=>{if(!t)return n(0);const{total_shares:e,mint_stake:r}=t,a=await s({mintAddress:r,amount:e});return n(a)}),[t,s]);return(0,v.useEffect)((()=>{i()}),[i]),a},{sol:{senAddress:yt,farming:ft}}=C,gt="The budget of reward is very low. Please unstake your tokens for safety.",wt=e=>{let{farmAddress:t}=e;const s=(0,r.useSelector)((e=>{var s;return null===(s=e.farms)||void 0===s?void 0:s[t]})),{data:d}=q(t),l=(e=>{const t=(0,r.useSelector)((t=>t.farms[e])),{data:s}=q(e),[a,n]=(0,v.useState)(0),i=(0,v.useCallback)((()=>{if(!s||!t)return n(0);const e=re(s,t)||0;return n(e)}),[s,t]);return(0,v.useEffect)((()=>{i()}),[i]),a})(t),c=(e=>{const[t,s]=(0,v.useState)(),{farms:{[e]:n}}=(0,r.useSelector)((e=>e)),{pools:i}=(0,a.usePool)(),o=(0,v.useCallback)((async()=>{const e=null===n||void 0===n?void 0:n.mint_stake;if(!e)return s(void 0);const t=Object.keys(i).find((t=>{const{mint_lpt:s}=i[t];return s===e}));if(!y.account.isAddress(t))return s(void 0);const r=i[t];return s({address:t,data:r})}),[null===n||void 0===n?void 0:n.mint_stake,i]);return(0,v.useEffect)((()=>{o()}),[o]),t})(t),u=pt(t),{apr:m}=(e=>{const t=(0,r.useSelector)((t=>t.farms[e])),s=pt(e),{getTotalValue:a}=B(),[n,i]=(0,v.useState)(0),o=(0,v.useCallback)((async()=>{if(!s)return i(0);const{mint_reward:e,reward:r,period:n}=t,o=r*BigInt(86400)/n,d=await a({mintAddress:e,amount:o});return i(d/s)}),[t,a,s]);return(0,v.useEffect)((()=>{o()}),[o]),{roi:n,apr:365*n}})(t),{ui:{width:h}}=(0,a.useUI)(),{wallet:{address:p}}=(0,a.useWallet)(),f=(0,n.useHistory)(),[g,w]=(0,v.useState)(),[x,b]=(0,v.useState)(!1),[j,A]=(0,v.useState)(!1),[S,k]=(0,v.useState)(!1),[C,T]=(0,v.useState)(""),{owner:I,state:P,reward:R}=s||{},F=I===p,z=(0,r.useSelector)((e=>e.main.search)),M=P===at.isFreeze,D=V(null===s||void 0===s?void 0:s.mint_stake),Z=V(null===s||void 0===s?void 0:s.mint_stake),{budget:O}=Je(t),N=(0,v.useMemo)((()=>0!==Z&&Z?Number(y.utils.undecimalize(R,Z)):0),[Z,R]),H=()=>w(g?void 0:t);(0,v.useEffect)((()=>{z&&z===t&&w(z)}),[O,t,N,z]),(0,v.useEffect)((()=>T(N?O<3*N?gt:"":gt)),[O,N]);const Y=()=>(0,E.jsxs)(o.Row,{gutter:[8,8],children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsxs)(o.Space,{size:4,children:[(0,E.jsx)(o.Typography.Title,{style:{color:"#fff"},level:5,children:"APR"}),(0,E.jsx)(o.Typography.Text,{type:"secondary",children:"(Annual Percentage Rate)"})]})}),(0,E.jsx)(o.Col,{children:(0,E.jsx)(o.Typography.Text,{style:{color:"#E9E9EB"},children:"Refers to the simple interest accured from a particular inverstment over a 1 year period."})})]});let U="0";d&&D&&(U=y.utils.undecimalize(d.shares,D));const G=h>768?g?"chevron-down-outline":"chevron-forward-outline":g?"chevron-up-outline":"chevron-down-outline",$=M?{opacity:.6}:{};return(0,E.jsxs)(o.Row,{style:{...$},children:[(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Card,{bordered:!1,className:"farming-card",bodyStyle:{padding:16},style:{boxShadow:"unset",borderRadius:8,position:"relative",zIndex:1},hoverable:!0,onClick:H,children:(0,E.jsxs)(o.Row,{gutter:[16,16],justify:"center",align:"middle",children:[(0,E.jsx)(o.Col,{flex:"auto",children:(0,E.jsxs)(o.Row,{gutter:[16,16],align:"middle",children:[(0,E.jsx)(o.Col,{xs:24,md:5,children:(0,E.jsxs)(o.Space,{children:[(0,E.jsx)(_,{mintAddress:null===s||void 0===s?void 0:s.mint_stake,size:24}),(0,E.jsx)(W,{mintAddress:null===s||void 0===s?void 0:s.mint_stake}),(0,E.jsx)(o.Button,{type:"text",shape:"circle",size:"small",icon:(0,E.jsx)(o.Typography.Text,{type:"secondary",children:(0,E.jsx)(i.Z,{name:"information-circle-outline"})}),onClick:e=>{e.stopPropagation(),A(!0)}})]})}),(0,E.jsx)(o.Col,{xs:12,md:4,children:(0,E.jsx)(X,{label:"APR",tooltip:(0,E.jsx)(Y,{}),value:a.util.numeric(m).format("0,0.[00]a%")})}),(0,E.jsx)(o.Col,{xs:12,md:5,children:(0,E.jsx)(X,{label:"Liquidity",value:a.util.numeric(u).format("0,0.00[00]a$")})}),(0,E.jsx)(o.Col,{xs:12,md:5,children:(0,E.jsx)(X,{label:"Your staked LPT",value:a.util.numeric(U).format("0,0.00[00]")})}),(0,E.jsx)(o.Col,{xs:12,md:5,children:(0,E.jsx)(X,{mintAddress:null===s||void 0===s?void 0:s.mint_reward,label:"Reward",value:a.util.numeric(l).format("0,0.00[00]")})})]})}),(0,E.jsx)(o.Col,{children:(0,E.jsxs)(o.Space,{children:[M&&(0,E.jsx)(i.Z,{name:"snow-outline"}),C&&(0,E.jsx)(o.Tooltip,{title:gt,children:(0,E.jsx)(i.Z,{name:"warning-outline",style:{color:"#f9575e"}})}),(0,E.jsx)(o.Button,{type:"text",icon:(0,E.jsx)(i.Z,{name:G}),disabled:!F&&M,onClick:H})]})})]})})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(o.Collapse,{activeKey:g,className:"expand-farm-card",children:(0,E.jsx)(o.Collapse.Panel,{header:null,showArrow:!1,children:(0,E.jsxs)(o.Row,{gutter:[16,16],children:[(0,E.jsx)(o.Col,{xs:{order:2},md:{order:1},flex:"auto",children:c&&(0,E.jsxs)(o.Button,{type:"text",style:{padding:0,background:"transparent"},onClick:()=>{f.push(`/app/sen_lp/details?poolAddress=${c.address}`)},children:["To the pool",(0,E.jsx)(i.Z,{name:"chevron-forward-outline"})]})}),(0,E.jsx)(o.Col,{xs:{order:1},md:{order:2},children:(0,E.jsxs)(o.Space,{children:[F&&(0,E.jsx)(ct,{farmAddress:t}),(0,E.jsx)(o.Button,{onClick:()=>b(!0),children:"Stake / Unstake"}),(0,E.jsx)(o.Button,{type:"primary",loading:S,onClick:async()=>{k(!0);const{splt:e,wallet:s}=window.sentre,r=await e.deriveAssociatedAddress(p,yt);try{if(!s)throw new Error("please connect wallet first!");const e=new Ze;await e.validate(t);const{txId:a}=await ft.harvest(t,r,s);return K("Harvest",a)}catch(a){return L(a)}finally{k(!1)}},disabled:M||0===l,children:"Harvest"})]})})]})},t)})}),(0,E.jsx)(o.Modal,{onCancel:()=>b(!1),closeIcon:(0,E.jsx)(i.Z,{name:"close"}),footer:null,title:null,visible:x,children:(0,E.jsxs)(o.Tabs,{defaultActiveKey:M?"exit":"stake",children:[(0,E.jsx)(o.Tabs.TabPane,{tab:"Stake",disabled:M,children:(0,E.jsx)(He,{farmAddress:t,onClose:b})},"stake"),(0,E.jsx)(o.Tabs.TabPane,{tab:"Unstake",disabled:M,children:(0,E.jsx)(Ke,{farmAddress:t,onClose:b})},"unstake"),(0,E.jsx)(o.Tabs.TabPane,{tab:"Exit",children:(0,E.jsx)(ht,{farmAddress:t,onClose:b})},"exit")]})}),(0,E.jsx)(o.Modal,{visible:j,onCancel:()=>A(!1),closeIcon:(0,E.jsx)(i.Z,{name:"close"}),title:"Farm Info",footer:null,destroyOnClose:!0,centered:!0,children:(0,E.jsx)(Xe,{farmAddress:t})})]})},xt=e=>{const{tokenProvider:t}=(0,a.useMint)(),{sentreFarms:s}=z(),{pools:n}=(0,a.usePool)(),{search:i}=(0,r.useSelector)((e=>e.main)),[o,d]=(0,v.useState)({}),l=(0,v.useCallback)((e=>Object.keys(n).find((t=>n[t].mint_lpt===e))),[n]),c=(0,v.useCallback)((async()=>{const r={},a=(await t.find(i)).map((e=>e.address));Object.keys(e).filter((t=>{if(!i||!n||!e||i.length<3)return!0;const s=e[t],{mint_stake:r}=s,o=l(r);if(o){if(o===i)return!0;const{mint_a:e,mint_b:t}=n[o];if(a.includes(e)||a.includes(t))return!0}return t===i||(a.includes(r)||r===i)})).sort(((t,r)=>!s[t]&&s[r]?1:s[t]&&!s[r]?-1:e[t].total_shares<e[r].total_shares?1:-1)).map((t=>r[t]=e[t])),await d(r)}),[e,l,i,n,s,t]);return(0,v.useEffect)((()=>{c().then((()=>{setTimeout((()=>{(0,Z.be)()}),500)}))}),[c]),o},bt=()=>{const{farms:e}=(0,r.useSelector)((e=>e)),t=xt(e),s=(0,v.useMemo)((()=>Object.keys(t)),[t]);return s.length?(0,E.jsx)(o.Row,{gutter:[16,16],children:s.map((e=>(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(Z.ZP,{height:84,children:(0,E.jsx)(wt,{farmAddress:e})})},e)))}):(0,E.jsx)(o.Empty,{})},{sol:{senOwners:jt}}=C,At=()=>{const{sentreFarms:e}=z(),t=xt(e),s=(0,v.useMemo)((()=>Object.keys(t)),[t]),r=(0,v.useMemo)((()=>s.filter((e=>jt.includes(t[e].owner)))),[t,s]),a=(0,v.useMemo)((()=>r.sort(((e,s)=>t[e].total_shares<t[s].total_shares?1:-1))),[t,r]);return 0===a.length?(0,E.jsx)(o.Empty,{}):(0,E.jsx)(o.Row,{gutter:[16,16],children:a.map(((e,t)=>(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(Z.ZP,{height:84,children:(0,E.jsx)(wt,{farmAddress:e})})},e+t)))})},{sol:{farming:St}}=C,kt=()=>{const[e,t]=(0,v.useState)({}),{farms:s,debts:n}=(0,r.useSelector)((e=>e)),{wallet:{address:i}}=(0,a.useWallet)(),o=(0,v.useCallback)((async e=>{const t=await St.deriveDebtAddress(i,e),s=n[t];return(null===s||void 0===s?void 0:s.shares)>BigInt(0)}),[n,i]),d=(0,v.useCallback)((async e=>{const s={};for(const t in e){await o(t)&&(s[t]=e[t])}t(s)}),[o]);return(0,v.useEffect)((()=>{d(s)}),[s,d]),{stakedFarms:e,filterStakedFarms:d,checkStakedFarm:o}},Ct=()=>{const{stakedFarms:e}=kt(),t=xt(e);return 0===Object.keys(t).length?(0,E.jsx)(o.Empty,{}):(0,E.jsx)(o.Row,{gutter:[16,16],children:Object.keys(t).map((e=>(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(Z.ZP,{height:84,children:(0,E.jsx)(wt,{farmAddress:e})})},e)))})},vt=()=>{const[e,t]=(0,v.useState)({}),s=(0,r.useSelector)((e=>e.farms)),{wallet:{address:n}}=(0,a.useWallet)(),i=(0,v.useCallback)((e=>s[e].owner===n),[s,n]),o=(0,v.useCallback)((e=>{const s={};for(const t in e)i(t)&&(s[t]=e[t]);t(s)}),[i]);return(0,v.useEffect)((()=>{o(s)}),[s,o]),{yourFarms:e,filterYourFarms:o,checkYourFarm:i}},Tt=()=>{const{yourFarms:e}=vt(),t=xt(e);return Object.keys(t).length?(0,E.jsx)(o.Row,{gutter:[16,16],children:Object.keys(t).map((e=>(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(Z.ZP,{height:84,children:(0,E.jsx)(wt,{farmAddress:e})})},e)))}):(0,E.jsx)(o.Empty,{})};var It;!function(e){e.YourFarms="YourFarms",e.SenFarm="SenFarm",e.StakedFarm="StakedFarm",e.AllFarms="AllFarms"}(It||(It={}));const Pt=()=>{const e=(0,n.useLocation)().search,t=(0,r.useSelector)((e=>e.main.search)),{checkStakedFarm:s}=kt(),{checkYourFarm:a}=vt(),{checkSentreFarm:i}=z(),d=(0,r.useDispatch)(),[l,c]=(0,v.useState)(It.SenFarm),[u,m]=(0,v.useState)(!1);(0,v.useEffect)((()=>{(async()=>{if(y.account.isAddress(t)&&!u)try{if(a(t))return c(It.YourFarms);if(i(t))return c(It.SenFarm);const e=await s(t);c(e?It.StakedFarm:It.AllFarms)}catch(e){}finally{m(!0)}})()}),[i,s,a,t,u]),(0,v.useEffect)((()=>{const t=new URLSearchParams(e).get("search");if(t)return d(Fe({search:t})),c(It.AllFarms),()=>{d(Fe({search:""}))}}),[d,e]);return(0,E.jsxs)(o.Tabs,{activeKey:l,onChange:e=>{c(e),setTimeout((()=>{(0,Z.be)()}),500)},tabBarExtraContent:(0,E.jsx)(J,{}),children:[(0,E.jsx)(o.Tabs.TabPane,{tab:"Sentre Farms",children:(0,E.jsx)(At,{})},It.SenFarm),(0,E.jsx)(o.Tabs.TabPane,{tab:"Staked Farms",children:(0,E.jsx)(Ct,{})},It.StakedFarm),(0,E.jsx)(o.Tabs.TabPane,{tab:"Your Farms",children:(0,E.jsx)(Tt,{})},It.YourFarms),(0,E.jsx)(o.Tabs.TabPane,{tab:"All Farms",children:(0,E.jsx)(bt,{})},It.AllFarms)]})},{sol:{farming:Et}}=C;let _t=0,Rt=BigInt(0);const Wt=e=>{let{children:t}=e;const s=(0,r.useDispatch)(),{wallet:{address:n,lamports:i}}=(0,a.useWallet)(),o=(0,v.useCallback)((async()=>{try{if(!y.account.isAddress(n))return;await s(Pe({owner:n})).unwrap()}catch(e){await L(e)}}),[s,n]),d=(0,v.useCallback)((async()=>{if(!y.account.isAddress(n))return console.warn("Wallet is not connected");if(_t)return console.warn("Already watched");const e=[{dataSize:89},{memcmp:{bytes:n,offset:32}}];_t=Et.watch(((e,t)=>{if(e)return console.error(e);const{type:r,address:a,data:n}=t;return"debt"===r?s(_e({address:a,data:n})):void 0}),e)}),[s,n]);return(0,v.useEffect)((()=>{Rt&&i>Rt&&s(Pe({owner:n})),Rt=i}),[s,n,i]),(0,v.useEffect)((()=>(o(),d(),()=>{(async()=>{try{await Et.unwatch(_t)}catch(e){}})(),_t=0})),[o,d]),t},{sol:{farming:Bt,senAddress:Ft}}=C;let zt=0;const Mt=e=>{let{children:t,style:s={}}=e;const a=(0,r.useDispatch)(),[n,i]=(0,v.useState)(!1),d=(0,v.useCallback)((async()=>{try{i(!0),await a(Ae()).unwrap()}catch(e){await L(e)}finally{i(!1)}}),[a]),l=(0,v.useCallback)((async()=>{if(zt)return console.warn("Already watched");const e=[{dataSize:209},{memcmp:{bytes:Ft,offset:97}}];zt=Bt.watch(((e,t)=>{if(e)return console.error(e);const{type:s,address:r,data:n}=t;return"farm"===s?a(ke({address:r,data:n})):void 0}),e)}),[a]);return(0,v.useEffect)((()=>(d(),l(),()=>{(async()=>{try{Bt.unwatch(zt)}catch(e){}})(),zt=0})),[d,l]),(0,E.jsx)(o.Spin,{spinning:n,style:s,children:t})},Dt=e=>{let{children:t,style:s}=e;return(0,E.jsx)(Mt,{style:s,children:(0,E.jsx)(Wt,{children:t})})},{route:{farmRoute:Zt}}=C,Ot=()=>{const{search:e,pathname:t}=(0,n.useLocation)(),{search:s}=(0,r.useSelector)((e=>e.main)),a=(0,r.useDispatch)(),d=(0,n.useHistory)();return(0,E.jsx)(Dt,{children:(0,E.jsxs)(o.Row,{gutter:[24,24],style:{paddingBottom:12},justify:"center",children:[(0,E.jsx)(o.Col,{xs:24,lg:18,children:(0,E.jsx)(D,{})}),(0,E.jsx)(o.Col,{xs:24,lg:18,children:(0,E.jsxs)(o.Row,{gutter:[8,8],children:[(0,E.jsx)(o.Col,{xs:24,lg:8,children:(0,E.jsx)(o.Card,{bodyStyle:{padding:0},style:{borderRadius:8,background:"transparent",boxShadow:"unset"},children:(0,E.jsx)(o.Input,{placeholder:"Search by name, address",value:s,onChange:s=>(new URLSearchParams(e).get("search")&&d.push(t),a(Fe({search:s.target.value}))),prefix:s?(0,E.jsx)(o.Button,{type:"text",style:{width:"auto",height:"auto",background:"transparent"},onClick:()=>(a(Fe({search:""})),d.push(Zt)),icon:(0,E.jsx)(i.Z,{name:"close-outline"})}):(0,E.jsx)(i.Z,{name:"search-outline"}),bordered:!1,size:"large"})})}),(0,E.jsx)(o.Col,{span:24,children:(0,E.jsx)(Pt,{})})]})})]})})};var Nt=s(45597);const{manifest:{appId:Kt}}=C,Lt=()=>(0,E.jsx)(a.UIProvider,{appId:Kt,antd:!0,children:(0,E.jsx)(a.PoolProvider,{children:(0,E.jsx)(a.MintProvider,{children:(0,E.jsx)(a.AccountProvider,{children:(0,E.jsx)(a.WalletProvider,{children:(0,E.jsx)(r.Provider,{store:Me,children:(0,E.jsx)(Ot,{})})})})})})})},83272:(e,t,s)=>{"use strict";e.exports=s.p+"static/media/README.dd3222bdab290f263138.md"},70854:(e,t,s)=>{"use strict";e.exports=s.p+"static/media/panel.b9f205289419b34b5909.png"},27803:(e,t,s)=>{"use strict";e.exports=s.p+"static/media/panel1.18a27df4f6df24a4cda6.png"},85468:(e,t,s)=>{"use strict";e.exports=s.p+"static/media/panel2.c1dd88a37d9553466530.png"},46601:()=>{},89214:()=>{},85568:()=>{},52361:()=>{},94616:()=>{},55024:()=>{}}]);
//# sourceMappingURL=src_bootstrap_app_tsx.905a0c97.chunk.js.map