(globalThis.webpackChunksen_farming=globalThis.webpackChunksen_farming||[]).push([[796],{14631:(e,s,t)=>{"use strict";t.r(s),t.d(s,{Page:()=>Is,Widget:()=>_s,widgetConfig:()=>Bs});var r=t(55754),n=t(98846),a=t(45055),l=t(99019),i=t(92950);const o={"logo-telegram":t.p+"static/media/icon-telegram.2450489f40d03000fe65fc1c6f238d85.svg"};var d=t(45263);const c=(0,i.forwardRef)(((e,s)=>{let{name:t,className:r,...n}=e;const a=r?"anticon "+r:"anticon";return(0,d.jsx)("span",{className:a,...n,children:o[t]?(0,d.jsx)("ion-icon",{ref:s,src:o[t]}):(0,d.jsx)("ion-icon",{ref:s,name:t})})}));var u=t(63805);const h={appId:"sen_farming",url:"https://descartesnetwork.github.io/sen-farming/index.js"},x={development:{...h},staging:{...h},production:{...h}};var p=t(95418);const m={devnet:{node:"https://api.devnet.solana.com",spltAddress:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",splataAddress:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",senAddress:"5YwUkPdXLoujGkZuo9B4LsLKj3hdkDcfP4derpspifSJ",farmingAddress:"CpEsjrLhBkcuApn5uEE2tZCwxyCQKmT6S4YgT9zuLW2J",get farming(){return new p.Farming(this.farmingAddress,this.spltAddress,this.splataAddress,this.node)},senOwners:["GJLqpmDxxrV9xruee2vFvEoTho7VVQHRtuHH8nfoAE54"]},testnet:{node:"https://api.testnet.solana.com",spltAddress:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",splataAddress:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",senAddress:"5YwUkPdXLoujGkZuo9B4LsLKj3hdkDcfP4derpspifSJ",farmingAddress:"CpEsjrLhBkcuApn5uEE2tZCwxyCQKmT6S4YgT9zuLW2J",get farming(){return new p.Farming(this.farmingAddress,this.spltAddress,this.splataAddress,this.node)},senOwners:["GJLqpmDxxrV9xruee2vFvEoTho7VVQHRtuHH8nfoAE54"]},mainnet:{node:"https://solana-api.projectserum.com",spltAddress:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",splataAddress:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",senAddress:"SENBBKVCM7homnf5RX9zqpf1GFe935hnbU4uVzY1Y6M",farmingAddress:"DTvdh6Q13SfYxMoWyibBUmQAUqd2pDPSpjdku5a9NLSF",get farming(){return new p.Farming(this.farmingAddress,this.spltAddress,this.splataAddress,this.node)},senOwners:["Cs6jYywHTAgdvjxn8xG4VkJJH8DXXy7zbtatzMUWoCMG"]}},y={development:{farmRoute:"/app/senhub"},staging:{farmRoute:"/app/sen_farming"},production:{farmRoute:"/app/sen_farming"}},j={manifest:x[u.OB],sol:m[u.ef],route:y[u.OB]};var f=t(34559);const g={address:"",icon:"",name:"TOKEN",price:0,priceChange:0,rank:0,symbol:"TOKEN",totalVolume:0},w=e=>{const[s,t]=(0,i.useState)(g),{tokenProvider:r}=(0,n.useMint)(),a=(0,i.useCallback)((async()=>{try{var s;const n=await r.findByAddress(e),a=null===n||void 0===n||null===(s=n.extensions)||void 0===s?void 0:s.coingeckoId,l=await(0,f.l$)(a);return t(l)}catch(n){return t(g)}}),[e,r]);return(0,i.useEffect)((()=>{a()}),[a]),s},b=e=>{const{tokenProvider:s}=(0,n.useMint)(),{pools:t}=(0,n.usePool)(),[r,a]=(0,i.useState)([]),l=(0,i.useCallback)((async()=>{const r=await s.findByAddress(e);if(r)return a([r]);const n=Object.values(t).find((s=>{let{mint_lpt:t}=s;return t===e}));if(!n)return a([void 0]);const{mint_a:l,mint_b:i}=n,o=await s.findByAddress(l),d=await s.findByAddress(i);return a([o,d])}),[e,t,s]);return(0,i.useEffect)((()=>{l()}),[l]),r},v=e=>{let{mintAddress:s,size:t=24,icon:r=(0,d.jsx)(c,{name:"diamond-outline"}),isReserve:n=!1}=e;const a=b(s),o=(0,i.useMemo)((()=>{const e=JSON.parse(JSON.stringify(a));return n?e.reverse():e}),[n,a]);return(0,d.jsx)(l.Avatar.Group,{style:{display:"block",whiteSpace:"nowrap"},children:o.map(((e,s)=>(0,d.jsx)(l.Avatar,{src:null===e||void 0===e?void 0:e.logoURI,size:t,style:{backgroundColor:"#2D3355",border:"none"},children:r},(null===e||void 0===e?void 0:e.address)||s)))})},C=e=>{let{mintAddress:s,separator:t=" \u2022 ",isReverse:r=!1}=e;const n=b(s),a=(0,i.useMemo)((()=>{let e=n.map((e=>{if(!e)return(0,f.Xn)(s);const{name:t,address:r,symbol:a}=e;return 1===n.length&&t?t:a||(0,f.Xn)(r)}));return r&&e.reverse(),e.join(t),1===n.length?e:`${e} LPT`}),[r,s,t,n]);return(0,d.jsx)("span",{children:a})},S=e=>{let{mintAddress:s,separator:t=" \u2022 ",isReverse:r=!1}=e;const n=b(s),a=(0,i.useMemo)((()=>{const e=n.map((e=>{const t=`${null===s||void 0===s?void 0:s.substr(0,3)}...`;return e?e.symbol:t}));return r&&e.reverse(),e.join(t)}),[r,s,t,n]);return(0,d.jsx)("span",{children:a})},A=()=>{const{tokenProvider:e,getMint:s}=(0,n.useMint)(),{pools:t}=(0,n.usePool)(),r=(0,i.useCallback)((async(s,t)=>{try{var r;const n=await e.findByAddress(s),a=null===n||void 0===n||null===(r=n.extensions)||void 0===r?void 0:r.coingeckoId;if(!a)throw new Error("Cant not find coingeckoId");const l=await(0,f.l$)(a);return Number(p.utils.undecimalize(t,n.decimals))*l.price}catch(n){return 0}}),[e]),a=(0,i.useCallback)((async n=>{let{mintAddress:l,amount:i}=n;if(await e.findByAddress(l))return r(l,i);const o=Object.values(t).find((e=>e.mint_lpt===l));if(!o)return 0;const{reserve_a:d,reserve_b:c,mint_a:u,mint_b:h}=o;if(d*c===BigInt(0))return 0;const{[l]:{supply:x}}=await s({address:l}),{deltaA:m,deltaB:y}=p.Swap.oracle.withdraw(i,x,d,c);return await a({mintAddress:u,amount:m})+await a({mintAddress:h,amount:y})}),[s,r,e,t]);return{getTotalValue:a}},{sol:{senOwners:k}}=j,T=()=>{const e=(0,r.useSelector)((e=>e.farms)),[s,t]=(0,i.useState)({}),n=(0,i.useCallback)((s=>{const t=e[s];return k.includes(t.owner)}),[e]),a=(0,i.useCallback)((e=>{const s={};for(const t in e)n(t)&&(s[t]=e[t]);t(s)}),[n]);return(0,i.useEffect)((()=>{a(e)}),[e,a]),{sentreFarms:s,filterSentreFarms:a,checkSentreFarm:n}},{sol:{senAddress:R}}=j,z=()=>{const{ui:{width:e}}=(0,n.useUI)(),s=(0,r.useSelector)((e=>e.farms)),t=w(R),a=(()=>{const[e,s]=(0,i.useState)(0),{sentreFarms:t}=T(),{getTotalValue:r}=A(),n=(0,i.useCallback)((async()=>{let e=0;await Promise.all(Object.values(t).map((async s=>{const{total_shares:t,mint_stake:n}=s,a=await r({mintAddress:n,amount:t});e+=a}))),s(e)}),[t,r]);return(0,i.useEffect)((()=>{n()}),[n]),e})(),o=e>768,u=o?void 0:24,h=o?32:16,x=o?8:4,p=o?"vertical":"horizontal",m=o?"pause-outline":"reorder-two-outline",y=(0,i.useMemo)((()=>{let e=0;for(const t in s)s[t].total_shares&&e++;return e}),[s]);return(0,d.jsx)(l.Card,{bordered:!1,className:(o?"":"banner-farming-mobile ")+"banner-farming",children:(0,d.jsxs)(l.Row,{gutter:[12,h],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Typography.Title,{level:4,style:{color:"#212433"},children:"Sen Farming"})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Row,{gutter:[12,12],children:[(0,d.jsx)(l.Col,{span:u,children:(0,d.jsxs)(l.Space,{direction:"vertical",size:x,children:[(0,d.jsx)(l.Typography.Text,{style:{color:"#212433"},children:"Total Sentre Farms TVL"}),(0,d.jsx)(l.Typography.Title,{level:2,style:{color:"#F9575E"},children:(0,f.uR)(a).format("0,0.[00]$")})]})}),o&&(0,d.jsx)(l.Col,{children:(0,d.jsx)(l.Divider,{type:"vertical",style:{height:"100%"}})}),(0,d.jsx)(l.Col,{span:u,children:(0,d.jsxs)(l.Space,{direction:"vertical",size:x,children:[(0,d.jsx)(l.Typography.Text,{style:{color:"#212433"},children:"Active Farms"}),(0,d.jsx)(l.Typography.Title,{level:2,style:{color:"#F9575E"},children:y})]})}),o&&(0,d.jsx)(l.Col,{children:(0,d.jsx)(l.Divider,{type:"vertical",style:{height:"100%"}})}),(0,d.jsx)(l.Col,{span:u,children:(0,d.jsxs)(l.Space,{direction:p,size:0,align:"center",children:[(0,d.jsxs)(l.Typography.Title,{level:4,style:{color:"#212433"},children:["1 ",(0,d.jsx)(S,{mintAddress:R})]}),(0,d.jsx)(c,{style:{color:"#212433"},name:m}),(0,d.jsx)(l.Typography.Title,{level:4,style:{color:"#F9575E"},children:(0,f.uR)(t.price).format("0,0.[0000]$")})]})})]})})]})})};var P=t(44891);let F;const E=(0,i.forwardRef)(((e,s)=>{var t;let{max:r,onValue:n=(()=>{}),onChange:a=(()=>{}),...o}=e;const[u,h]=(0,i.useState)(""),[x,p]=(0,i.useState)(null),m=(0,i.useRef)(s),y=(0,i.useCallback)((e=>{const s=e=>{F&&(clearTimeout(F),F=void 0),h(e),F=setTimeout((()=>h("")),500)};return/^\d*(\.\d*)?$/.test(e)?r&&parseFloat(e)>parseFloat(r.toString())?s("Not enough balance"):n(e):s("Invalid character")}),[r,n]);return null!==x&&(null===m||void 0===m||null===(t=m.current)||void 0===t||t.setSelectionRange(x,x)),(0,d.jsx)(l.Tooltip,{title:(0,d.jsxs)(l.Space,{children:[(0,d.jsx)(c,{name:"warning"}),u]}),visible:!!u,children:(0,d.jsx)(l.Input,{...o,onChange:e=>{a(e),p(e.target.selectionStart),y(e.target.value||"")},ref:m})})})),I=(e,s)=>window.notify({type:"success",description:`${e} successfully. Click to view details.`,onClick:()=>window.open((0,f.kU)(s),"_blank")}),B=e=>window.notify({type:"error",description:e.message}),_=e=>{const[s,t]=(0,i.useState)(void 0),{getDecimals:r}=(0,n.useMint)(),a=(0,i.useCallback)((async()=>{try{const s=await r(e);return t(s)}catch(s){return t(void 0)}}),[e,r]);return(0,i.useEffect)((()=>{a()}),[a]),s},N={Hour:BigInt(3600),Day:BigInt(86400),Month:BigInt(2592e3),Year:BigInt(31536e3)},O=e=>{let{mintAddress:s,onClose:t=(()=>{}),setVisibleInputTokenModal:r=(()=>{})}=e;const{sol:{senAddress:a,farming:o}}=j,[u,h]=(0,i.useState)(""),[x,m]=(0,i.useState)(""),[y,f]=(0,i.useState)("Hour"),[g,w]=(0,i.useState)(!1),b=_(a),{wallet:{address:C}}=(0,n.useWallet)(),A=!u||!x||!p.account.isAddress(s);return(0,d.jsxs)(l.Row,{gutter:[16,16],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Typography.Title,{level:4,children:"New farm"})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Card,{style:{borderRadius:8},bodyStyle:{padding:16},bordered:!1,children:(0,d.jsxs)(l.Row,{gutter:[16,16],children:[(0,d.jsx)(l.Col,{span:12,children:(0,d.jsxs)(l.Space,{direction:"vertical",children:[(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"Input"}),(0,d.jsxs)(l.Space,{size:12,style:{cursor:"pointer"},onClick:()=>r(!0),children:[(0,d.jsx)(v,{mintAddress:s}),p.account.isAddress(s)?(0,d.jsx)(S,{mintAddress:s}):(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"Select token type"}),(0,d.jsx)(c,{name:"chevron-forward-outline",style:{color:"#7A7B85"}})]})]})}),(0,d.jsx)(l.Col,{span:12,children:(0,d.jsxs)(l.Space,{direction:"vertical",children:[(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"Output"}),(0,d.jsxs)(l.Space,{size:12,style:{cursor:"pointer"},children:[(0,d.jsx)(v,{mintAddress:a}),(0,d.jsx)(S,{mintAddress:a})]})]})})]})})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Row,{gutter:[0,0],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Typography.Text,{type:"secondary",className:"caption",children:"Reward"})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(E,{size:"large",placeholder:"0",value:u,onValue:h,prefix:(0,d.jsx)(l.Typography.Text,{children:"SNTR"})})})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Row,{gutter:[0,0],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Typography.Text,{type:"secondary",className:"caption",children:["Number of ",y]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(E,{size:"large",placeholder:"0",value:x,onValue:m,suffix:(0,d.jsx)(l.Button,{type:"text",size:"small",icon:(0,d.jsx)(c,{name:"time-outline"}),onClick:()=>{const e=Object.keys(N),s=(e.findIndex((e=>e===y))+1)%e.length;return f(e[s])},children:y})})})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Button,{type:"primary",onClick:async()=>{if(!p.account.isAddress(s))return B({message:`Invalid mint address: ${s}`});w(!0);const{wallet:e}=window.sentre;if(!e||!y||!x||!b)return;const r=p.utils.decimalize(u,b),n=Number(null===N||void 0===N?void 0:N[y])*Number(x);try{const{txId:l}=await o.initializeFarm(r,BigInt(n),C,s,a,e);return t(),I("Create a new farm",l)}catch(l){return B({message:l.message})}finally{return w(!1)}},disabled:A,block:!0,loading:g,children:"Confirm"})})]})},M=e=>{let{accountAddress:s,onClick:t=(()=>{})}=e;const{accounts:{[s]:{mint:r}}}=(0,n.useAccount)(),a=(0,i.useMemo)((()=>s.substring(0,4)+" ... "+s.substring(s.length-4,s.length)),[s]);return(0,d.jsx)(l.Card,{onClick:()=>t(r),className:"account-card",bodyStyle:{padding:12,cursor:"pointer"},bordered:!1,children:(0,d.jsxs)(l.Row,{gutter:[8,8],wrap:!1,align:"middle",children:[(0,d.jsx)(l.Col,{flex:"auto",children:(0,d.jsxs)(l.Space,{direction:"vertical",size:0,children:[(0,d.jsxs)(l.Space,{children:[(0,d.jsx)(v,{mintAddress:r}),(0,d.jsx)(C,{mintAddress:r})]}),(0,d.jsxs)(l.Space,{children:[(0,d.jsxs)(l.Space,{size:4,children:[(0,d.jsx)(l.Typography.Text,{type:"secondary",style:{fontSize:12},children:"Account Address:"}),(0,d.jsx)(l.Typography.Text,{children:a})]}),(0,d.jsx)(l.Button,{type:"text",size:"small",onClick:e=>{e.stopPropagation(),(0,f.RB)((0,f.kU)(s))},icon:(0,d.jsx)(c,{name:"open-outline"})})]})]})}),(0,d.jsx)(l.Col,{children:(0,d.jsx)(l.Button,{type:"text",icon:(0,d.jsx)(c,{name:"arrow-forward-outline"})})})]})})},D=e=>{let{onChange:s}=e;const[t,r]=(0,i.useState)("");return(0,i.useEffect)((()=>s(t)),[t,s]),(0,d.jsx)(l.Card,{className:"account-card",bodyStyle:{padding:6},bordered:!1,children:(0,d.jsx)(l.Input,{placeholder:"Search",value:t,size:"small",bordered:!1,prefix:(0,d.jsx)(l.Button,{type:"text",style:{marginLeft:-7},size:"small",onClick:t?()=>r(""):()=>{},icon:(0,d.jsx)(c,{name:t?"close-outline":"search-outline"})}),onChange:e=>r(e.target.value)})})},L=e=>{let{onChange:s,onHideInputTokenModal:t=(()=>{})}=e;const{searchedAccount:r,accountAddresses:a,onSearch:o}=(()=>{const[e,s]=(0,i.useState)(),{accounts:t}=(0,n.useAccount)(),{tokenProvider:r}=(0,n.useMint)(),a=(0,i.useMemo)((()=>Object.keys(t)),[t]),l=(0,i.useCallback)((async e=>{if(!e||e.length<3)return s(void 0);const n=(await r.find(e)).map((e=>{let{address:s}=e;return s}));let l=[];return a.forEach((e=>{var s;if(n.includes(null===(s=t[e])||void 0===s?void 0:s.mint))return l.push(e)})),s(l)}),[a,t,r]);return{searchedAccount:e,accountAddresses:a,onSearch:l}})(),c=e=>(t(!1),s(e));return(0,d.jsxs)(l.Row,{gutter:[16,16],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Typography.Title,{level:4,children:"Select token type"})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(D,{onChange:o})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Row,{gutter:[16,16],style:{height:300,overflow:"auto"},children:(r||a).map(((e,s)=>(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(P.ZP,{height:72,overflow:!0,children:(0,d.jsx)(M,{accountAddress:e,onClick:c})})},e+s)))})})]})},W=e=>{let{size:s="small"}=e;const[t,r]=(0,i.useState)(!1),[n,a]=(0,i.useState)(""),[o,u]=(0,i.useState)(!1);return(0,d.jsxs)(l.Row,{children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Button,{style:{background:"transparent"},onClick:()=>r(!0),size:s,children:"New Farm"})}),(0,d.jsx)(l.Modal,{visible:t,onCancel:()=>r(!1),footer:!1,closeIcon:(0,d.jsx)(c,{name:"close-outline"}),children:(0,d.jsx)(O,{mintAddress:n,onClose:()=>{r(!1),a("")},setVisibleInputTokenModal:u})}),(0,d.jsx)(l.Modal,{visible:o,onCancel:()=>u(!1),footer:!1,closeIcon:(0,d.jsx)(c,{name:"close-outline"}),children:(0,d.jsx)(L,{onChange:e=>{a(e)},onHideInputTokenModal:u})})]})},V=e=>{let{label:s="",tooltip:t,value:r="",mintAddress:n}=e;return(0,d.jsxs)(l.Space,{direction:"vertical",size:4,children:[(0,d.jsxs)(l.Space,{size:4,children:[(0,d.jsxs)(l.Space,{size:4,children:[n&&(0,d.jsx)(v,{mintAddress:n}),(0,d.jsx)(l.Typography.Text,{type:"secondary",children:s})]}),t&&(0,d.jsx)(l.Tooltip,{title:t,children:(0,d.jsx)(l.Button,{type:"text",shape:"circle",size:"small",icon:(0,d.jsx)(l.Typography.Text,{type:"secondary",children:(0,d.jsx)(c,{name:"information-circle-outline"})})})})]}),(0,d.jsxs)(l.Space,{children:[(0,d.jsx)(l.Typography.Title,{level:5,children:r}),n&&(0,d.jsx)(S,{mintAddress:n})]})]})},{sol:{farming:Q}}=j,$=e=>{const[s,t]=(0,i.useState)(""),{debts:{[s]:a}}=(0,r.useSelector)((e=>e)),{wallet:{address:l}}=(0,n.useWallet)(),o=(0,i.useCallback)((async()=>{if(!p.account.isAddress(e))return t("");const s=await Q.deriveDebtAddress(l,e);return t(s)}),[e,l]);return(0,i.useEffect)((()=>{o()}),[o]),{address:s,data:a}};var q=t(21111),U=t.n(q);const G=e=>{const{accounts:s}=(0,n.useAccount)(),{wallet:{address:t}}=(0,n.useWallet)(),a=(0,r.useSelector)((s=>s.farms[e])),[l,o]=(0,i.useState)(),d=(0,i.useCallback)((async()=>{if(!(null===a||void 0===a?void 0:a.mint_stake))return o(void 0);const{splt:e}=window.sentre,r=await e.deriveAssociatedAddress(t,a.mint_stake),n=s[r];return U()(n,null===l||void 0===l?void 0:l.data)?void 0:o({address:r,data:n})}),[null===l||void 0===l?void 0:l.data,s,a.mint_stake,t]);return(0,i.useEffect)((()=>{d()}),[d]),l},H=(e,s)=>{if(null===e||0===Object.keys(e).length)return 0;if(null===s||0===Object.keys(s).length)return 0;if(!s.total_shares)return 0;const r=e.shares,n=s.compensation,a=(t.g.BigInt(Math.floor(Date.now()/1e3))-s.genesis_timestamp)/s.period,l=t.g.BigInt(10**18),i=(l*s.reward/s.total_shares*a+n)*r/l,o=p.utils.undecimalize(i-e.debt,9);return Number(o)},Y="The treasury doesn't have enough balance for the claim.",J="Invalid wallet address.",Z="Invalid farm address.",K="Invalid debt address.",X="Cannot fetch data of debts";var ee=t(19289),se=t(85912);const{sol:{farming:te,senAddress:re}}=j,ne="farms",ae=(0,ee.createAsyncThunk)("farms/getFarms",(async(e,s)=>{let{getState:t}=s;const{farms:r}=t();if(Object.keys(r).length)return r;const n=await te.connection.getProgramAccounts(te.farmingProgramId,{filters:[{dataSize:209},{memcmp:{bytes:re,offset:97}}]});let a={};return n.forEach((e=>{let{pubkey:s,account:{data:t}}=e;const r=s.toBase58(),n=te.parseFarmData(t);a[r]=n})),a})),le=(0,ee.createAsyncThunk)("farms/getFarm",(async(e,s)=>{let{address:t}=e,{getState:r}=s;if(!p.account.isAddress(t))throw new Error("Invalid farm address");const{farms:{[t]:n}}=r();if(n)return{[t]:n};return{[t]:await te.getFarmData(t)}})),ie=(0,ee.createAsyncThunk)("farms/upsetFarm",(async e=>{let{address:s,data:t}=e;if(!p.account.isAddress(s))throw new Error("Invalid farm address");if(!t)throw new Error("Data is empty");return{[s]:t}})),oe=(0,ee.createAsyncThunk)("farms/deleteFarm",(async e=>{let{farmAddress:s}=e;if(!p.account.isAddress(s))throw new Error("Invalid address");return{farmAddress:s}})),de=(0,ee.createSlice)({name:ne,initialState:{},reducers:{},extraReducers:e=>{e.addCase(ae.fulfilled,((e,s)=>{let{payload:t}=s;Object.assign(e,t)})).addCase(le.fulfilled,((e,s)=>{let{payload:t}=s;Object.assign(e,t)})).addCase(ie.fulfilled,((e,s)=>{let{payload:t}=s;Object.assign(e,t)})).addCase(oe.fulfilled,((e,s)=>{let{payload:t}=s;delete e[t.farmAddress]}))}}).reducer,{sol:{farming:ce}}=j,ue="debts",he=(0,ee.createAsyncThunk)("debts/getDebts",(async e=>{let{owner:s}=e;if(!p.account.isAddress(s))throw new Error("Invalid owner/wallet address");const t=await ce.connection.getProgramAccounts(ce.farmingProgramId,{filters:[{dataSize:89},{memcmp:{bytes:s,offset:32}}]});let r={};return t.forEach((e=>{let{pubkey:s,account:{data:t}}=e;const n=s.toBase58(),a=ce.parseDebtData(t);return r[n]=a})),r})),xe=(0,ee.createAsyncThunk)("debts/getDebt",(async(e,s)=>{let{address:t}=e,{getState:r}=s;const{debts:{[t]:n}}=r();if(n)return{[t]:n};return{[t]:await ce.getDebtData(t)}})),pe=(0,ee.createAsyncThunk)("debts/upsetDebt",(async e=>{let{address:s,data:t}=e;if(!p.account.isAddress(s))throw new Error("Invalid address");if(!t)throw new Error("Data is empty");return{[s]:t}})),me=(0,ee.createAsyncThunk)("debts/deleteDebt",(async e=>{let{address:s}=e;if(!p.account.isAddress(s))throw new Error("Invalid address");return{address:s}})),ye=(0,ee.createSlice)({name:ue,initialState:{},reducers:{},extraReducers:e=>{e.addCase(he.fulfilled,((e,s)=>{let{payload:t}=s;return t})).addCase(xe.fulfilled,((e,s)=>{let{payload:t}=s;Object.assign(e,t)})).addCase(pe.fulfilled,((e,s)=>{let{payload:t}=s;Object.assign(e,t)})).addCase(me.fulfilled,((e,s)=>{let{payload:t}=s;delete e[t.address]}))}}).reducer,je="main",fe=(0,ee.createAsyncThunk)("main/setSearch",(async(e,s)=>{let{search:t}=e,{getState:r}=s;return{search:t}})),ge=(0,ee.createSlice)({name:je,initialState:{search:""},reducers:{},extraReducers:e=>{e.addCase(fe.fulfilled,((e,s)=>{let{payload:t}=s;Object.assign(e,t)}))}}).reducer,we=(0,ee.configureStore)({middleware:e=>e(se.h),devTools:(0,se.$)("sen_farming"),reducer:{farms:de,debts:ye,main:ge}}),{sol:{farming:be}}=j;class ve{async checkSeedBalance(e){const{splt:s,wallet:t}=window.sentre;if(!t)throw new Error("Please connect wallet first!");const r=we.getState().farms[e],n=await t.getAddress();if(!p.account.isAddress(n))throw new Error(J);const a=await be.deriveDebtAddress(n,e);if(!p.account.isAddress(a))throw new Error(K);const l=we.getState().debts[a];if(!l)throw new Error(X);const i=H(l,r),{treasury_reward:o,treasury_stake:d,total_shares:c}=r;let{amount:u}=await s.getAccountData(o);o===d&&(u-=c);if(Number(p.utils.undecimalize(u,9))<i)throw new Error(Y)}async validate(e){if(!p.account.isAddress(e))throw new Error(Z);return await this.checkSeedBalance(e)}}const{sol:{senAddress:Ce,farming:Se}}=j,Ae=e=>{let{farmAddress:s,onClose:t}=e;const a=(0,r.useSelector)((e=>{var t;return null===(t=e.farms)||void 0===t?void 0:t[s]})),{wallet:{address:o}}=(0,n.useWallet)(),{data:u}=$(s),h=G(s),[x,m]=(0,i.useState)(),[y,j]=(0,i.useState)(!0),[g,w]=(0,i.useState)(!1),b=_(a.mint_stake),v=(0,i.useCallback)((async e=>(await m(e),e?await j(!1):await j(!0))),[]),C=(0,i.useMemo)((()=>{if(b)return p.utils.undecimalize(null===u||void 0===u?void 0:u.shares,b)}),[null===u||void 0===u?void 0:u.shares,b]);return(0,d.jsxs)(l.Row,{gutter:[16,16],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Space,{align:"start",children:[(0,d.jsx)(c,{name:"alert-circle-outline"}),(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"The pending reward will be automatically harvested when you unstake."})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Card,{bodyStyle:{padding:12},style:{boxShadow:"none",borderRadius:8},children:(0,d.jsxs)(l.Space,{style:{width:"100%"},direction:"vertical",children:[(0,d.jsxs)(l.Row,{children:[(0,d.jsx)(l.Col,{flex:"auto",children:(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"Amount"})}),(0,d.jsx)(l.Col,{children:(0,d.jsxs)(l.Space,{size:6,children:[(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"Available:"}),(0,d.jsx)(l.Typography.Text,{children:(0,f.uR)(C).format("0,0.[00]")}),(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"LPT"})]})})]}),(0,d.jsx)(E,{placeholder:"0",value:x,onValue:v,bordered:!1,size:"large",style:{padding:0},suffix:(0,d.jsx)(l.Button,{type:"text",style:{marginRight:-7},onClick:()=>v(C),children:"MAX"}),max:C})]})})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Button,{type:"primary",icon:(0,d.jsx)(c,{name:"remove-outline"}),onClick:async()=>{w(!0);try{const{splt:e,wallet:r}=window.sentre;if(!r)throw Error("Please connect wallet first");if(!x||!h||!b)return;const n=p.utils.decimalize(x,b),a=await e.deriveAssociatedAddress(o,Ce),l=new ve;await l.validate(s);const{txId:i}=await Se.unstake(n,h.address,a,s,r);return t(!1),I("Unstaked",i)}catch(e){return B(e)}finally{w(!1)}},block:!0,disabled:y,loading:g,children:"Unstake"})})]})},{sol:{senAddress:ke,farming:Te}}=j,Re=e=>{let{farmAddress:s,onClose:t}=e;const a=(0,r.useSelector)((e=>{var t;return null===(t=e.farms)||void 0===t?void 0:t[s]})),{wallet:{address:o}}=(0,n.useWallet)(),{accounts:u}=(0,n.useAccount)(),{data:h}=$(s),x=G(s),[m,y]=(0,i.useState)(),[j,g]=(0,i.useState)(!0),[w,b]=(0,i.useState)(!1),v=_(a.mint_stake),C=(0,i.useCallback)((async e=>(await y(e),e?await g(!1):await g(!0))),[]),S=(0,i.useMemo)((()=>{if(v)return p.utils.undecimalize(BigInt((null===x||void 0===x?void 0:x.data.amount)||0),v)}),[null===x||void 0===x?void 0:x.data.amount,v]);return(0,d.jsxs)(l.Row,{gutter:[16,16],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Space,{align:"start",children:[(0,d.jsx)(c,{name:"alert-circle-outline"}),(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"The pending reward will be automatically harvested when you stake more."})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Card,{bodyStyle:{padding:12},style:{boxShadow:"none",borderRadius:8},children:(0,d.jsxs)(l.Space,{style:{width:"100%"},direction:"vertical",children:[(0,d.jsxs)(l.Row,{children:[(0,d.jsx)(l.Col,{flex:"auto",children:(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"Amount"})}),(0,d.jsx)(l.Col,{children:(0,d.jsxs)(l.Space,{size:6,children:[(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"Available:"}),(0,d.jsx)(l.Typography.Text,{children:(0,f.uR)(S).format("0,0.[00]")}),(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"LPT"})]})})]}),(0,d.jsx)(E,{placeholder:"0",value:m,onValue:C,bordered:!1,size:"large",style:{padding:0},suffix:(0,d.jsx)(l.Button,{type:"text",style:{marginRight:-15},onClick:()=>C(S),children:"MAX"}),max:S})]})})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Button,{type:"primary",icon:(0,d.jsx)(c,{name:"add-outline"}),onClick:async()=>{b(!0);try{const{splt:e,wallet:r}=window.sentre;if(!r)throw Error("Please connect wallet first");if(!m||!x||!v)return;const n=await e.deriveAssociatedAddress(o,ke);void 0===(null===h||void 0===h?void 0:h.shares)&&await Te.initializeAccounts(s,o,r),u[n]||await e.initializeAccount(ke,o,r);const a=new ve;await a.validate(s);const{txId:l}=await Te.stake(p.utils.decimalize(m,v),x.address,n,s,r);return t(!1),I("Staked",l)}catch(e){return B(e)}finally{b(!1)}},block:!0,disabled:j,loading:w,children:"Stake"})})]})},ze=e=>{let{title:s}=e;return(0,d.jsxs)(l.Space,{children:[(0,d.jsx)(c,{style:{fontSize:18},name:"alert-circle-outline"}),(0,d.jsx)(l.Typography.Text,{type:"secondary",ellipsis:!0,children:s})]})};var Pe=t(51518),Fe=t.n(Pe);const Ee=e=>{let{address:s,onCopy:t,copieAddress:r,description:n=!1,title:a}=e;return(0,d.jsxs)(l.Row,{gutter:[0,8],children:[(0,d.jsx)(l.Col,{xs:{span:24},sm:{span:10},md:{span:10},lg:{span:10},flex:"auto",children:(0,d.jsx)(ze,{title:a})}),(0,d.jsx)(l.Col,{xs:{span:22},sm:{span:14},md:{span:14},lg:{span:14},flex:"auto",children:p.account.isAddress(s)&&(0,d.jsx)(l.Typography.Text,{children:s})}),(0,d.jsx)(l.Col,{children:(0,d.jsx)(l.Tooltip,{title:"Copied",visible:s===r,children:(0,d.jsx)(Pe.CopyToClipboard,{text:s,onCopy:e=>t(e),children:(0,d.jsx)(l.Button,{type:"text",size:"small",style:{marginRight:-7},icon:(0,d.jsx)(c,{name:"copy-outline"})})})})}),n?(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Typography.Paragraph,{type:"secondary",style:{fontSize:12},children:"Tips: You can use this address for searching the pool coresponding to the farm in Sen LP."})}):null]})},Ie=e=>{const[s,t]=(0,i.useState)(0),{farms:{[e]:n}}=(0,r.useSelector)((e=>e)),{treasury_stake:a,treasury_reward:l,mint_reward:o,total_shares:d}=n||{},c=_(o),{symbol:u}=w(o),h=(0,i.useCallback)((async()=>{if(void 0===c)return t(0);try{const{splt:e}=window.sentre;let{amount:s}=await e.getAccountData(l);l===a&&(s-=d);const r=Number(p.utils.undecimalize(s,c));t(r)}catch(e){t(0)}}),[c,d,l,a]);return(0,i.useEffect)((()=>{h()}),[h]),{budget:s,budgetSymbol:u}},Be=e=>{let{farmAddress:s}=e;const{tokenProvider:t}=(0,n.useMint)(),{pools:a}=(0,n.usePool)(),{budget:o,budgetSymbol:c}=Ie(s),u=(0,r.useSelector)((e=>e.farms)),[h,x]=(0,i.useState)(""),[m,y]=(0,i.useState)(""),{mint_stake:j,period:g,reward:w,mint_reward:b}=u[s]||{},v=_(j);(0,i.useEffect)((()=>{(async()=>{const{symbol:e}=await t.findByAddress(b)||{};y(e||"TOKEN")})()}),[b,t]);const C=Object.keys(a).find((e=>{const{mint_lpt:s}=a[e];return s===j})),S=async e=>{e&&(await x(e),await(0,f.sA)(1500),await x(""))},A=(0,i.useMemo)((()=>v?p.utils.undecimalize(w,v):0),[v,w]),k=(0,i.useMemo)((()=>{let e=Number(g)/86400,s="days";return e>29&&(e/=30,s=e>1?"months":"month"),e<2&&(e*=24,s=e>1?"hours":"hour"),`${A} ${c} / ${Math.floor(e)} ${s}`}),[A,g,c]);return(0,d.jsxs)(l.Row,{gutter:[24,24],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(Ee,{title:"Farming address:",address:s,onCopy:e=>S(e),copieAddress:h})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(Ee,{title:C?"Pool address:":"Stake mint address:",address:C||j,onCopy:e=>S(e),copieAddress:h,description:!0})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Space,{align:"baseline",children:[(0,d.jsx)(ze,{title:"Rewarding:"}),(0,d.jsx)(l.Typography.Text,{style:{wordBreak:"break-all"},children:k})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Space,{align:"baseline",children:[(0,d.jsx)(ze,{title:"Budget:"}),(0,d.jsx)(l.Typography.Text,{style:{wordBreak:"break-all"},children:(0,f.uR)(o).format("0,0.[00]")}),(0,d.jsx)(l.Typography.Text,{type:"secondary",children:m})]})})]})},{sol:{senAddress:_e,farming:Ne}}=j,Oe=e=>{let{farmAddress:s,onChange:t=(()=>{})}=e;const{accounts:a}=(0,n.useAccount)(),{wallet:{address:o}}=(0,n.useWallet)(),u=(0,r.useSelector)((e=>e.farms)),[h,x]=(0,i.useState)(""),[m,y]=(0,i.useState)("0"),[j,g]=(0,i.useState)(!1),{mint_reward:w}=(null===u||void 0===u?void 0:u[s])||{},b=_(w);(0,i.useEffect)((()=>{(async()=>{if(b)try{const{splt:e}=window.sentre,s=await e.deriveAssociatedAddress(o,w),{amount:t}=a[s]||{};y(t?p.utils.undecimalize(t,b):"0")}catch(e){y("0")}})()}),[o,a,w,b]);return(0,d.jsxs)(l.Row,{gutter:[16,16],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Card,{style:{boxShadow:"unset",borderRadius:8},bodyStyle:{padding:8},children:(0,d.jsxs)(l.Row,{gutter:[0,0],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Row,{gutter:[0,0],wrap:!1,style:{margin:"6px 12px 0px 12px",fontSize:12},children:[(0,d.jsx)(l.Col,{flex:"auto",children:(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"Amount"})}),(0,d.jsx)(l.Col,{children:(0,d.jsxs)(l.Space,{size:6,children:[(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"Available:"}),(0,d.jsx)(l.Typography.Text,{children:(0,f.uR)(m).format("0,0.[00]")}),(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"SNTR"})]})})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(E,{placeholder:"0",value:h,onValue:x,suffix:(0,d.jsx)(l.Button,{type:"text",onClick:()=>x(m),size:"small",style:{marginRight:-7},children:"MAX"}),bordered:!1,max:m})})]})})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Button,{type:"primary",icon:(0,d.jsx)(c,{name:"add-outline"}),onClick:async()=>{g(!0);const{wallet:e,splt:r}=window.sentre;if(!e)return;const n=await r.deriveAssociatedAddress(o,_e),a=p.utils.decimalize(h,9);try{const{txId:r}=await Ne.seed(a,s,n,e);return t(r),I("Seed",r)}catch(l){return B(l)}finally{g(!1)}},block:!0,disabled:!h,loading:j,children:"Seed"})})]})},{sol:{farming:Me}}=j,De=e=>{let{farmAddress:s,onChange:t=(()=>{})}=e;const{wallet:{address:a}}=(0,n.useWallet)(),o=(0,r.useSelector)((e=>e.farms)),[u,h]=(0,i.useState)(""),[x,m]=(0,i.useState)("0"),[y,j]=(0,i.useState)(!1),{treasury_reward:g,mint_reward:b}=o[s]||{},v=_(b),{symbol:C}=w(b);(0,i.useEffect)((()=>{(async()=>{if(v)try{const{splt:e}=window.sentre,{amount:s}=await e.getAccountData(g);m(s?p.utils.undecimalize(s,v):"0")}catch(e){m("0")}})()}),[v,g]);return(0,d.jsxs)(l.Row,{gutter:[16,16],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Card,{style:{boxShadow:"unset",borderRadius:8},bodyStyle:{padding:8},children:(0,d.jsxs)(l.Row,{gutter:[0,0],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Row,{gutter:[0,0],wrap:!1,style:{margin:"6px 12px 0px 12px",fontSize:12},children:[(0,d.jsx)(l.Col,{flex:"auto",children:(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"Amount"})}),(0,d.jsx)(l.Col,{children:(0,d.jsxs)(l.Space,{size:6,children:[(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"Available:"}),(0,d.jsx)(l.Typography.Text,{children:(0,f.uR)(x).format("0,0.[00]")}),(0,d.jsx)(l.Typography.Text,{type:"secondary",children:C})]})})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(E,{placeholder:"0",value:u,onValue:h,suffix:(0,d.jsx)(l.Button,{type:"text",onClick:()=>h(x),size:"small",style:{marginRight:-7},children:"MAX"}),bordered:!1,max:x})})]})})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Button,{type:"primary",icon:(0,d.jsx)(c,{name:"remove-outline"}),onClick:async()=>{j(!0);const{wallet:e,splt:r}=window.sentre;if(!e||!v)return;const n=await r.deriveAssociatedAddress(a,b),l=p.utils.decimalize(u,v);try{const{txId:r}=await Me.unseed(l,s,n,e);return t(r),I("Unseed",r)}catch(i){return B(i)}finally{j(!1)}},block:!0,disabled:!u,loading:y,children:"Unseed"})})]})};let Le,We;!function(e){e[e.POLICY_AGREEMENT=0]="POLICY_AGREEMENT",e[e.FARM_CREATING_CONFIRMATION=1]="FARM_CREATING_CONFIRMATION"}(Le||(Le={})),function(e){e[e.isActive=1]="isActive",e[e.isFreeze=2]="isFreeze"}(We||(We={}));const{sol:{farming:Ve}}=j,Qe=e=>{let{farmAddress:s,onChange:t=(()=>{})}=e;const n=(0,r.useSelector)((e=>e.farms)),[a,o]=(0,i.useState)(!1),{state:u}=(null===n||void 0===n?void 0:n[s])||{},h=u===We.isActive,x=h?{backgroundColor:"#40A9FF",color:"#fff"}:{},p=h?"snow-outline":"sunny-outline",m=h?"Freeze":"Thaw";return(0,d.jsxs)(l.Row,{gutter:[16,16],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Space,{className:"caption",align:"start",children:[(0,d.jsx)(c,{name:"information-circle-outline"}),(0,d.jsx)(l.Typography.Text,{type:"secondary",children:'Freezing a farm will prevent all actions, but "seed" and "unseed", until the farm has been thawed.'})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Button,{type:"primary",style:{...x,border:"unset"},icon:(0,d.jsx)(c,{name:p}),onClick:h?async()=>{const{wallet:e}=window.sentre;if(e){o(!0);try{const{txId:r}=await Ve.freeze(s,e);return t(r),I("Freeze the farm",r)}catch(r){return B(r)}finally{o(!1)}}}:async()=>{const{wallet:e}=window.sentre;if(e){o(!0);try{const{txId:r}=await Ve.thaw(s,e);return t(r),I("Thaw the farm",r)}catch(r){return B(r)}finally{o(!1)}}},block:!0,disabled:!u,loading:a,children:m})})]})},{sol:{farming:$e}}=j,qe=e=>{let{farmAddress:s,onChange:t=(()=>{})}=e;const n=(0,r.useSelector)((e=>e.farms)),[a,o]=(0,i.useState)(!1),{total_shares:u}=(null===n||void 0===n?void 0:n[s])||{},h=(0,r.useDispatch)();return(0,d.jsxs)(l.Row,{gutter:[16,16],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Space,{className:"caption",children:[(0,d.jsx)(c,{name:"information-circle-outline"}),(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"The farm can be closed only all farmers unstaked their tokens!"})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Button,{type:"primary",icon:(0,d.jsx)(c,{name:"trash-outline"}),onClick:async()=>{const{wallet:e}=window.sentre;if(e){o(!0);try{const{txId:r}=await $e.closeFarm(s,e);return t(r),h(oe({farmAddress:s})),I("Close the farm",r)}catch(r){return B(r)}finally{o(!1)}}},block:!0,disabled:!!u,loading:a,children:"Close Farm"})})]})},Ue=e=>{let{label:s="",title:t=""}=e;return(0,d.jsxs)(l.Row,{gutter:[16,16],children:[(0,d.jsx)(l.Col,{flex:"auto",children:(0,d.jsx)(l.Typography.Text,{type:"secondary",children:s})}),(0,d.jsx)(l.Col,{children:(0,d.jsx)(l.Typography.Text,{children:t})})]})},Ge=e=>{let{farmAddress:s}=e;const t=(0,r.useSelector)((e=>{var t;return null===(t=e.farms)||void 0===t?void 0:t[s]})),[n,a]=(0,i.useState)(!1),[o,u]=(0,i.useState)(!1),{budget:h,budgetSymbol:x}=Ie(s),{mint_stake:m,period:y,reward:j}=t||{},g=_(m),w=(0,i.useMemo)((()=>g?p.utils.undecimalize(j,g):0),[g,j]),b=(0,i.useMemo)((()=>{let e=Number(y)/86400,s="days";return e>29&&(e/=30,s=e>1?"months":"month"),e<2&&(e*=24,s=e>1?"hours":"hour"),`${w} ${x} / ${Math.floor(e)} ${s}`}),[w,y,x]);return(0,d.jsxs)(i.Fragment,{children:[(0,d.jsx)(l.Button,{onClick:()=>a(!0),children:"Manage"}),(0,d.jsx)(l.Modal,{visible:n,onCancel:()=>a(!1),closeIcon:(0,d.jsx)(c,{name:"close"}),footer:null,destroyOnClose:!0,centered:!0,children:(0,d.jsxs)(l.Row,{gutter:[16,16],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Space,{style:{lineHeight:1},children:[(0,d.jsx)(c,{name:"leaf"}),(0,d.jsx)(l.Typography.Title,{level:5,style:{margin:0},children:"Farm Management"})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Card,{style:{borderRadius:8},bodyStyle:{padding:16},bordered:!1,children:(0,d.jsxs)(l.Row,{gutter:[8,8],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Row,{gutter:[0,0],children:[(0,d.jsx)(l.Col,{flex:"auto",children:(0,d.jsxs)(l.Space,{size:12,style:{fontWeight:600},children:[(0,d.jsx)(v,{mintAddress:m,size:32}),(0,d.jsx)(S,{mintAddress:m})]})}),(0,d.jsx)(l.Col,{children:(0,d.jsxs)(l.Space,{size:2,children:[(0,d.jsx)(l.Typography.Text,{type:"secondary",style:{fontSize:12},children:(0,f.Xn)(s)}),(0,d.jsx)(l.Tooltip,{visible:o,title:"Copied",children:(0,d.jsx)(Fe(),{text:s,children:(0,d.jsx)(l.Button,{type:"text",size:"small",onClick:async()=>{u(!0),await(0,f.sA)(1500),u(!1)},icon:(0,d.jsx)(c,{name:"copy-outline"})})})}),(0,d.jsx)(l.Button,{type:"text",size:"small",onClick:()=>window.open((0,f.kU)(s),"_blank"),icon:(0,d.jsx)(c,{name:"open-outline"})})]})})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(Ue,{label:"Budget",title:`${h} ${x}`})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(Ue,{label:"Reward",title:b})})]})})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Tabs,{children:[(0,d.jsx)(l.Tabs.TabPane,{tab:"Seed",children:(0,d.jsx)(Oe,{farmAddress:s,onChange:()=>a(!1)})},"seed"),(0,d.jsx)(l.Tabs.TabPane,{tab:"Unseed",children:(0,d.jsx)(De,{farmAddress:s,onChange:()=>a(!1)})},"unseed"),(0,d.jsx)(l.Tabs.TabPane,{tab:"Freeze/Thaw",children:(0,d.jsx)(Qe,{farmAddress:s,onChange:()=>a(!1)})},"freeze-thaw"),(0,d.jsx)(l.Tabs.TabPane,{tab:"Ownership",disabled:!0,children:"TBD"},"ownership"),(0,d.jsx)(l.Tabs.TabPane,{tab:"Close",children:(0,d.jsx)(qe,{farmAddress:s,onChange:()=>a(!1)})},"close")]})})]})})]})},{sol:{senAddress:He,farming:Ye}}=j,Je=e=>{let{farmAddress:s,onClose:t}=e;const a=(0,r.useSelector)((e=>{var t;return null===(t=e.farms)||void 0===t?void 0:t[s]})),{data:o}=$(s),{wallet:{address:u}}=(0,n.useWallet)(),[h,x]=(0,i.useState)(!1),m=p.utils.undecimalize(null===o||void 0===o?void 0:o.shares,9);return(0,d.jsxs)(l.Row,{gutter:[16,16],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Space,{align:"start",children:[(0,d.jsx)(c,{name:"alert-circle-outline"}),(0,d.jsx)(l.Typography.Text,{children:"When the reward budget is too low, you may be not able to unstake. Exiting the farm means you give up on rewards and merely get back your tokens."})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Card,{style:{borderRadius:8,boxShadow:"unset"},bodyStyle:{padding:12},children:(0,d.jsxs)(l.Row,{gutter:[0,0],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Typography.Text,{className:"caption",type:"secondary",children:"Amount"})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(E,{placeholder:"0",value:m,size:"small",bordered:!1})})]})})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Button,{type:"primary",icon:(0,d.jsx)(c,{name:"remove"}),onClick:async()=>{x(!0);const{splt:e,wallet:r}=window.sentre,{mint_stake:n}=a;if(!r||!p.account.isAddress(n))return;const l=await e.deriveAssociatedAddress(u,He),i=await e.deriveAssociatedAddress(u,n);try{const{txId:e}=await Ye.rid(i,l,s,r);return t(!1),I("Exit",e)}catch(o){return B(o)}finally{x(!1)}},block:!0,disabled:!m,loading:h,children:"Exit"})})]})},Ze=e=>{const s=(0,r.useSelector)((s=>s.farms[e])),{data:t}=$(e),[n,a]=(0,i.useState)(0),l=(0,i.useCallback)((()=>{if(!t||!s)return a(0);const e=H(t,s)||0;return a(e)}),[t,s]);return(0,i.useEffect)((()=>{l()}),[l]),n},Ke=e=>{const{farms:{[e]:s}}=(0,r.useSelector)((e=>e)),{getTotalValue:t}=A(),[n,a]=(0,i.useState)(0),l=(0,i.useCallback)((async()=>{if(!s)return a(0);const{total_shares:e,mint_stake:r}=s,n=await t({mintAddress:r,amount:e});return a(n)}),[s,t]);return(0,i.useEffect)((()=>{l()}),[l]),n},Xe=e=>{const s=(0,r.useSelector)((s=>s.farms[e])),t=Ke(e),{getTotalValue:n}=A(),[a,l]=(0,i.useState)(0),o=(0,i.useCallback)((async()=>{if(!t)return l(0);const{mint_reward:e,reward:r,period:a}=s,i=r*BigInt(86400)/a,o=await n({mintAddress:e,amount:i});return l(o/t)}),[s,n,t]);return(0,i.useEffect)((()=>{o()}),[o]),{roi:a,apr:365*a}},{sol:{senAddress:es,farming:ss}}=j,ts="The budget of reward is very low. Please unstake your tokens for safety.",rs=e=>{let{farmAddress:s}=e;const t=(0,r.useSelector)((e=>{var t;return null===(t=e.farms)||void 0===t?void 0:t[s]})),{data:o}=$(s),u=Ze(s),h=(e=>{const[s,t]=(0,i.useState)(),{farms:{[e]:a}}=(0,r.useSelector)((e=>e)),{pools:l}=(0,n.usePool)(),o=(0,i.useCallback)((async()=>{const e=null===a||void 0===a?void 0:a.mint_stake;if(!e)return t(void 0);const s=Object.keys(l).find((s=>{const{mint_lpt:t}=l[s];return t===e}));if(!p.account.isAddress(s))return t(void 0);const r=l[s];return t({address:s,data:r})}),[null===a||void 0===a?void 0:a.mint_stake,l]);return(0,i.useEffect)((()=>{o()}),[o]),s})(s),x=Ke(s),{apr:m}=Xe(s),{ui:{width:y}}=(0,n.useUI)(),{wallet:{address:j}}=(0,n.useWallet)(),g=(0,a.useHistory)(),[w,b]=(0,i.useState)(),[C,A]=(0,i.useState)(!1),[k,T]=(0,i.useState)(!1),[R,z]=(0,i.useState)(!1),[P,F]=(0,i.useState)(""),{owner:E,state:N,reward:O}=t||{},M=E===j,D=(0,r.useSelector)((e=>e.main.search)),L=N===We.isFreeze,W=_(null===t||void 0===t?void 0:t.mint_stake),Q=_(null===t||void 0===t?void 0:t.mint_stake),{budget:q}=Ie(s),U=(0,i.useMemo)((()=>0!==Q&&Q?Number(p.utils.undecimalize(O,Q)):0),[Q,O]),G=()=>b(w?void 0:s);(0,i.useEffect)((()=>{D&&D===s&&b(D)}),[q,s,U,D]),(0,i.useEffect)((()=>F(U?q<3*U?ts:"":ts)),[q,U]);const H=()=>(0,d.jsxs)(l.Row,{gutter:[8,8],children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Space,{size:4,children:[(0,d.jsx)(l.Typography.Title,{style:{color:"#fff"},level:5,children:"APR"}),(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"(Annual Percentage Rate)"})]})}),(0,d.jsx)(l.Col,{children:(0,d.jsx)(l.Typography.Text,{style:{color:"#E9E9EB"},children:"Refers to the simple interest accured from a particular inverstment over a 1 year period."})})]});let Y="0";o&&W&&(Y=p.utils.undecimalize(o.shares,W));const J=y>768?w?"chevron-down-outline":"chevron-forward-outline":w?"chevron-up-outline":"chevron-down-outline",Z=L?{opacity:.6}:{};return(0,d.jsxs)(l.Row,{style:{...Z},children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Card,{bordered:!1,className:"farming-card",bodyStyle:{padding:16},style:{boxShadow:"unset",borderRadius:8,position:"relative",zIndex:1},hoverable:!0,onClick:G,children:(0,d.jsxs)(l.Row,{gutter:[16,16],justify:"center",align:"middle",children:[(0,d.jsx)(l.Col,{flex:"auto",children:(0,d.jsxs)(l.Row,{gutter:[16,16],align:"middle",children:[(0,d.jsx)(l.Col,{xs:24,md:5,children:(0,d.jsxs)(l.Space,{children:[(0,d.jsx)(v,{mintAddress:null===t||void 0===t?void 0:t.mint_stake,size:24}),(0,d.jsx)(S,{mintAddress:null===t||void 0===t?void 0:t.mint_stake}),(0,d.jsx)(l.Button,{type:"text",shape:"circle",size:"small",icon:(0,d.jsx)(l.Typography.Text,{type:"secondary",children:(0,d.jsx)(c,{name:"information-circle-outline"})}),onClick:e=>{e.stopPropagation(),T(!0)}})]})}),(0,d.jsx)(l.Col,{xs:12,md:4,children:(0,d.jsx)(V,{label:"APR",tooltip:(0,d.jsx)(H,{}),value:(0,f.uR)(m).format("0,0.[00]a%")})}),(0,d.jsx)(l.Col,{xs:12,md:5,children:(0,d.jsx)(V,{label:"Liquidity",value:(0,f.uR)(x).format("0,0.00[00]a$")})}),(0,d.jsx)(l.Col,{xs:12,md:5,children:(0,d.jsx)(V,{label:"Your staked LPT",value:(0,f.uR)(Y).format("0,0.00[00]")})}),(0,d.jsx)(l.Col,{xs:12,md:5,children:(0,d.jsx)(V,{mintAddress:null===t||void 0===t?void 0:t.mint_reward,label:"Reward",value:(0,f.uR)(u).format("0,0.00[00]")})})]})}),(0,d.jsx)(l.Col,{children:(0,d.jsxs)(l.Space,{children:[L&&(0,d.jsx)(c,{name:"snow-outline"}),P&&(0,d.jsx)(l.Tooltip,{title:ts,children:(0,d.jsx)(c,{name:"warning-outline",style:{color:"#f9575e"}})}),(0,d.jsx)(l.Button,{type:"text",icon:(0,d.jsx)(c,{name:J}),disabled:!M&&L,onClick:G})]})})]})})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Collapse,{activeKey:w,className:"expand-farm-card",children:(0,d.jsx)(l.Collapse.Panel,{header:null,showArrow:!1,children:(0,d.jsxs)(l.Row,{gutter:[16,16],children:[(0,d.jsx)(l.Col,{xs:{order:2},md:{order:1},flex:"auto",children:h&&(0,d.jsxs)(l.Button,{type:"text",style:{padding:0,background:"transparent"},onClick:()=>{g.push(`/app/sen_lp/details?poolAddress=${h.address}`)},children:["To the pool",(0,d.jsx)(c,{name:"chevron-forward-outline"})]})}),(0,d.jsx)(l.Col,{xs:{order:1},md:{order:2},children:(0,d.jsxs)(l.Space,{children:[M&&(0,d.jsx)(Ge,{farmAddress:s}),(0,d.jsx)(l.Button,{onClick:()=>A(!0),children:"Stake / Unstake"}),(0,d.jsx)(l.Button,{type:"primary",loading:R,onClick:async()=>{z(!0);const{splt:e,wallet:t}=window.sentre,r=await e.deriveAssociatedAddress(j,es);try{if(!t)throw new Error("please connect wallet first!");const e=new ve;await e.validate(s);const{txId:n}=await ss.harvest(s,r,t);return I("Harvest",n)}catch(n){return B(n)}finally{z(!1)}},disabled:L||0===u,children:"Harvest"})]})})]})},s)})}),(0,d.jsx)(l.Modal,{onCancel:()=>A(!1),closeIcon:(0,d.jsx)(c,{name:"close"}),footer:null,title:null,visible:C,children:(0,d.jsxs)(l.Tabs,{defaultActiveKey:L?"exit":"stake",children:[(0,d.jsx)(l.Tabs.TabPane,{tab:"Stake",disabled:L,children:(0,d.jsx)(Re,{farmAddress:s,onClose:A})},"stake"),(0,d.jsx)(l.Tabs.TabPane,{tab:"Unstake",disabled:L,children:(0,d.jsx)(Ae,{farmAddress:s,onClose:A})},"unstake"),(0,d.jsx)(l.Tabs.TabPane,{tab:"Exit",children:(0,d.jsx)(Je,{farmAddress:s,onClose:A})},"exit")]})}),(0,d.jsx)(l.Modal,{visible:k,onCancel:()=>T(!1),closeIcon:(0,d.jsx)(c,{name:"close"}),title:"Farm Info",footer:null,destroyOnClose:!0,centered:!0,children:(0,d.jsx)(Be,{farmAddress:s})})]})},ns=e=>{const{tokenProvider:s}=(0,n.useMint)(),{sentreFarms:t}=T(),{pools:a}=(0,n.usePool)(),{search:l}=(0,r.useSelector)((e=>e.main)),[o,d]=(0,i.useState)({}),c=(0,i.useCallback)((e=>Object.keys(a).find((s=>a[s].mint_lpt===e))),[a]),u=(0,i.useCallback)((async()=>{const r={},n=(await s.find(l)).map((e=>e.address));Object.keys(e).filter((s=>{if(!l||!a||!e||l.length<3)return!0;const t=e[s],{mint_stake:r}=t,i=c(r);if(i){if(i===l)return!0;const{mint_a:e,mint_b:s}=a[i];if(n.includes(e)||n.includes(s))return!0}return s===l||(n.includes(r)||r===l)})).sort(((s,r)=>!t[s]&&t[r]?1:t[s]&&!t[r]?-1:e[s].total_shares<e[r].total_shares?1:-1)).map((s=>r[s]=e[s])),await d(r)}),[e,c,l,a,t,s]);return(0,i.useEffect)((()=>{u().then((()=>{setTimeout((()=>{(0,P.be)()}),500)}))}),[u]),o},as=()=>{const{farms:e}=(0,r.useSelector)((e=>e)),s=ns(e),t=(0,i.useMemo)((()=>Object.keys(s)),[s]);return t.length?(0,d.jsx)(l.Row,{gutter:[16,16],children:t.map((e=>(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(P.ZP,{height:84,children:(0,d.jsx)(rs,{farmAddress:e})})},e)))}):(0,d.jsx)(l.Empty,{})},{sol:{senOwners:ls}}=j,is=()=>{const{sentreFarms:e}=T(),s=ns(e),t=(0,i.useMemo)((()=>Object.keys(s)),[s]),r=(0,i.useMemo)((()=>t.filter((e=>ls.includes(s[e].owner)))),[s,t]),n=(0,i.useMemo)((()=>r.sort(((e,t)=>s[e].total_shares<s[t].total_shares?1:-1))),[s,r]);return 0===n.length?(0,d.jsx)(l.Empty,{}):(0,d.jsx)(l.Row,{gutter:[16,16],children:n.map(((e,s)=>(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(P.ZP,{height:84,children:(0,d.jsx)(rs,{farmAddress:e})})},e+s)))})},{sol:{farming:os}}=j,ds=()=>{const[e,s]=(0,i.useState)({}),{farms:t,debts:a}=(0,r.useSelector)((e=>e)),{wallet:{address:l}}=(0,n.useWallet)(),o=(0,i.useCallback)((async e=>{const s=await os.deriveDebtAddress(l,e),t=a[s];return(null===t||void 0===t?void 0:t.shares)>BigInt(0)}),[a,l]),d=(0,i.useCallback)((async e=>{const t={};for(const s in e){await o(s)&&(t[s]=e[s])}s(t)}),[o]);return(0,i.useEffect)((()=>{d(t)}),[t,d]),{stakedFarms:e,filterStakedFarms:d,checkStakedFarm:o}},cs=()=>{const{stakedFarms:e}=ds(),s=ns(e);return 0===Object.keys(s).length?(0,d.jsx)(l.Empty,{}):(0,d.jsx)(l.Row,{gutter:[16,16],children:Object.keys(s).map((e=>(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(P.ZP,{height:84,children:(0,d.jsx)(rs,{farmAddress:e})})},e)))})},us=()=>{const[e,s]=(0,i.useState)({}),t=(0,r.useSelector)((e=>e.farms)),{wallet:{address:a}}=(0,n.useWallet)(),l=(0,i.useCallback)((e=>t[e].owner===a),[t,a]),o=(0,i.useCallback)((e=>{const t={};for(const s in e)l(s)&&(t[s]=e[s]);s(t)}),[l]);return(0,i.useEffect)((()=>{o(t)}),[t,o]),{yourFarms:e,filterYourFarms:o,checkYourFarm:l}},hs=()=>{const{yourFarms:e}=us(),s=ns(e);return Object.keys(s).length?(0,d.jsx)(l.Row,{gutter:[16,16],children:Object.keys(s).map((e=>(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(P.ZP,{height:84,children:(0,d.jsx)(rs,{farmAddress:e})})},e)))}):(0,d.jsx)(l.Empty,{})};var xs;!function(e){e.YourFarms="YourFarms",e.SenFarm="SenFarm",e.StakedFarm="StakedFarm",e.AllFarms="AllFarms"}(xs||(xs={}));const ps=()=>{const e=(0,a.useLocation)().search,s=(0,r.useSelector)((e=>e.main.search)),{checkStakedFarm:t}=ds(),{checkYourFarm:n}=us(),{checkSentreFarm:o}=T(),c=(0,r.useDispatch)(),[u,h]=(0,i.useState)(xs.SenFarm),[x,m]=(0,i.useState)(!1);(0,i.useEffect)((()=>{(async()=>{if(p.account.isAddress(s)&&!x)try{if(n(s))return h(xs.YourFarms);if(o(s))return h(xs.SenFarm);const e=await t(s);h(e?xs.StakedFarm:xs.AllFarms)}catch(e){}finally{m(!0)}})()}),[o,t,n,s,x]),(0,i.useEffect)((()=>{const s=new URLSearchParams(e).get("search");if(s)return c(fe({search:s})),h(xs.AllFarms),()=>{c(fe({search:""}))}}),[c,e]);return(0,d.jsxs)(l.Tabs,{activeKey:u,onChange:e=>{h(e),setTimeout((()=>{(0,P.be)()}),500)},tabBarExtraContent:(0,d.jsx)(W,{}),children:[(0,d.jsx)(l.Tabs.TabPane,{tab:"Sentre Farms",children:(0,d.jsx)(is,{})},xs.SenFarm),(0,d.jsx)(l.Tabs.TabPane,{tab:"Staked Farms",children:(0,d.jsx)(cs,{})},xs.StakedFarm),(0,d.jsx)(l.Tabs.TabPane,{tab:"Your Farms",children:(0,d.jsx)(hs,{})},xs.YourFarms),(0,d.jsx)(l.Tabs.TabPane,{tab:"All Farms",children:(0,d.jsx)(as,{})},xs.AllFarms)]})},{sol:{farming:ms}}=j;let ys=0,js=BigInt(0);const fs=e=>{let{children:s}=e;const t=(0,r.useDispatch)(),{wallet:{address:a,lamports:l}}=(0,n.useWallet)(),o=(0,i.useCallback)((async()=>{try{if(!p.account.isAddress(a))return;await t(he({owner:a})).unwrap()}catch(e){await B(e)}}),[t,a]),d=(0,i.useCallback)((async()=>{if(!p.account.isAddress(a))return console.warn("Wallet is not connected");if(ys)return console.warn("Already watched");const e=[{dataSize:89},{memcmp:{bytes:a,offset:32}}];ys=ms.watch(((e,s)=>{if(e)return console.error(e);const{type:r,address:n,data:a}=s;return"debt"===r?t(pe({address:n,data:a})):void 0}),e)}),[t,a]);return(0,i.useEffect)((()=>{js&&l>js&&t(he({owner:a})),js=l}),[t,a,l]),(0,i.useEffect)((()=>(o(),d(),()=>{(async()=>{try{await ms.unwatch(ys)}catch(e){}})(),ys=0})),[o,d]),s},{sol:{farming:gs,senAddress:ws}}=j;let bs=0;const vs=e=>{let{children:s,style:t={}}=e;const n=(0,r.useDispatch)(),[a,o]=(0,i.useState)(!1),c=(0,i.useCallback)((async()=>{try{o(!0),await n(ae())}catch(e){await B(e)}finally{o(!1)}}),[n]),u=(0,i.useCallback)((async()=>{if(bs)return console.warn("Already watched");const e=[{dataSize:209},{memcmp:{bytes:ws,offset:97}}];bs=gs.watch(((e,s)=>{if(e)return console.error(e);const{type:t,address:r,data:a}=s;return"farm"===t?n(ie({address:r,data:a})):void 0}),e)}),[n]);return(0,i.useEffect)((()=>(c(),u(),()=>{(async()=>{try{gs.unwatch(bs)}catch(e){}})(),bs=0})),[c,u]),(0,d.jsx)(l.Spin,{spinning:a,style:t,children:s})},Cs=e=>{let{children:s,style:t}=e;return(0,d.jsx)(vs,{style:t,children:(0,d.jsx)(fs,{children:s})})},{route:{farmRoute:Ss}}=j,As=()=>{const{search:e,pathname:s}=(0,a.useLocation)(),{search:t}=(0,r.useSelector)((e=>e.main)),n=(0,r.useDispatch)(),i=(0,a.useHistory)();return(0,d.jsx)(Cs,{children:(0,d.jsxs)(l.Row,{gutter:[24,24],style:{paddingBottom:12},justify:"center",children:[(0,d.jsx)(l.Col,{xs:24,lg:18,children:(0,d.jsx)(z,{})}),(0,d.jsx)(l.Col,{xs:24,lg:18,children:(0,d.jsxs)(l.Row,{gutter:[8,8],children:[(0,d.jsx)(l.Col,{xs:24,lg:8,children:(0,d.jsx)(l.Card,{bodyStyle:{padding:0},style:{borderRadius:8,background:"transparent",boxShadow:"unset"},children:(0,d.jsx)(l.Input,{placeholder:"Search by name, address",value:t,onChange:t=>(new URLSearchParams(e).get("search")&&i.push(s),n(fe({search:t.target.value}))),prefix:t?(0,d.jsx)(l.Button,{type:"text",style:{width:"auto",height:"auto",background:"transparent"},onClick:()=>(n(fe({search:""})),i.push(Ss)),icon:(0,d.jsx)(c,{name:"close-outline"})}):(0,d.jsx)(c,{name:"search-outline"}),bordered:!1,size:"large"})})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(ps,{})})]})})]})})},ks=e=>{let{isHidden:s}=e;const{search:t}=(0,r.useSelector)((e=>e.main)),n=(0,r.useDispatch)();return(0,d.jsx)(l.Card,{className:s?"hidden-class":"",bodyStyle:{padding:8},bordered:!1,children:(0,d.jsx)(l.Input,{value:t,onChange:e=>n(fe({search:e.target.value})),placeholder:"Search",size:"small",bordered:!1,prefix:(0,d.jsx)(l.Button,{type:"text",style:{marginLeft:-7},size:"small",icon:(0,d.jsx)(c,{name:"search-outline"})})})})},{manifest:{appId:Ts}}=j,Rs=e=>{let{farmAddress:s}=e;const t=Ze(s),n=(0,r.useSelector)((e=>e.farms[s])),o=(0,a.useHistory)(),{data:u}=$(s),{apr:h}=Xe(s),x=(0,r.useDispatch)(),m=_(n.mint_stake),y=(0,i.useCallback)((()=>{o.push(`/app/${Ts}`),x(fe({search:s}))}),[x,s,o]);let j="0";return u&&m&&(j=p.utils.undecimalize(u.shares,m)),(0,d.jsx)(l.Card,{bordered:!1,className:"farm-card-widget",children:(0,d.jsxs)(l.Row,{children:[(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Row,{align:"middle",gutter:[12,12],children:[(0,d.jsx)(l.Col,{flex:"auto",children:(0,d.jsxs)(l.Space,{children:[(0,d.jsx)(v,{mintAddress:n.mint_stake}),(0,d.jsx)(S,{mintAddress:n.mint_stake})]})}),(0,d.jsx)(l.Col,{children:(0,d.jsx)(l.Button,{onClick:y,type:"text",icon:(0,d.jsx)(c,{name:"open-outline"})})})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(l.Divider,{style:{margin:"12px 0"}})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Row,{gutter:[6,6],children:[(0,d.jsx)(l.Col,{flex:"auto",children:(0,d.jsxs)(l.Space,{children:[(0,d.jsx)(v,{mintAddress:n.mint_reward}),(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"Reward"})]})}),(0,d.jsx)(l.Col,{children:(0,d.jsxs)(l.Space,{children:[(0,d.jsx)(l.Typography.Text,{children:(0,f.uR)(t).format("0,0.00[00]")}),(0,d.jsx)(S,{mintAddress:n.mint_reward})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Row,{children:[(0,d.jsx)(l.Col,{flex:"auto",children:(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"APR"})}),(0,d.jsx)(l.Col,{children:(0,d.jsx)(l.Space,{children:(0,d.jsx)(l.Typography.Text,{children:(0,f.uR)(h).format("0,0.[00]%")})})})]})}),(0,d.jsx)(l.Col,{span:24,children:(0,d.jsxs)(l.Row,{children:[(0,d.jsx)(l.Col,{flex:"auto",children:(0,d.jsx)(l.Typography.Text,{type:"secondary",children:"Your staked LPT"})}),(0,d.jsx)(l.Col,{children:(0,d.jsx)(l.Space,{children:(0,d.jsx)(l.Typography.Text,{children:(0,f.uR)(j).format("0,0.00[00]")})})})]})})]})})]})})},zs=()=>{const{stakedFarms:e}=ds(),s=ns(e);return 0===Object.keys(s).length?(0,d.jsx)(l.Empty,{}):(0,d.jsxs)(l.Row,{gutter:[12,12],children:[Object.keys(s).map((e=>(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(P.ZP,{height:185,overflow:!0,children:(0,d.jsx)(Rs,{farmAddress:e})})},e))),(0,d.jsx)(l.Col,{})]})},Ps=()=>{const{yourFarms:e}=us(),s=ns(e);return Object.keys(s).length?(0,d.jsxs)(l.Row,{gutter:[16,16],children:[Object.keys(s).map((e=>(0,d.jsx)(l.Col,{span:24,children:(0,d.jsx)(P.ZP,{height:84,children:(0,d.jsx)(Rs,{farmAddress:e})})},e))),(0,d.jsx)(l.Col,{})]}):(0,d.jsx)(l.Empty,{})},Fs=()=>{const[e,s]=(0,i.useState)(!1),t=(0,r.useDispatch)(),{search:n}=(0,r.useSelector)((e=>e.main));return(0,i.useEffect)((()=>{n&&s(!0)}),[n]),(0,d.jsxs)(i.Fragment,{children:[(0,d.jsx)(l.Button,{className:"button-search",type:"text",icon:(0,d.jsx)(c,{name:e?"close-outline":"search-outline"}),onClick:()=>{e&&t(fe({search:""})),s(!e)}}),(0,d.jsx)(ks,{isHidden:!n&&!e}),(0,d.jsx)(Cs,{style:{height:336},children:(0,d.jsxs)(l.Tabs,{className:e?"hidden-tab":"",onChange:()=>setTimeout((()=>{(0,P.be)()}),300),children:[(0,d.jsx)(l.Tabs.TabPane,{tab:"Staked farms",children:(0,d.jsx)(zs,{})},"staked-farm"),(0,d.jsx)(l.Tabs.TabPane,{tab:"Your farms",children:(0,d.jsx)(Ps,{})},"your-farm")]})})]})},{manifest:{appId:Es}}=j,Is=()=>(0,d.jsx)(n.UIProvider,{appId:Es,antd:!0,children:(0,d.jsx)(n.PoolProvider,{children:(0,d.jsx)(n.MintProvider,{children:(0,d.jsx)(n.AccountProvider,{children:(0,d.jsx)(n.WalletProvider,{children:(0,d.jsx)(r.Provider,{store:we,children:(0,d.jsx)(As,{})})})})})})}),Bs={size:"small",type:"solid"},_s=()=>(0,d.jsx)(n.UIProvider,{appId:Es,antd:!0,children:(0,d.jsx)(n.PoolProvider,{children:(0,d.jsx)(n.MintProvider,{children:(0,d.jsx)(n.AccountProvider,{children:(0,d.jsx)(n.WalletProvider,{children:(0,d.jsx)(r.Provider,{store:we,children:(0,d.jsx)(Fs,{})})})})})})})},57452:(e,s,t)=>{"use strict";t.d(s,{R:()=>i});const r={ttl:3e4},n={limit:{calls:10,time:1e3},cache:r};class a{constructor(e){this.key="",this.resolveQueue=[],this.rejectQueue=[],this.key=e}add(e,s){this.resolveQueue.push(e),this.rejectQueue.push(s)}resolves(e){for(;this.resolveQueue.length>0;){this.resolveQueue.shift()(e)}}rejects(e){for(;this.rejectQueue.length>0;){this.rejectQueue.shift()(e)}}}class l{static set(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r;this.mapCache.set(e,s),setTimeout((()=>{this.mapCache.delete(e)}),t.ttl)}static get(e){return this.mapCache.get(e)}}l.mapCache=new Map;class i{static getSingleFlight(e){const s=JSON.stringify(e);if(this.mapInstance.has(s)){const e=this.mapInstance.get(s);if(e)return e}let t=new o(e);return this.mapInstance.set(s,t),t}static async load(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"object"===typeof e&&(e=JSON.stringify(e));let r=i.getSingleFlight(t);i.mapInstance.set(e,r);const n=new a(e);return r.load(n,s)}}i.mapInstance=new Map;class o{constructor(e){this.config=void 0,this.intervalRequest=void 0,this.timeLogs=[],this.mapRequestCalling=new Map,this.requestQueue=[],this.config=Object.assign(n,e)}async load(e,s){const t=l.get(e.key);if(t)return Promise.resolve(t);let r=!1,n=this.mapRequestCalling.get(e.key);return n||(n=e,r=!0,this.mapRequestCalling.set(n.key,n)),new Promise(((e,t)=>{if(!n)return t("Not found request!");n.add(e,t),r&&this.fetch(n,s)}))}fetch(e,s){if(!this.validateLimit())return this.addRequestQueue(e,s);this.createTimeLogs(),s().then((s=>{l.set(e.key,s,this.config.cache),e.resolves(s)})).catch((s=>{e.rejects(s)})).finally((()=>{this.mapRequestCalling.delete(e.key),this.fetchRequestQueue(s)}))}fetchRequestQueue(e){if(!this.validateLimit())return;const s=this.requestQueue.shift();s&&this.load(s,e),0===this.requestQueue.length&&this.intervalRequest&&clearInterval(this.intervalRequest)}addRequestQueue(e,s){var t;this.requestQueue.push(e),this.intervalRequest=setInterval((()=>{this.fetchRequestQueue(s)}),null===(t=this.config.limit)||void 0===t?void 0:t.time)}validateLimit(){return!0}createTimeLogs(){var e;if(!this.config.limit)return;const s=(new Date).getTime();this.timeLogs.push(s),this.timeLogs.length>(null===(e=this.config.limit)||void 0===e?void 0:e.calls)&&this.timeLogs.shift()}}},85912:(e,s,t)=>{"use strict";t.d(s,{$:()=>r,h:()=>n});const r=e=>!1;BigInt.prototype.toJSON=function(){return this.toString()};const n={serializableCheck:{isSerializable:e=>"undefined"===typeof e||null===e||"string"===typeof e||"boolean"===typeof e||"number"===typeof e||Array.isArray(e)||(e=>{if(null===e)return!1;const s=Object.getPrototypeOf(e);return null!==s&&null===Object.getPrototypeOf(s)})(e)||"bigint"===typeof e}}},63805:(e,s,t)=>{"use strict";t.d(s,{OB:()=>n,ef:()=>a});var r=t(53933);const n="production",a=(()=>{switch(r.Z.get("network")){case"devnet":return"devnet";case"testnet":return"testnet";default:return"mainnet"}})()},53933:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});const r="sentre",n=window.localStorage,a=e=>{try{return e?JSON.parse(e):null}catch(s){return null}},l={set:(e,s)=>{let t=a(n.getItem(r));t&&"object"===typeof t||(t={}),t[e]=s,n.setItem(r,JSON.stringify(t))},get:e=>{let s=a(n.getItem(r));return s&&"object"===typeof s?s[e]:null},clear:e=>{l.set(e,null)}},i=l},34559:(e,s,t)=>{"use strict";t.d(s,{RB:()=>o,sA:()=>d,Xn:()=>c,kU:()=>u,uR:()=>h,l$:()=>x});var r=t(95418),n=t(16200),a=t.n(n),l=t(63805),i=t(57452);const o=e=>window.open(e,"_blank"),d=e=>new Promise((s=>setTimeout(s,e))),c=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"...";return e.substring(0,s)+t+e.substring(e.length-s,e.length)},u=e=>r.account.isAddress(e)?`https://explorer.solana.com/address/${e}?cluster=${l.ef}`:`https://explorer.solana.com/tx/${e}?cluster=${l.ef}`,h=e=>e?a()(e):a()("0"),x=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return i.R.load("fetchCGK"+e,(()=>r.utils.parseCGK(e)))}},46601:()=>{},89214:()=>{},85568:()=>{},52361:()=>{},94616:()=>{},55024:()=>{}}]);
//# sourceMappingURL=796.6349a1f2.chunk.js.map