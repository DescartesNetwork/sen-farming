(globalThis.webpackChunksen_farming=globalThis.webpackChunksen_farming||[]).push([["src_bootstrap_app_tsx"],{98463:(e,t,s)=>{"use strict";s.r(t),s.d(t,{ReactComponent:()=>p,default:()=>m});var r,n,a,l,i,o,d,c=s(92950);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},u.apply(this,arguments)}function h(e,t){let{title:s,titleId:h,...p}=e;return c.createElement("svg",u({width:257,height:256,viewBox:"0 0 257 256",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":h},p),s?c.createElement("title",{id:h},s):null,r||(r=c.createElement("path",{d:"M0.622803 60C0.622803 26.8629 27.4857 0 60.6228 0H196.623C229.76 0 256.623 26.8629 256.623 60V196C256.623 229.137 229.76 256 196.623 256H60.6228C27.4857 256 0.622803 229.137 0.622803 196V60Z",fill:"url(#paint0_linear_1802_5774)"})),n||(n=c.createElement("path",{d:"M211.234 115.694H216.613C216.977 115.694 221.629 115.549 219.158 109.01C216.541 102.181 208.4 101.745 208.4 101.745L196.042 56.919C196.042 56.919 194.516 49 186.738 49C178.888 49 113.83 49 113.83 49C113.83 49 103.799 49.218 103.799 60.261H113.249L102.055 102.399H91.006V79.877C91.006 79.877 90.9333 72.2486 83.1555 72.2486C75.305 72.2486 72.7609 72.2486 72.7609 72.2486L75.9593 80.4582H81.1929C81.1929 80.4582 81.2656 80.4582 81.3383 80.4582C81.7744 80.4582 83.0828 80.6762 83.0828 83.219C83.0828 86.2704 83.0828 102.617 83.0828 102.617H47.683C47.683 102.617 47.683 102.617 47.6103 102.617C46.6654 102.617 34.8897 102.835 34.8897 114.677C34.8897 127.028 37.1431 148.824 37.1431 148.824C29.0018 154.636 23.6228 164.226 23.6228 175.123C23.6228 192.923 38.088 207.308 55.8969 207.308C73.7059 207.308 88.1711 192.85 88.1711 175.051C88.1711 167.858 85.7723 161.174 81.7744 155.798H93.6228L96.1669 162.555H122.117L124.37 155.507L133.457 155.58C133.457 156.161 133.457 156.67 133.457 157.251C133.457 184.859 155.845 207.308 183.54 207.308C211.162 207.308 233.623 184.931 233.623 157.251C233.477 139.96 224.609 124.703 211.234 115.694ZM55.9696 191.979C46.52 191.979 38.8149 184.278 38.8149 174.833C38.8149 165.388 46.52 157.687 55.9696 157.687C65.4193 157.687 73.1244 165.388 73.1244 174.833C73.1971 184.278 65.492 191.979 55.9696 191.979ZM159.261 63.3124C159.261 62.8765 159.334 60.6243 161.079 58.9533C161.878 58.1541 163.259 57.2096 165.585 57.2096H185.502C186.302 57.2096 190.445 57.5729 191.899 64.1116C192.989 68.8339 198.95 93.8261 199.168 94.9159C199.313 95.4971 199.968 98.4032 198.223 100.728C197.423 101.818 195.824 103.053 192.917 103.053H165.585C163.041 103.053 159.334 101.382 159.334 96.7322V63.3124H159.261ZM118.119 103.344C118.046 103.344 117.974 103.344 117.901 103.344C117.61 103.344 114.775 103.053 113.104 100.801C112.304 99.7836 111.504 98.0399 112.086 95.3518C113.031 90.9927 119.137 62.0773 119.21 61.7867C119.21 61.7141 119.21 61.6414 119.282 61.4961C119.791 59.8978 121.608 57.2096 125.315 57.2096H149.085C151.484 57.2096 155.336 58.9533 155.336 63.5304V97.6767C155.336 97.7493 155.336 97.822 155.336 97.822C155.191 100.002 153.446 103.271 149.158 103.271H118.119V103.344ZM183.54 190.453C165.44 190.453 150.684 175.705 150.684 157.614C150.684 139.524 165.44 124.776 183.54 124.776C201.639 124.776 216.395 139.524 216.395 157.614C216.395 175.705 201.639 190.453 183.54 190.453Z",fill:"#212433"})),a||(a=c.createElement("path",{opacity:.5,d:"M198.223 100.728C197.423 101.818 195.824 103.053 192.917 103.053H165.585C163.041 103.053 159.334 101.382 159.334 96.7323V63.3125C159.334 62.8766 159.407 60.6244 161.151 58.9534C161.951 58.1542 163.332 57.2097 165.658 57.2097H185.575C186.374 57.2097 190.518 57.573 191.972 64.1116C193.062 68.834 199.022 93.8262 199.241 94.916C199.313 95.5699 199.967 98.4759 198.223 100.728Z",fill:"#212433"})),l||(l=c.createElement("path",{opacity:.5,d:"M155.336 63.5303V97.6766C155.336 97.7493 155.336 97.8219 155.336 97.8219C155.191 100.002 153.446 103.271 149.158 103.271H118.119C118.047 103.271 117.974 103.271 117.901 103.271C117.61 103.271 114.776 102.98 113.104 100.728C112.304 99.7109 111.505 97.9673 112.086 95.2791C113.031 90.92 119.137 62.0046 119.21 61.714C119.21 61.6414 119.21 61.5687 119.282 61.4234C119.791 59.8251 121.608 57.137 125.316 57.137H149.085C151.484 57.2096 155.336 58.9533 155.336 63.5303Z",fill:"#212433"})),i||(i=c.createElement("path",{opacity:.5,d:"M183.54 127.464C166.967 127.464 153.446 140.977 153.446 157.542C153.446 174.106 166.967 187.62 183.54 187.62C200.113 187.62 213.633 174.106 213.633 157.542C213.633 140.977 200.113 127.464 183.54 127.464ZM183.54 172.944C175.035 172.944 168.202 166.042 168.202 157.614C168.202 149.114 175.108 142.285 183.54 142.285C192.044 142.285 198.877 149.187 198.877 157.614C198.877 166.042 191.972 172.944 183.54 172.944Z",fill:"#212433"})),o||(o=c.createElement("path",{opacity:.5,d:"M55.9694 160.375C48.0463 160.375 41.5769 166.841 41.5769 174.76C41.5769 182.679 48.0463 189.145 55.9694 189.145C63.8926 189.145 70.362 182.679 70.362 174.76C70.4346 166.841 63.9653 160.375 55.9694 160.375ZM55.9694 181.807C52.1169 181.807 48.9185 178.683 48.9185 174.76C48.9185 170.91 52.0442 167.713 55.9694 167.713C59.822 167.713 63.0203 170.837 63.0203 174.76C63.0203 178.683 59.8947 181.807 55.9694 181.807Z",fill:"#212433"})),d||(d=c.createElement("defs",null,c.createElement("linearGradient",{id:"paint0_linear_1802_5774",x1:.999999,y1:-114739e-11,x2:257,y2:256,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#FFD666"}),c.createElement("stop",{offset:1,stopColor:"#FFE58F"})))))}const p=c.forwardRef(h),m=s.p+"static/media/logo.4510beb32107f8e07e512c69e06f7545.svg"},45597:(e,t,s)=>{"use strict";Object.defineProperty(t,"X$",{value:!0}),Object.defineProperty(t,"jY",{enumerable:!0,get:function(){return l.default}}),t.h0=void 0,Object.defineProperty(t,"ng",{enumerable:!0,get:function(){return i.default}});var r=o(s(70854)),n=o(s(27803)),a=o(s(85468)),l=o(s(98463)),i=o(s(83272));function o(e){return e&&e.__esModule?e:{default:e}}const d=[r.default,n.default,a.default];t.h0=d},18321:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Page:()=>It,__esModule:()=>Bt.X$,logo:()=>Bt.jY,panels:()=>Bt.h0,readme:()=>Bt.ng});var r=s(55754),n=s(44490),a=s(45055),l=s(69716),i=s(94751);const o={appId:"sen_farming",url:"https://descartesnetwork.github.io/sen-farming/index.js"},d={development:{...o},staging:{...o},production:{...o}};var c=s(95418);const u={devnet:{spltAddress:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",splataAddress:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",senAddress:"5YwUkPdXLoujGkZuo9B4LsLKj3hdkDcfP4derpspifSJ",farmingAddress:"CpEsjrLhBkcuApn5uEE2tZCwxyCQKmT6S4YgT9zuLW2J",get farming(){return new c.Farming(this.farmingAddress,this.spltAddress,this.splataAddress,n.rpc)},senOwners:["GJLqpmDxxrV9xruee2vFvEoTho7VVQHRtuHH8nfoAE54"]},testnet:{spltAddress:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",splataAddress:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",senAddress:"5YwUkPdXLoujGkZuo9B4LsLKj3hdkDcfP4derpspifSJ",farmingAddress:"CpEsjrLhBkcuApn5uEE2tZCwxyCQKmT6S4YgT9zuLW2J",get farming(){return new c.Farming(this.farmingAddress,this.spltAddress,this.splataAddress,n.rpc)},senOwners:["GJLqpmDxxrV9xruee2vFvEoTho7VVQHRtuHH8nfoAE54"]},mainnet:{spltAddress:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",splataAddress:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",senAddress:"SENBBKVCM7homnf5RX9zqpf1GFe935hnbU4uVzY1Y6M",farmingAddress:"DTvdh6Q13SfYxMoWyibBUmQAUqd2pDPSpjdku5a9NLSF",get farming(){return new c.Farming(this.farmingAddress,this.spltAddress,this.splataAddress,n.rpc)},senOwners:["Cs6jYywHTAgdvjxn8xG4VkJJH8DXXy7zbtatzMUWoCMG"]}},h={development:{farmRoute:"/app/senhub"},staging:{farmRoute:"/app/sen_farming"},production:{farmRoute:"/app/sen_farming"}},p={manifest:d[n.env],sol:u[n.net],route:h[n.env]};var m=s(92950);const x={address:"",icon:"",name:"TOKEN",price:0,priceChange:0,rank:0,symbol:"TOKEN",totalVolume:0},y=e=>{const[t,s]=(0,m.useState)(x),{tokenProvider:r}=(0,n.useMint)(),a=(0,m.useCallback)((async()=>{try{var t;const a=await r.findByAddress(e),l=null===a||void 0===a||null===(t=a.extensions)||void 0===t?void 0:t.coingeckoId,i=await n.util.fetchCGK(l);return s(i)}catch(a){return s(x)}}),[e,r]);return(0,m.useEffect)((()=>{a()}),[a]),t},f=e=>{const{tokenProvider:t}=(0,n.useMint)(),{pools:s}=(0,n.usePool)(),[r,a]=(0,m.useState)([]),l=(0,m.useCallback)((async()=>{const r=await t.findByAddress(e);if(r)return a([r]);const n=Object.values(s).find((t=>{let{mint_lpt:s}=t;return s===e}));if(!n)return a([void 0]);const{mint_a:l,mint_b:i}=n,o=await t.findByAddress(l),d=await t.findByAddress(i);return a([o,d])}),[e,s,t]);return(0,m.useEffect)((()=>{l()}),[l]),r};var j=s(45263);const g=e=>{let{mintAddress:t,size:s=24,icon:r=(0,j.jsx)(l.Z,{name:"diamond-outline"}),isReserve:n=!1}=e;const a=f(t),o=(0,m.useMemo)((()=>{const e=JSON.parse(JSON.stringify(a));return n?e.reverse():e}),[n,a]);return(0,j.jsx)(i.Avatar.Group,{style:{display:"block",whiteSpace:"nowrap"},children:o.map(((e,t)=>(0,j.jsx)(i.Avatar,{src:null===e||void 0===e?void 0:e.logoURI,size:s,style:{backgroundColor:"#2D3355",border:"none"},children:r},(null===e||void 0===e?void 0:e.address)||t)))})},w=e=>{let{mintAddress:t,separator:s=" \u2022 ",isReverse:r=!1}=e;const a=f(t),l=(0,m.useMemo)((()=>{let e=a.map((e=>{if(!e)return n.util.shortenAddress(t);const{name:s,address:r,symbol:l}=e;return 1===a.length&&s?s:l||n.util.shortenAddress(r)}));return r&&e.reverse(),e.join(s),1===a.length?e:`${e} LPT`}),[r,t,s,a]);return(0,j.jsx)("span",{children:l})},b=e=>{let{mintAddress:t,separator:s=" \u2022 ",isReverse:r=!1}=e;const n=f(t),a=(0,m.useMemo)((()=>{const e=n.map((e=>{const s=`${null===t||void 0===t?void 0:t.substr(0,3)}...`;return e?e.symbol:s}));return r&&e.reverse(),e.join(s)}),[r,t,s,n]);return(0,j.jsx)("span",{children:a})},C=()=>{const{tokenProvider:e,getMint:t}=(0,n.useMint)(),{pools:s}=(0,n.usePool)(),r=(0,m.useCallback)((async(t,s)=>{try{var r;const a=await e.findByAddress(t),l=null===a||void 0===a||null===(r=a.extensions)||void 0===r?void 0:r.coingeckoId;if(!l)throw new Error("Cant not find coingeckoId");const i=await n.util.fetchCGK(l);return Number(c.utils.undecimalize(s,a.decimals))*i.price}catch(a){return 0}}),[e]),a=(0,m.useCallback)((async n=>{let{mintAddress:l,amount:i}=n;if(await e.findByAddress(l))return r(l,i);const o=Object.values(s).find((e=>e.mint_lpt===l));if(!o)return 0;const{reserve_a:d,reserve_b:u,mint_a:h,mint_b:p}=o;if(d*u===BigInt(0))return 0;const{[l]:{supply:m}}=await t({address:l}),{deltaA:x,deltaB:y}=c.Swap.oracle.withdraw(i,m,d,u);return await a({mintAddress:h,amount:x})+await a({mintAddress:p,amount:y})}),[t,r,e,s]);return{getTotalValue:a}},{sol:{senOwners:v}}=p,S=()=>{const e=(0,r.useSelector)((e=>e.farms)),[t,s]=(0,m.useState)({}),n=(0,m.useCallback)((t=>{const s=e[t];return v.includes(s.owner)}),[e]),a=(0,m.useCallback)((e=>{const t={};for(const s in e)n(s)&&(t[s]=e[s]);s(t)}),[n]);return(0,m.useEffect)((()=>{a(e)}),[e,a]),{sentreFarms:t,filterSentreFarms:a,checkSentreFarm:n}},{sol:{senAddress:A}}=p,k=()=>{const{ui:{width:e}}=(0,n.useUI)(),t=(0,r.useSelector)((e=>e.farms)),s=y(A),a=(()=>{const[e,t]=(0,m.useState)(0),{sentreFarms:s}=S(),{getTotalValue:r}=C(),n=(0,m.useCallback)((async()=>{let e=0;await Promise.all(Object.values(s).map((async t=>{const{total_shares:s,mint_stake:n}=t,a=await r({mintAddress:n,amount:s});e+=a}))),t(e)}),[s,r]);return(0,m.useEffect)((()=>{n()}),[n]),e})(),o=e>768,d=o?void 0:24,c=o?32:16,u=o?8:4,h=o?"vertical":"horizontal",p=o?"pause-outline":"reorder-two-outline",x=(0,m.useMemo)((()=>{let e=0;for(const s in t)t[s].total_shares&&e++;return e}),[t]);return(0,j.jsx)(i.Card,{bordered:!1,className:(o?"":"banner-farming-mobile ")+"banner-farming",children:(0,j.jsxs)(i.Row,{gutter:[12,c],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Typography.Title,{level:4,style:{color:"#212433"},children:"Sen Farming"})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Row,{gutter:[12,12],children:[(0,j.jsx)(i.Col,{span:d,children:(0,j.jsxs)(i.Space,{direction:"vertical",size:u,children:[(0,j.jsx)(i.Typography.Text,{style:{color:"#212433"},children:"Total Sentre Farms TVL"}),(0,j.jsx)(i.Typography.Title,{level:2,style:{color:"#F9575E"},children:n.util.numeric(a).format("0,0.[00]$")})]})}),o&&(0,j.jsx)(i.Col,{children:(0,j.jsx)(i.Divider,{type:"vertical",style:{height:"100%"}})}),(0,j.jsx)(i.Col,{span:d,children:(0,j.jsxs)(i.Space,{direction:"vertical",size:u,children:[(0,j.jsx)(i.Typography.Text,{style:{color:"#212433"},children:"Active Farms"}),(0,j.jsx)(i.Typography.Title,{level:2,style:{color:"#F9575E"},children:x})]})}),o&&(0,j.jsx)(i.Col,{children:(0,j.jsx)(i.Divider,{type:"vertical",style:{height:"100%"}})}),(0,j.jsx)(i.Col,{span:d,children:(0,j.jsxs)(i.Space,{direction:h,size:0,align:"center",children:[(0,j.jsxs)(i.Typography.Title,{level:4,style:{color:"#212433"},children:["1 ",(0,j.jsx)(b,{mintAddress:A})]}),(0,j.jsx)(l.Z,{style:{color:"#212433"},name:p}),(0,j.jsx)(i.Typography.Title,{level:4,style:{color:"#F9575E"},children:n.util.numeric(s.price).format("0,0.[0000]$")})]})})]})})]})})};var T=s(58421);let E;const R=(0,m.forwardRef)(((e,t)=>{let{max:s,onValue:r=(()=>{}),onChange:n=(()=>{}),...a}=e;const[o,d]=(0,m.useState)(""),[c,u]=(0,m.useState)(null),h=(0,m.useRef)(t),p=(0,m.useCallback)((e=>{const t=e=>{E&&(clearTimeout(E),E=void 0),d(e),E=setTimeout((()=>d("")),500)};return/^\d*(\.\d*)?$/.test(e)?s&&parseFloat(e)>parseFloat(s.toString())?t("Not enough balance"):r(e):t("Invalid character")}),[s,r]);return null!==c&&setTimeout((()=>{var e;return null===h||void 0===h||null===(e=h.current)||void 0===e?void 0:e.setSelectionRange(c,c)}),50),(0,j.jsx)(i.Tooltip,{title:(0,j.jsxs)(i.Space,{children:[(0,j.jsx)(l.Z,{name:"warning"}),o]}),visible:!!o,children:(0,j.jsx)(i.Input,{...a,onChange:e=>{n(e),u(e.target.selectionStart),p(e.target.value||"")},ref:h})})})),_=(e,t)=>window.notify({type:"success",description:`${e} successfully. Click to view details.`,onClick:()=>window.open(n.util.explorer(t),"_blank")}),z=e=>(console.log("error:",e),window.notify({type:"error",description:e.message})),F=e=>{const[t,s]=(0,m.useState)(void 0),{getDecimals:r}=(0,n.useMint)(),a=(0,m.useCallback)((async()=>{try{const t=await r(e);return s(t)}catch(t){return s(void 0)}}),[e,r]);return(0,m.useEffect)((()=>{a()}),[a]),t},B={Hour:BigInt(3600),Day:BigInt(86400),Month:BigInt(2592e3),Year:BigInt(31536e3)},P=e=>{let{mintAddress:t,onClose:s=(()=>{}),setVisibleInputTokenModal:r=(()=>{})}=e;const{sol:{senAddress:a,farming:o}}=p,[d,u]=(0,m.useState)(""),[h,x]=(0,m.useState)(""),[y,f]=(0,m.useState)("Hour"),[w,C]=(0,m.useState)(!1),v=F(a),{wallet:{address:S}}=(0,n.useWallet)(),A=!d||!h||!c.account.isAddress(t);return(0,j.jsxs)(i.Row,{gutter:[16,16],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Typography.Title,{level:4,children:"New farm"})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Card,{style:{borderRadius:8},bodyStyle:{padding:16},bordered:!1,children:(0,j.jsxs)(i.Row,{gutter:[16,16],children:[(0,j.jsx)(i.Col,{span:12,children:(0,j.jsxs)(i.Space,{direction:"vertical",children:[(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"Input"}),(0,j.jsxs)(i.Space,{size:12,style:{cursor:"pointer"},onClick:()=>r(!0),children:[(0,j.jsx)(g,{mintAddress:t}),c.account.isAddress(t)?(0,j.jsx)(b,{mintAddress:t}):(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"Select token type"}),(0,j.jsx)(l.Z,{name:"chevron-forward-outline",style:{color:"#7A7B85"}})]})]})}),(0,j.jsx)(i.Col,{span:12,children:(0,j.jsxs)(i.Space,{direction:"vertical",children:[(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"Output"}),(0,j.jsxs)(i.Space,{size:12,style:{cursor:"pointer"},children:[(0,j.jsx)(g,{mintAddress:a}),(0,j.jsx)(b,{mintAddress:a})]})]})})]})})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Row,{gutter:[0,0],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Typography.Text,{type:"secondary",className:"caption",children:"Reward"})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(R,{size:"large",placeholder:"0",value:d,onValue:u,prefix:(0,j.jsx)(i.Typography.Text,{children:"SNTR"})})})]})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Row,{gutter:[0,0],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Typography.Text,{type:"secondary",className:"caption",children:["Number of ",y]})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(R,{size:"large",placeholder:"0",value:h,onValue:x,suffix:(0,j.jsx)(i.Button,{type:"text",size:"small",icon:(0,j.jsx)(l.Z,{name:"time-outline"}),onClick:()=>{const e=Object.keys(B),t=(e.findIndex((e=>e===y))+1)%e.length;return f(e[t])},children:y})})})]})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Button,{type:"primary",onClick:async()=>{if(!c.account.isAddress(t))return z({message:`Invalid mint address: ${t}`});C(!0);const{wallet:e}=window.sentre;if(!e||!y||!h||!v)return;const r=c.utils.decimalize(d,v),n=Number(null===B||void 0===B?void 0:B[y])*Number(h);try{const{txId:l}=await o.initializeFarm(r,BigInt(n),S,t,a,e);return s(),_("Create a new farm",l)}catch(l){return z({message:l.message})}finally{return C(!1)}},disabled:A,block:!0,loading:w,children:"Confirm"})})]})},I=e=>{let{accountAddress:t,onClick:s=(()=>{})}=e;const{accounts:{[t]:{mint:r}}}=(0,n.useAccount)(),a=(0,m.useMemo)((()=>t.substring(0,4)+" ... "+t.substring(t.length-4,t.length)),[t]);return(0,j.jsx)(i.Card,{onClick:()=>s(r),className:"account-card",bodyStyle:{padding:12,cursor:"pointer"},bordered:!1,children:(0,j.jsxs)(i.Row,{gutter:[8,8],wrap:!1,align:"middle",children:[(0,j.jsx)(i.Col,{flex:"auto",children:(0,j.jsxs)(i.Space,{direction:"vertical",size:0,children:[(0,j.jsxs)(i.Space,{children:[(0,j.jsx)(g,{mintAddress:r}),(0,j.jsx)(w,{mintAddress:r})]}),(0,j.jsxs)(i.Space,{children:[(0,j.jsxs)(i.Space,{size:4,children:[(0,j.jsx)(i.Typography.Text,{type:"secondary",style:{fontSize:12},children:"Account Address:"}),(0,j.jsx)(i.Typography.Text,{children:a})]}),(0,j.jsx)(i.Button,{type:"text",size:"small",onClick:e=>{e.stopPropagation(),window.open(n.util.explorer(t))},icon:(0,j.jsx)(l.Z,{name:"open-outline"})})]})]})}),(0,j.jsx)(i.Col,{children:(0,j.jsx)(i.Button,{type:"text",icon:(0,j.jsx)(l.Z,{name:"arrow-forward-outline"})})})]})})},M=e=>{let{onChange:t}=e;const[s,r]=(0,m.useState)("");return(0,m.useEffect)((()=>t(s)),[s,t]),(0,j.jsx)(i.Card,{className:"account-card",bodyStyle:{padding:6},bordered:!1,children:(0,j.jsx)(i.Input,{placeholder:"Search",value:s,size:"small",bordered:!1,prefix:(0,j.jsx)(i.Button,{type:"text",style:{marginLeft:-7},size:"small",onClick:s?()=>r(""):()=>{},icon:(0,j.jsx)(l.Z,{name:s?"close-outline":"search-outline"})}),onChange:e=>r(e.target.value)})})},Z=e=>{let{onChange:t,onHideInputTokenModal:s=(()=>{})}=e;const{searchedAccount:r,accountAddresses:a,onSearch:l}=(()=>{const[e,t]=(0,m.useState)(),{accounts:s}=(0,n.useAccount)(),{tokenProvider:r}=(0,n.useMint)(),a=(0,m.useMemo)((()=>Object.keys(s)),[s]),l=(0,m.useCallback)((async e=>{if(!e||e.length<3)return t(void 0);const n=(await r.find(e)).map((e=>{let{address:t}=e;return t}));let l=[];return a.forEach((e=>{var t;if(n.includes(null===(t=s[e])||void 0===t?void 0:t.mint))return l.push(e)})),t(l)}),[a,s,r]);return{searchedAccount:e,accountAddresses:a,onSearch:l}})(),o=e=>(s(!1),t(e));return(0,j.jsxs)(i.Row,{gutter:[16,16],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Typography.Title,{level:4,children:"Select token type"})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(M,{onChange:l})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Row,{gutter:[16,16],style:{height:300,overflow:"auto"},children:(r||a).map(((e,t)=>(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(T.ZP,{height:72,overflow:!0,children:(0,j.jsx)(I,{accountAddress:e,onClick:o})})},e+t)))})})]})},O=e=>{let{size:t="small"}=e;const[s,r]=(0,m.useState)(!1),[n,a]=(0,m.useState)(""),[o,d]=(0,m.useState)(!1);return(0,j.jsxs)(i.Row,{children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Button,{style:{background:"transparent"},onClick:()=>r(!0),size:t,children:"New Farm"})}),(0,j.jsx)(i.Modal,{visible:s,onCancel:()=>r(!1),footer:!1,closeIcon:(0,j.jsx)(l.Z,{name:"close-outline"}),children:(0,j.jsx)(P,{mintAddress:n,onClose:()=>{r(!1),a("")},setVisibleInputTokenModal:d})}),(0,j.jsx)(i.Modal,{visible:o,onCancel:()=>d(!1),footer:!1,closeIcon:(0,j.jsx)(l.Z,{name:"close-outline"}),children:(0,j.jsx)(Z,{onChange:e=>{a(e)},onHideInputTokenModal:d})})]})},N=e=>{let{label:t="",tooltip:s,value:r="",mintAddress:n}=e;return(0,j.jsxs)(i.Space,{direction:"vertical",size:4,children:[(0,j.jsxs)(i.Space,{size:4,children:[(0,j.jsxs)(i.Space,{size:4,children:[n&&(0,j.jsx)(g,{mintAddress:n}),(0,j.jsx)(i.Typography.Text,{type:"secondary",children:t})]}),s&&(0,j.jsx)(i.Tooltip,{title:s,children:(0,j.jsx)(i.Button,{type:"text",shape:"circle",size:"small",icon:(0,j.jsx)(i.Typography.Text,{type:"secondary",children:(0,j.jsx)(l.Z,{name:"information-circle-outline"})})})})]}),(0,j.jsxs)(i.Space,{children:[(0,j.jsx)(i.Typography.Title,{level:5,children:r}),n&&(0,j.jsx)(b,{mintAddress:n})]})]})},{sol:{farming:D}}=p,L=e=>{const[t,s]=(0,m.useState)(""),{debts:{[t]:a}}=(0,r.useSelector)((e=>e)),{wallet:{address:l}}=(0,n.useWallet)(),i=(0,m.useCallback)((async()=>{if(!c.account.isAddress(e))return s("");const t=await D.deriveDebtAddress(l,e);return s(t)}),[e,l]);return(0,m.useEffect)((()=>{i()}),[i]),{address:t,data:a}};var H=s(21111),V=s.n(H);const W=e=>{const{accounts:t}=(0,n.useAccount)(),{wallet:{address:s}}=(0,n.useWallet)(),a=(0,r.useSelector)((t=>t.farms[e])),[l,i]=(0,m.useState)(),o=(0,m.useCallback)((async()=>{if(!(null===a||void 0===a?void 0:a.mint_stake))return i(void 0);const{splt:e}=window.sentre,r=await e.deriveAssociatedAddress(s,a.mint_stake),n=t[r];return V()(n,null===l||void 0===l?void 0:l.data)?void 0:i({address:r,data:n})}),[null===l||void 0===l?void 0:l.data,t,a.mint_stake,s]);return(0,m.useEffect)((()=>{o()}),[o]),l},K=(e,t)=>{if(null===e||0===Object.keys(e).length)return 0;if(null===t||0===Object.keys(t).length)return 0;if(!t.total_shares)return 0;const r=e.shares,n=t.compensation,a=(s.g.BigInt(Math.floor(Date.now()/1e3))-t.genesis_timestamp)/t.period,l=s.g.BigInt(10**18),i=(l*t.reward/t.total_shares*a+n)*r/l,o=c.utils.undecimalize(i-e.debt,9);return Number(o)},G="The treasury doesn't have enough balance for the claim.",Y="Invalid wallet address.",$="Invalid farm address.",U="Invalid debt address.",J="Cannot fetch data of debts";var X=s(19289),Q=s(42224),q=s(48744),ee=s.n(q),te=s(97429).Buffer;BigInt.prototype.toJSON=function(){return this.toString()};const se={serializableCheck:{isSerializable:e=>"undefined"===typeof e||null===e||"string"===typeof e||"boolean"===typeof e||"number"===typeof e||Array.isArray(e)||(e=>{if(null===e)return!1;const t=Object.getPrototypeOf(e);return null!==t&&null===Object.getPrototypeOf(t)})(e)||"bigint"===typeof e||e instanceof Q.PublicKey||e instanceof ee()||te.isBuffer(e)}};var re=s(33804),ne=s(10119),ae=s(98868);const le=class{constructor(){this._publicKey=new Q.PublicKey("GuestAccount11111111111111111111111111111111"),this._init=async()=>{var e;const t=await(null===(e=this._wallet)||void 0===e?void 0:e.getAddress());t&&(this._publicKey=new Q.PublicKey(t))},this.signTransaction=async e=>this._wallet.signTransaction(e),this.signAllTransactions=async e=>{let t=[];for(const s of e){const e=await this.signTransaction(s);t.push(e)}return t},this._init()}get _wallet(){var e;return null===(e=window.sentre)||void 0===e?void 0:e.wallet}get publicKey(){return console.warn("This is an async getter for interface consistency. Please do not fully rely on this function."),this._publicKey}};var ie=s(97429).Buffer;const oe=e=>ie.from(ne.sha256.digest(`account:${(0,ae.Z)(e,{pascalCase:!0})}`)).slice(0,8),de={version:"0.1.0",name:"sen_utility",instructions:[],accounts:[{name:"farm",type:{kind:"struct",fields:[{name:"owner",type:"publicKey"},{name:"state",type:"u8"},{name:"mintStake",type:"publicKey"},{name:"treasuryStake",type:"publicKey"},{name:"mintReward",type:"publicKey"},{name:"treasuryReward",type:"publicKey"},{name:"genesisTimestamp",type:"i64"},{name:"totalShares",type:"u64"},{name:"reward",type:"u64"},{name:"period",type:"u64"},{name:"compensation",type:"i128"}]}},{name:"debt",type:{kind:"struct",fields:[{name:"farm",type:"publicKey"},{name:"owner",type:"publicKey"},{name:"shares",type:"u64"},{name:"debt",type:"u128"},{name:"isInitialized",type:"bool"}]}}],events:[],errors:[]},ce=()=>{const e=new Q.Connection(n.rpc),t=new le,s=new re.Y7(e,t,{commitment:"confirmed"});return new re.$r(de,p.sol.farmingAddress,s)},{sol:{farming:ue,senAddress:he}}=p,pe="farms",me=(0,X.createAsyncThunk)("farms/getFarms",(async(e,t)=>{let{getState:s}=t;const{farms:r}=s();if(Object.keys(r).length)return r;const n=await ue.connection.getProgramAccounts(ue.farmingProgramId,{filters:[{dataSize:209},{memcmp:{bytes:he,offset:97}}]});let a={};return n.forEach((e=>{let{pubkey:t,account:{data:s}}=e;const r=t.toBase58(),n=(e=>{let t=oe("farm");const s=ce().coder.accounts.decode("farm",ie.concat([t,e]));return{compensation:BigInt(s.compensation.toString()),genesis_timestamp:BigInt(s.genesisTimestamp.toString()),mint_reward:s.mintReward.toString(),mint_stake:s.mintStake.toString(),owner:s.owner.toString(),period:BigInt(s.period.toString()),reward:BigInt(s.reward.toString()),state:s.state,total_shares:BigInt(s.totalShares.toString()),treasury_reward:s.treasuryReward.toString(),treasury_stake:s.treasuryStake.toString()}})(s);a[r]=n})),a})),xe=(0,X.createAsyncThunk)("farms/getFarm",(async(e,t)=>{let{address:s}=e,{getState:r}=t;if(!c.account.isAddress(s))throw new Error("Invalid farm address");const{farms:{[s]:n}}=r();if(n)return{[s]:n};return{[s]:await ue.getFarmData(s)}})),ye=(0,X.createAsyncThunk)("farms/upsetFarm",(async e=>{let{address:t,data:s}=e;if(!c.account.isAddress(t))throw new Error("Invalid farm address");if(!s)throw new Error("Data is empty");return{[t]:s}})),fe=(0,X.createAsyncThunk)("farms/deleteFarm",(async e=>{let{farmAddress:t}=e;if(!c.account.isAddress(t))throw new Error("Invalid address");return{farmAddress:t}})),je=(0,X.createSlice)({name:pe,initialState:{},reducers:{},extraReducers:e=>{e.addCase(me.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(xe.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(ye.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(fe.fulfilled,((e,t)=>{let{payload:s}=t;delete e[s.farmAddress]}))}}).reducer,{sol:{farming:ge}}=p,we="debts",be=(0,X.createAsyncThunk)("debts/getDebts",(async e=>{let{owner:t}=e;if(!c.account.isAddress(t))throw new Error("Invalid owner/wallet address");const s=await ge.connection.getProgramAccounts(ge.farmingProgramId,{filters:[{dataSize:89},{memcmp:{bytes:t,offset:32}}]});let r={};return s.forEach((e=>{let{pubkey:t,account:{data:s}}=e;const n=t.toBase58(),a=(e=>{let t=oe("debt");const s=ce().coder.accounts.decode("debt",ie.concat([t,e]));return{farm:s.farm.toString(),owner:s.owner.toString(),shares:BigInt(s.shares.toString()),debt:BigInt(s.debt.toString()),is_initialized:s.isInitialized}})(s);return r[n]=a})),r})),Ce=(0,X.createAsyncThunk)("debts/getDebt",(async(e,t)=>{let{address:s}=e,{getState:r}=t;const{debts:{[s]:n}}=r();if(n)return{[s]:n};return{[s]:await ge.getDebtData(s)}})),ve=(0,X.createAsyncThunk)("debts/upsetDebt",(async e=>{let{address:t,data:s}=e;if(!c.account.isAddress(t))throw new Error("Invalid address");if(!s)throw new Error("Data is empty");return{[t]:s}})),Se=(0,X.createAsyncThunk)("debts/deleteDebt",(async e=>{let{address:t}=e;if(!c.account.isAddress(t))throw new Error("Invalid address");return{address:t}})),Ae=(0,X.createSlice)({name:we,initialState:{},reducers:{},extraReducers:e=>{e.addCase(be.fulfilled,((e,t)=>{let{payload:s}=t;return s})).addCase(Ce.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(ve.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(Se.fulfilled,((e,t)=>{let{payload:s}=t;delete e[s.address]}))}}).reducer,ke="main",Te=(0,X.createAsyncThunk)("main/setSearch",(async(e,t)=>{let{search:s}=e,{getState:r}=t;return{search:s}})),Ee=(0,X.createSlice)({name:ke,initialState:{search:""},reducers:{},extraReducers:e=>{e.addCase(Te.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)}))}}).reducer,Re=(0,X.configureStore)({middleware:e=>e(se),devTools:!1,reducer:{farms:je,debts:Ae,main:Ee}}),{sol:{farming:_e}}=p;class ze{async checkSeedBalance(e){const{splt:t,wallet:s}=window.sentre;if(!s)throw new Error("Please connect wallet first!");const r=Re.getState().farms[e],n=await s.getAddress();if(!c.account.isAddress(n))throw new Error(Y);const a=await _e.deriveDebtAddress(n,e);if(!c.account.isAddress(a))throw new Error(U);const l=Re.getState().debts[a];if(!l)throw new Error(J);const i=K(l,r),{treasury_reward:o,treasury_stake:d,total_shares:u}=r;let{amount:h}=await t.getAccountData(o);o===d&&(h-=u);if(Number(c.utils.undecimalize(h,9))<i)throw new Error(G)}async validate(e){if(!c.account.isAddress(e))throw new Error($);return await this.checkSeedBalance(e)}}const{sol:{senAddress:Fe,farming:Be}}=p,Pe=e=>{let{farmAddress:t,onClose:s}=e;const a=(0,r.useSelector)((e=>{var s;return null===(s=e.farms)||void 0===s?void 0:s[t]})),{wallet:{address:o}}=(0,n.useWallet)(),{data:d}=L(t),u=W(t),[h,p]=(0,m.useState)(),[x,y]=(0,m.useState)(!0),[f,g]=(0,m.useState)(!1),w=F(a.mint_stake),b=(0,m.useCallback)((async e=>(await p(e),e?await y(!1):await y(!0))),[]),C=(0,m.useMemo)((()=>{if(w)return c.utils.undecimalize(null===d||void 0===d?void 0:d.shares,w)}),[null===d||void 0===d?void 0:d.shares,w]);return(0,j.jsxs)(i.Row,{gutter:[16,16],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Space,{align:"start",children:[(0,j.jsx)(l.Z,{name:"alert-circle-outline"}),(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"The pending reward will be automatically harvested when you unstake."})]})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Card,{bodyStyle:{padding:12},style:{boxShadow:"none",borderRadius:8},children:(0,j.jsxs)(i.Space,{style:{width:"100%"},direction:"vertical",children:[(0,j.jsxs)(i.Row,{children:[(0,j.jsx)(i.Col,{flex:"auto",children:(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"Amount"})}),(0,j.jsx)(i.Col,{children:(0,j.jsxs)(i.Space,{size:6,children:[(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"Available:"}),(0,j.jsx)(i.Typography.Text,{children:n.util.numeric(C).format("0,0.[00]")}),(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"LPT"})]})})]}),(0,j.jsx)(R,{placeholder:"0",value:h,onValue:b,bordered:!1,size:"large",style:{padding:0},suffix:(0,j.jsx)(i.Button,{type:"text",style:{marginRight:-7},onClick:()=>b(C),children:"MAX"}),max:C})]})})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Button,{type:"primary",icon:(0,j.jsx)(l.Z,{name:"remove-outline"}),onClick:async()=>{g(!0);try{const{splt:e,wallet:r}=window.sentre;if(!r)throw Error("Please connect wallet first");if(!h||!u||!w)return;const n=c.utils.decimalize(h,w),a=await e.deriveAssociatedAddress(o,Fe),l=new ze;await l.validate(t);const{txId:i}=await Be.unstake(n,u.address,a,t,r);return s(!1),_("Unstaked",i)}catch(e){return z(e)}finally{g(!1)}},block:!0,disabled:x,loading:f,children:"Unstake"})})]})},{sol:{senAddress:Ie,farming:Me}}=p,Ze=e=>{let{farmAddress:t,onClose:s}=e;const a=(0,r.useSelector)((e=>{var s;return null===(s=e.farms)||void 0===s?void 0:s[t]})),{wallet:{address:o}}=(0,n.useWallet)(),{accounts:d}=(0,n.useAccount)(),{data:u}=L(t),h=W(t),[p,x]=(0,m.useState)(),[y,f]=(0,m.useState)(!0),[g,w]=(0,m.useState)(!1),b=F(a.mint_stake),C=(0,m.useCallback)((async e=>(await x(e),e?await f(!1):await f(!0))),[]),v=(0,m.useMemo)((()=>{if(b)return c.utils.undecimalize(BigInt((null===h||void 0===h?void 0:h.data.amount)||0),b)}),[null===h||void 0===h?void 0:h.data.amount,b]);return(0,j.jsxs)(i.Row,{gutter:[16,16],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Space,{align:"start",children:[(0,j.jsx)(l.Z,{name:"alert-circle-outline"}),(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"The pending reward will be automatically harvested when you stake more."})]})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Card,{bodyStyle:{padding:12},style:{boxShadow:"none",borderRadius:8},children:(0,j.jsxs)(i.Space,{style:{width:"100%"},direction:"vertical",children:[(0,j.jsxs)(i.Row,{children:[(0,j.jsx)(i.Col,{flex:"auto",children:(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"Amount"})}),(0,j.jsx)(i.Col,{children:(0,j.jsxs)(i.Space,{size:6,children:[(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"Available:"}),(0,j.jsx)(i.Typography.Text,{children:n.util.numeric(v).format("0,0.[00]")}),(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"LPT"})]})})]}),(0,j.jsx)(R,{placeholder:"0",value:p,onValue:C,bordered:!1,size:"large",style:{padding:0},suffix:(0,j.jsx)(i.Button,{type:"text",style:{marginRight:-15},onClick:()=>C(v),children:"MAX"}),max:v})]})})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Button,{type:"primary",icon:(0,j.jsx)(l.Z,{name:"add-outline"}),onClick:async()=>{w(!0);try{const{splt:e,wallet:r}=window.sentre;if(!r)throw Error("Please connect wallet first");if(!p||!h||!b)return;const n=await e.deriveAssociatedAddress(o,Ie);void 0===(null===u||void 0===u?void 0:u.shares)&&await Me.initializeAccounts(t,o,r),d[n]||await e.initializeAccount(Ie,o,r);const a=new ze;await a.validate(t);const{txId:l}=await Me.stake(c.utils.decimalize(p,b),h.address,n,t,r);return s(!1),_("Staked",l)}catch(e){return z(e)}finally{w(!1)}},block:!0,disabled:y,loading:g,children:"Stake"})})]})},Oe=e=>{let{title:t}=e;return(0,j.jsxs)(i.Space,{children:[(0,j.jsx)(l.Z,{style:{fontSize:18},name:"alert-circle-outline"}),(0,j.jsx)(i.Typography.Text,{type:"secondary",ellipsis:!0,children:t})]})};var Ne=s(51518),De=s.n(Ne);const Le=e=>{let{address:t,onCopy:s,copieAddress:r,description:n=!1,title:a}=e;return(0,j.jsxs)(i.Row,{gutter:[0,8],children:[(0,j.jsx)(i.Col,{xs:{span:24},sm:{span:10},md:{span:10},lg:{span:10},flex:"auto",children:(0,j.jsx)(Oe,{title:a})}),(0,j.jsx)(i.Col,{xs:{span:22},sm:{span:14},md:{span:14},lg:{span:14},flex:"auto",children:c.account.isAddress(t)&&(0,j.jsx)(i.Typography.Text,{children:t})}),(0,j.jsx)(i.Col,{children:(0,j.jsx)(i.Tooltip,{title:"Copied",visible:t===r,children:(0,j.jsx)(Ne.CopyToClipboard,{text:t,onCopy:e=>s(e),children:(0,j.jsx)(i.Button,{type:"text",size:"small",style:{marginRight:-7},icon:(0,j.jsx)(l.Z,{name:"copy-outline"})})})})}),n?(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Typography.Paragraph,{type:"secondary",style:{fontSize:12},children:"Tips: You can use this address for searching the pool coresponding to the farm in Sen LP."})}):null]})},He=e=>{const[t,s]=(0,m.useState)(0),{farms:{[e]:n}}=(0,r.useSelector)((e=>e)),{treasury_stake:a,treasury_reward:l,mint_reward:i,total_shares:o}=n||{},d=F(i),{symbol:u}=y(i),h=(0,m.useCallback)((async()=>{if(void 0===d)return s(0);try{const{splt:e}=window.sentre;let{amount:t}=await e.getAccountData(l);l===a&&(t-=o);const r=Number(c.utils.undecimalize(t,d));s(r)}catch(e){s(0)}}),[d,o,l,a]);return(0,m.useEffect)((()=>{h()}),[h]),{budget:t,budgetSymbol:u}},Ve=e=>{let{farmAddress:t}=e;const{tokenProvider:s}=(0,n.useMint)(),{pools:a}=(0,n.usePool)(),{budget:l,budgetSymbol:o}=He(t),d=(0,r.useSelector)((e=>e.farms)),[u,h]=(0,m.useState)(""),[p,x]=(0,m.useState)(""),{mint_stake:y,period:f,reward:g,mint_reward:w}=d[t]||{},b=F(y);(0,m.useEffect)((()=>{(async()=>{const{symbol:e}=await s.findByAddress(w)||{};x(e||"TOKEN")})()}),[w,s]);const C=Object.keys(a).find((e=>{const{mint_lpt:t}=a[e];return t===y})),v=async e=>{e&&(await h(e),await n.util.asyncWait(1500),await h(""))},S=(0,m.useMemo)((()=>b?c.utils.undecimalize(g,b):0),[b,g]),A=(0,m.useMemo)((()=>{let e=Number(f)/86400,t="days";return e>29&&(e/=30,t=e>1?"months":"month"),e<2&&(e*=24,t=e>1?"hours":"hour"),`${S} ${o} / ${Math.floor(e)} ${t}`}),[S,f,o]);return(0,j.jsxs)(i.Row,{gutter:[24,24],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(Le,{title:"Farming address:",address:t,onCopy:e=>v(e),copieAddress:u})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(Le,{title:C?"Pool address:":"Stake mint address:",address:C||y,onCopy:e=>v(e),copieAddress:u,description:!0})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Space,{align:"baseline",children:[(0,j.jsx)(Oe,{title:"Rewarding:"}),(0,j.jsx)(i.Typography.Text,{style:{wordBreak:"break-all"},children:A})]})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Space,{align:"baseline",children:[(0,j.jsx)(Oe,{title:"Budget:"}),(0,j.jsx)(i.Typography.Text,{style:{wordBreak:"break-all"},children:n.util.numeric(l).format("0,0.[00]")}),(0,j.jsx)(i.Typography.Text,{type:"secondary",children:p})]})})]})},{sol:{senAddress:We,farming:Ke}}=p,Ge=e=>{let{farmAddress:t,onChange:s=(()=>{})}=e;const{accounts:a}=(0,n.useAccount)(),{wallet:{address:o}}=(0,n.useWallet)(),d=(0,r.useSelector)((e=>e.farms)),[u,h]=(0,m.useState)(""),[p,x]=(0,m.useState)("0"),[y,f]=(0,m.useState)(!1),{mint_reward:g}=(null===d||void 0===d?void 0:d[t])||{},w=F(g);(0,m.useEffect)((()=>{(async()=>{if(w)try{const{splt:e}=window.sentre,t=await e.deriveAssociatedAddress(o,g),{amount:s}=a[t]||{};x(s?c.utils.undecimalize(s,w):"0")}catch(e){x("0")}})()}),[o,a,g,w]);return(0,j.jsxs)(i.Row,{gutter:[16,16],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Card,{style:{boxShadow:"unset",borderRadius:8},bodyStyle:{padding:8},children:(0,j.jsxs)(i.Row,{gutter:[0,0],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Row,{gutter:[0,0],wrap:!1,style:{margin:"6px 12px 0px 12px",fontSize:12},children:[(0,j.jsx)(i.Col,{flex:"auto",children:(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"Amount"})}),(0,j.jsx)(i.Col,{children:(0,j.jsxs)(i.Space,{size:6,children:[(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"Available:"}),(0,j.jsx)(i.Typography.Text,{children:n.util.numeric(p).format("0,0.[00]")}),(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"SNTR"})]})})]})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(R,{placeholder:"0",value:u,onValue:h,suffix:(0,j.jsx)(i.Button,{type:"text",onClick:()=>h(p),size:"small",style:{marginRight:-7},children:"MAX"}),bordered:!1,max:p})})]})})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Button,{type:"primary",icon:(0,j.jsx)(l.Z,{name:"add-outline"}),onClick:async()=>{f(!0);const{wallet:e,splt:r}=window.sentre;if(!e)return;const n=await r.deriveAssociatedAddress(o,We),a=c.utils.decimalize(u,9);try{const{txId:r}=await Ke.seed(a,t,n,e);return s(r),_("Seed",r)}catch(l){return z(l)}finally{f(!1)}},block:!0,disabled:!u,loading:y,children:"Seed"})})]})},{sol:{farming:Ye}}=p,$e=e=>{let{farmAddress:t,onChange:s=(()=>{})}=e;const{wallet:{address:a}}=(0,n.useWallet)(),o=(0,r.useSelector)((e=>e.farms)),[d,u]=(0,m.useState)(""),[h,p]=(0,m.useState)("0"),[x,f]=(0,m.useState)(!1),{treasury_reward:g,mint_reward:w}=o[t]||{},b=F(w),{symbol:C}=y(w);(0,m.useEffect)((()=>{(async()=>{if(b)try{const{splt:e}=window.sentre,{amount:t}=await e.getAccountData(g);p(t?c.utils.undecimalize(t,b):"0")}catch(e){p("0")}})()}),[b,g]);return(0,j.jsxs)(i.Row,{gutter:[16,16],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Card,{style:{boxShadow:"unset",borderRadius:8},bodyStyle:{padding:8},children:(0,j.jsxs)(i.Row,{gutter:[0,0],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Row,{gutter:[0,0],wrap:!1,style:{margin:"6px 12px 0px 12px",fontSize:12},children:[(0,j.jsx)(i.Col,{flex:"auto",children:(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"Amount"})}),(0,j.jsx)(i.Col,{children:(0,j.jsxs)(i.Space,{size:6,children:[(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"Available:"}),(0,j.jsx)(i.Typography.Text,{children:n.util.numeric(h).format("0,0.[00]")}),(0,j.jsx)(i.Typography.Text,{type:"secondary",children:C})]})})]})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(R,{placeholder:"0",value:d,onValue:u,suffix:(0,j.jsx)(i.Button,{type:"text",onClick:()=>u(h),size:"small",style:{marginRight:-7},children:"MAX"}),bordered:!1,max:h})})]})})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Button,{type:"primary",icon:(0,j.jsx)(l.Z,{name:"remove-outline"}),onClick:async()=>{f(!0);const{wallet:e,splt:r}=window.sentre;if(!e||!b)return;const n=await r.deriveAssociatedAddress(a,w),l=c.utils.decimalize(d,b);try{const{txId:r}=await Ye.unseed(l,t,n,e);return s(r),_("Unseed",r)}catch(i){return z(i)}finally{f(!1)}},block:!0,disabled:!d,loading:x,children:"Unseed"})})]})};let Ue,Je;!function(e){e[e.POLICY_AGREEMENT=0]="POLICY_AGREEMENT",e[e.FARM_CREATING_CONFIRMATION=1]="FARM_CREATING_CONFIRMATION"}(Ue||(Ue={})),function(e){e[e.isActive=1]="isActive",e[e.isFreeze=2]="isFreeze"}(Je||(Je={}));const{sol:{farming:Xe}}=p,Qe=e=>{let{farmAddress:t,onChange:s=(()=>{})}=e;const n=(0,r.useSelector)((e=>e.farms)),[a,o]=(0,m.useState)(!1),{state:d}=(null===n||void 0===n?void 0:n[t])||{},c=d===Je.isActive,u=c?{backgroundColor:"#40A9FF",color:"#fff"}:{},h=c?"snow-outline":"sunny-outline",p=c?"Freeze":"Thaw";return(0,j.jsxs)(i.Row,{gutter:[16,16],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Space,{className:"caption",align:"start",children:[(0,j.jsx)(l.Z,{name:"information-circle-outline"}),(0,j.jsx)(i.Typography.Text,{type:"secondary",children:'Freezing a farm will prevent all actions, but "seed" and "unseed", until the farm has been thawed.'})]})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Button,{type:"primary",style:{...u,border:"unset"},icon:(0,j.jsx)(l.Z,{name:h}),onClick:c?async()=>{const{wallet:e}=window.sentre;if(e){o(!0);try{const{txId:r}=await Xe.freeze(t,e);return s(r),_("Freeze the farm",r)}catch(r){return z(r)}finally{o(!1)}}}:async()=>{const{wallet:e}=window.sentre;if(e){o(!0);try{const{txId:r}=await Xe.thaw(t,e);return s(r),_("Thaw the farm",r)}catch(r){return z(r)}finally{o(!1)}}},block:!0,disabled:!d,loading:a,children:p})})]})},{sol:{farming:qe}}=p,et=e=>{let{farmAddress:t,onChange:s=(()=>{})}=e;const n=(0,r.useSelector)((e=>e.farms)),[a,o]=(0,m.useState)(!1),{total_shares:d}=(null===n||void 0===n?void 0:n[t])||{},c=(0,r.useDispatch)();return(0,j.jsxs)(i.Row,{gutter:[16,16],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Space,{className:"caption",children:[(0,j.jsx)(l.Z,{name:"information-circle-outline"}),(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"The farm can be closed only all farmers unstaked their tokens!"})]})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Button,{type:"primary",icon:(0,j.jsx)(l.Z,{name:"trash-outline"}),onClick:async()=>{const{wallet:e}=window.sentre;if(e){o(!0);try{const{txId:r}=await qe.closeFarm(t,e);return s(r),c(fe({farmAddress:t})),_("Close the farm",r)}catch(r){return z(r)}finally{o(!1)}}},block:!0,disabled:!!d,loading:a,children:"Close Farm"})})]})},tt=e=>{let{label:t="",title:s=""}=e;return(0,j.jsxs)(i.Row,{gutter:[16,16],children:[(0,j.jsx)(i.Col,{flex:"auto",children:(0,j.jsx)(i.Typography.Text,{type:"secondary",children:t})}),(0,j.jsx)(i.Col,{children:(0,j.jsx)(i.Typography.Text,{children:s})})]})},st=e=>{let{farmAddress:t}=e;const s=(0,r.useSelector)((e=>{var s;return null===(s=e.farms)||void 0===s?void 0:s[t]})),[a,o]=(0,m.useState)(!1),[d,u]=(0,m.useState)(!1),{budget:h,budgetSymbol:p}=He(t),{mint_stake:x,period:y,reward:f}=s||{},w=F(x),C=(0,m.useMemo)((()=>w?c.utils.undecimalize(f,w):0),[w,f]),v=(0,m.useMemo)((()=>{let e=Number(y)/86400,t="days";return e>29&&(e/=30,t=e>1?"months":"month"),e<2&&(e*=24,t=e>1?"hours":"hour"),`${C} ${p} / ${Math.floor(e)} ${t}`}),[C,y,p]);return(0,j.jsxs)(m.Fragment,{children:[(0,j.jsx)(i.Button,{onClick:()=>o(!0),children:"Manage"}),(0,j.jsx)(i.Modal,{visible:a,onCancel:()=>o(!1),closeIcon:(0,j.jsx)(l.Z,{name:"close"}),footer:null,destroyOnClose:!0,centered:!0,children:(0,j.jsxs)(i.Row,{gutter:[16,16],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Space,{style:{lineHeight:1},children:[(0,j.jsx)(l.Z,{name:"leaf"}),(0,j.jsx)(i.Typography.Title,{level:5,style:{margin:0},children:"Farm Management"})]})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Card,{style:{borderRadius:8},bodyStyle:{padding:16},bordered:!1,children:(0,j.jsxs)(i.Row,{gutter:[8,8],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Row,{gutter:[0,0],children:[(0,j.jsx)(i.Col,{flex:"auto",children:(0,j.jsxs)(i.Space,{size:12,style:{fontWeight:600},children:[(0,j.jsx)(g,{mintAddress:x,size:32}),(0,j.jsx)(b,{mintAddress:x})]})}),(0,j.jsx)(i.Col,{children:(0,j.jsxs)(i.Space,{size:2,children:[(0,j.jsx)(i.Typography.Text,{type:"secondary",style:{fontSize:12},children:n.util.shortenAddress(t)}),(0,j.jsx)(i.Tooltip,{visible:d,title:"Copied",children:(0,j.jsx)(De(),{text:t,children:(0,j.jsx)(i.Button,{type:"text",size:"small",onClick:async()=>{u(!0),await n.util.asyncWait(1500),u(!1)},icon:(0,j.jsx)(l.Z,{name:"copy-outline"})})})}),(0,j.jsx)(i.Button,{type:"text",size:"small",onClick:()=>window.open(n.util.explorer(t),"_blank"),icon:(0,j.jsx)(l.Z,{name:"open-outline"})})]})})]})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(tt,{label:"Budget",title:`${h} ${p}`})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(tt,{label:"Reward",title:v})})]})})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Tabs,{children:[(0,j.jsx)(i.Tabs.TabPane,{tab:"Seed",children:(0,j.jsx)(Ge,{farmAddress:t,onChange:()=>o(!1)})},"seed"),(0,j.jsx)(i.Tabs.TabPane,{tab:"Unseed",children:(0,j.jsx)($e,{farmAddress:t,onChange:()=>o(!1)})},"unseed"),(0,j.jsx)(i.Tabs.TabPane,{tab:"Freeze/Thaw",children:(0,j.jsx)(Qe,{farmAddress:t,onChange:()=>o(!1)})},"freeze-thaw"),(0,j.jsx)(i.Tabs.TabPane,{tab:"Ownership",disabled:!0,children:"TBD"},"ownership"),(0,j.jsx)(i.Tabs.TabPane,{tab:"Close",children:(0,j.jsx)(et,{farmAddress:t,onChange:()=>o(!1)})},"close")]})})]})})]})},{sol:{senAddress:rt,farming:nt}}=p,at=e=>{let{farmAddress:t,onClose:s}=e;const a=(0,r.useSelector)((e=>{var s;return null===(s=e.farms)||void 0===s?void 0:s[t]})),{data:o}=L(t),{wallet:{address:d}}=(0,n.useWallet)(),[u,h]=(0,m.useState)(!1),p=c.utils.undecimalize(null===o||void 0===o?void 0:o.shares,9);return(0,j.jsxs)(i.Row,{gutter:[16,16],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Space,{align:"start",children:[(0,j.jsx)(l.Z,{name:"alert-circle-outline"}),(0,j.jsx)(i.Typography.Text,{children:"When the reward budget is too low, you may be not able to unstake. Exiting the farm means you give up on rewards and merely get back your tokens."})]})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Card,{style:{borderRadius:8,boxShadow:"unset"},bodyStyle:{padding:12},children:(0,j.jsxs)(i.Row,{gutter:[0,0],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Typography.Text,{className:"caption",type:"secondary",children:"Amount"})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(R,{placeholder:"0",value:p,size:"small",bordered:!1})})]})})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Button,{type:"primary",icon:(0,j.jsx)(l.Z,{name:"remove"}),onClick:async()=>{h(!0);const{splt:e,wallet:r}=window.sentre,{mint_stake:n}=a;if(!r||!c.account.isAddress(n))return;const l=await e.deriveAssociatedAddress(d,rt),i=await e.deriveAssociatedAddress(d,n);try{const{txId:e}=await nt.rid(i,l,t,r);return s(!1),_("Exit",e)}catch(o){return z(o)}finally{h(!1)}},block:!0,disabled:!p,loading:u,children:"Exit"})})]})},lt=e=>{const{farms:{[e]:t}}=(0,r.useSelector)((e=>e)),{getTotalValue:s}=C(),[n,a]=(0,m.useState)(0),l=(0,m.useCallback)((async()=>{if(!t)return a(0);const{total_shares:e,mint_stake:r}=t,n=await s({mintAddress:r,amount:e});return a(n)}),[t,s]);return(0,m.useEffect)((()=>{l()}),[l]),n},{sol:{senAddress:it,farming:ot}}=p,dt="The budget of reward is very low. Please unstake your tokens for safety.",ct=e=>{let{farmAddress:t}=e;const s=(0,r.useSelector)((e=>{var s;return null===(s=e.farms)||void 0===s?void 0:s[t]})),{data:o}=L(t),d=(e=>{const t=(0,r.useSelector)((t=>t.farms[e])),{data:s}=L(e),[n,a]=(0,m.useState)(0),l=(0,m.useCallback)((()=>{if(!s||!t)return a(0);const e=K(s,t)||0;return a(e)}),[s,t]);return(0,m.useEffect)((()=>{l()}),[l]),n})(t),u=(e=>{const[t,s]=(0,m.useState)(),{farms:{[e]:a}}=(0,r.useSelector)((e=>e)),{pools:l}=(0,n.usePool)(),i=(0,m.useCallback)((async()=>{const e=null===a||void 0===a?void 0:a.mint_stake;if(!e)return s(void 0);const t=Object.keys(l).find((t=>{const{mint_lpt:s}=l[t];return s===e}));if(!c.account.isAddress(t))return s(void 0);const r=l[t];return s({address:t,data:r})}),[null===a||void 0===a?void 0:a.mint_stake,l]);return(0,m.useEffect)((()=>{i()}),[i]),t})(t),h=lt(t),{apr:p}=(e=>{const t=(0,r.useSelector)((t=>t.farms[e])),s=lt(e),{getTotalValue:n}=C(),[a,l]=(0,m.useState)(0),i=(0,m.useCallback)((async()=>{if(!s)return l(0);const{mint_reward:e,reward:r,period:a}=t,i=r*BigInt(86400)/a,o=await n({mintAddress:e,amount:i});return l(o/s)}),[t,n,s]);return(0,m.useEffect)((()=>{i()}),[i]),{roi:a,apr:365*a}})(t),{ui:{width:x}}=(0,n.useUI)(),{wallet:{address:y}}=(0,n.useWallet)(),f=(0,a.useHistory)(),[w,v]=(0,m.useState)(),[S,A]=(0,m.useState)(!1),[k,T]=(0,m.useState)(!1),[E,R]=(0,m.useState)(!1),[B,P]=(0,m.useState)(""),{owner:I,state:M,reward:Z}=s||{},O=I===y,D=(0,r.useSelector)((e=>e.main.search)),H=M===Je.isFreeze,V=F(null===s||void 0===s?void 0:s.mint_stake),W=F(null===s||void 0===s?void 0:s.mint_stake),{budget:G}=He(t),Y=(0,m.useMemo)((()=>0!==W&&W?Number(c.utils.undecimalize(Z,W)):0),[W,Z]),$=()=>v(w?void 0:t);(0,m.useEffect)((()=>{D&&D===t&&v(D)}),[G,t,Y,D]),(0,m.useEffect)((()=>P(Y?G<3*Y?dt:"":dt)),[G,Y]);const U=()=>(0,j.jsxs)(i.Row,{gutter:[8,8],children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsxs)(i.Space,{size:4,children:[(0,j.jsx)(i.Typography.Title,{style:{color:"#fff"},level:5,children:"APR"}),(0,j.jsx)(i.Typography.Text,{type:"secondary",children:"(Annual Percentage Rate)"})]})}),(0,j.jsx)(i.Col,{children:(0,j.jsx)(i.Typography.Text,{style:{color:"#E9E9EB"},children:"Refers to the simple interest accured from a particular inverstment over a 1 year period."})})]});let J="0";o&&V&&(J=c.utils.undecimalize(o.shares,V));const X=x>768?w?"chevron-down-outline":"chevron-forward-outline":w?"chevron-up-outline":"chevron-down-outline",Q=H?{opacity:.6}:{};return(0,j.jsxs)(i.Row,{style:{...Q},children:[(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Card,{bordered:!1,className:"farming-card",bodyStyle:{padding:16},style:{boxShadow:"unset",borderRadius:8,position:"relative",zIndex:1},hoverable:!0,onClick:$,children:(0,j.jsxs)(i.Row,{gutter:[16,16],justify:"center",align:"middle",children:[(0,j.jsx)(i.Col,{flex:"auto",children:(0,j.jsxs)(i.Row,{gutter:[16,16],align:"middle",children:[(0,j.jsx)(i.Col,{xs:24,md:5,children:(0,j.jsxs)(i.Space,{children:[(0,j.jsx)(g,{mintAddress:null===s||void 0===s?void 0:s.mint_stake,size:24}),(0,j.jsx)(b,{mintAddress:null===s||void 0===s?void 0:s.mint_stake}),(0,j.jsx)(i.Button,{type:"text",shape:"circle",size:"small",icon:(0,j.jsx)(i.Typography.Text,{type:"secondary",children:(0,j.jsx)(l.Z,{name:"information-circle-outline"})}),onClick:e=>{e.stopPropagation(),T(!0)}})]})}),(0,j.jsx)(i.Col,{xs:12,md:4,children:(0,j.jsx)(N,{label:"APR",tooltip:(0,j.jsx)(U,{}),value:n.util.numeric(p).format("0,0.[00]a%")})}),(0,j.jsx)(i.Col,{xs:12,md:5,children:(0,j.jsx)(N,{label:"Liquidity",value:n.util.numeric(h).format("0,0.00[00]a$")})}),(0,j.jsx)(i.Col,{xs:12,md:5,children:(0,j.jsx)(N,{label:"Your staked LPT",value:n.util.numeric(J).format("0,0.00[00]")})}),(0,j.jsx)(i.Col,{xs:12,md:5,children:(0,j.jsx)(N,{mintAddress:null===s||void 0===s?void 0:s.mint_reward,label:"Reward",value:n.util.numeric(d).format("0,0.00[00]")})})]})}),(0,j.jsx)(i.Col,{children:(0,j.jsxs)(i.Space,{children:[H&&(0,j.jsx)(l.Z,{name:"snow-outline"}),B&&(0,j.jsx)(i.Tooltip,{title:dt,children:(0,j.jsx)(l.Z,{name:"warning-outline",style:{color:"#f9575e"}})}),(0,j.jsx)(i.Button,{type:"text",icon:(0,j.jsx)(l.Z,{name:X}),disabled:!O&&H,onClick:$})]})})]})})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(i.Collapse,{activeKey:w,className:"expand-farm-card",children:(0,j.jsx)(i.Collapse.Panel,{header:null,showArrow:!1,children:(0,j.jsxs)(i.Row,{gutter:[16,16],children:[(0,j.jsx)(i.Col,{xs:{order:2},md:{order:1},flex:"auto",children:u&&(0,j.jsxs)(i.Button,{type:"text",style:{padding:0,background:"transparent"},onClick:()=>{f.push(`/app/sen_lp/details?poolAddress=${u.address}`)},children:["To the pool",(0,j.jsx)(l.Z,{name:"chevron-forward-outline"})]})}),(0,j.jsx)(i.Col,{xs:{order:1},md:{order:2},children:(0,j.jsxs)(i.Space,{children:[O&&(0,j.jsx)(st,{farmAddress:t}),(0,j.jsx)(i.Button,{onClick:()=>A(!0),children:"Stake / Unstake"}),(0,j.jsx)(i.Button,{type:"primary",loading:E,onClick:async()=>{R(!0);const{splt:e,wallet:s}=window.sentre,r=await e.deriveAssociatedAddress(y,it);try{if(!s)throw new Error("please connect wallet first!");const e=new ze;await e.validate(t);const{txId:n}=await ot.harvest(t,r,s);return _("Harvest",n)}catch(n){return z(n)}finally{R(!1)}},disabled:H||0===d,children:"Harvest"})]})})]})},t)})}),(0,j.jsx)(i.Modal,{onCancel:()=>A(!1),closeIcon:(0,j.jsx)(l.Z,{name:"close"}),footer:null,title:null,visible:S,children:(0,j.jsxs)(i.Tabs,{defaultActiveKey:H?"exit":"stake",children:[(0,j.jsx)(i.Tabs.TabPane,{tab:"Stake",disabled:H,children:(0,j.jsx)(Ze,{farmAddress:t,onClose:A})},"stake"),(0,j.jsx)(i.Tabs.TabPane,{tab:"Unstake",disabled:H,children:(0,j.jsx)(Pe,{farmAddress:t,onClose:A})},"unstake"),(0,j.jsx)(i.Tabs.TabPane,{tab:"Exit",children:(0,j.jsx)(at,{farmAddress:t,onClose:A})},"exit")]})}),(0,j.jsx)(i.Modal,{visible:k,onCancel:()=>T(!1),closeIcon:(0,j.jsx)(l.Z,{name:"close"}),title:"Farm Info",footer:null,destroyOnClose:!0,centered:!0,children:(0,j.jsx)(Ve,{farmAddress:t})})]})},ut=e=>{const{tokenProvider:t}=(0,n.useMint)(),{sentreFarms:s}=S(),{pools:a}=(0,n.usePool)(),{search:l}=(0,r.useSelector)((e=>e.main)),[i,o]=(0,m.useState)({}),d=(0,m.useCallback)((e=>Object.keys(a).find((t=>a[t].mint_lpt===e))),[a]),c=(0,m.useCallback)((async()=>{const r={},n=(await t.find(l)).map((e=>e.address));Object.keys(e).filter((t=>{if(!l||!a||!e||l.length<3)return!0;const s=e[t],{mint_stake:r}=s,i=d(r);if(i){if(i===l)return!0;const{mint_a:e,mint_b:t}=a[i];if(n.includes(e)||n.includes(t))return!0}return t===l||(n.includes(r)||r===l)})).sort(((t,r)=>!s[t]&&s[r]?1:s[t]&&!s[r]?-1:e[t].total_shares<e[r].total_shares?1:-1)).map((t=>r[t]=e[t])),await o(r)}),[e,d,l,a,s,t]);return(0,m.useEffect)((()=>{c().then((()=>{setTimeout((()=>{(0,T.be)()}),500)}))}),[c]),i},ht=()=>{const{farms:e}=(0,r.useSelector)((e=>e)),t=ut(e),s=(0,m.useMemo)((()=>Object.keys(t)),[t]);return s.length?(0,j.jsx)(i.Row,{gutter:[16,16],children:s.map((e=>(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(T.ZP,{height:84,children:(0,j.jsx)(ct,{farmAddress:e})})},e)))}):(0,j.jsx)(i.Empty,{})},{sol:{senOwners:pt}}=p,mt=()=>{const{sentreFarms:e}=S(),t=ut(e),s=(0,m.useMemo)((()=>Object.keys(t)),[t]),r=(0,m.useMemo)((()=>s.filter((e=>pt.includes(t[e].owner)))),[t,s]),n=(0,m.useMemo)((()=>r.sort(((e,s)=>t[e].total_shares<t[s].total_shares?1:-1))),[t,r]);return 0===n.length?(0,j.jsx)(i.Empty,{}):(0,j.jsx)(i.Row,{gutter:[16,16],children:n.map(((e,t)=>(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(T.ZP,{height:84,children:(0,j.jsx)(ct,{farmAddress:e})})},e+t)))})},{sol:{farming:xt}}=p,yt=()=>{const[e,t]=(0,m.useState)({}),{farms:s,debts:a}=(0,r.useSelector)((e=>e)),{wallet:{address:l}}=(0,n.useWallet)(),i=(0,m.useCallback)((async e=>{const t=await xt.deriveDebtAddress(l,e),s=a[t];return(null===s||void 0===s?void 0:s.shares)>BigInt(0)}),[a,l]),o=(0,m.useCallback)((async e=>{const s={};for(const t in e){await i(t)&&(s[t]=e[t])}t(s)}),[i]);return(0,m.useEffect)((()=>{o(s)}),[s,o]),{stakedFarms:e,filterStakedFarms:o,checkStakedFarm:i}},ft=()=>{const{stakedFarms:e}=yt(),t=ut(e);return 0===Object.keys(t).length?(0,j.jsx)(i.Empty,{}):(0,j.jsx)(i.Row,{gutter:[16,16],children:Object.keys(t).map((e=>(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(T.ZP,{height:84,children:(0,j.jsx)(ct,{farmAddress:e})})},e)))})},jt=()=>{const[e,t]=(0,m.useState)({}),s=(0,r.useSelector)((e=>e.farms)),{wallet:{address:a}}=(0,n.useWallet)(),l=(0,m.useCallback)((e=>s[e].owner===a),[s,a]),i=(0,m.useCallback)((e=>{const s={};for(const t in e)l(t)&&(s[t]=e[t]);t(s)}),[l]);return(0,m.useEffect)((()=>{i(s)}),[s,i]),{yourFarms:e,filterYourFarms:i,checkYourFarm:l}},gt=()=>{const{yourFarms:e}=jt(),t=ut(e);return Object.keys(t).length?(0,j.jsx)(i.Row,{gutter:[16,16],children:Object.keys(t).map((e=>(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(T.ZP,{height:84,children:(0,j.jsx)(ct,{farmAddress:e})})},e)))}):(0,j.jsx)(i.Empty,{})};var wt;!function(e){e.YourFarms="YourFarms",e.SenFarm="SenFarm",e.StakedFarm="StakedFarm",e.AllFarms="AllFarms"}(wt||(wt={}));const bt=()=>{const e=(0,a.useLocation)().search,t=(0,r.useSelector)((e=>e.main.search)),{checkStakedFarm:s}=yt(),{checkYourFarm:n}=jt(),{checkSentreFarm:l}=S(),o=(0,r.useDispatch)(),[d,u]=(0,m.useState)(wt.SenFarm),[h,p]=(0,m.useState)(!1);(0,m.useEffect)((()=>{(async()=>{if(c.account.isAddress(t)&&!h)try{if(n(t))return u(wt.YourFarms);if(l(t))return u(wt.SenFarm);const e=await s(t);u(e?wt.StakedFarm:wt.AllFarms)}catch(e){}finally{p(!0)}})()}),[l,s,n,t,h]),(0,m.useEffect)((()=>{const t=new URLSearchParams(e).get("search");if(t)return o(Te({search:t})),u(wt.AllFarms),()=>{o(Te({search:""}))}}),[o,e]);return(0,j.jsxs)(i.Tabs,{activeKey:d,onChange:e=>{u(e),setTimeout((()=>{(0,T.be)()}),500)},tabBarExtraContent:(0,j.jsx)(O,{}),children:[(0,j.jsx)(i.Tabs.TabPane,{tab:"Sentre Farms",children:(0,j.jsx)(mt,{})},wt.SenFarm),(0,j.jsx)(i.Tabs.TabPane,{tab:"Staked Farms",children:(0,j.jsx)(ft,{})},wt.StakedFarm),(0,j.jsx)(i.Tabs.TabPane,{tab:"Your Farms",children:(0,j.jsx)(gt,{})},wt.YourFarms),(0,j.jsx)(i.Tabs.TabPane,{tab:"All Farms",children:(0,j.jsx)(ht,{})},wt.AllFarms)]})},{sol:{farming:Ct}}=p;let vt=0,St=BigInt(0);const At=e=>{let{children:t}=e;const s=(0,r.useDispatch)(),{wallet:{address:a,lamports:l}}=(0,n.useWallet)(),i=(0,m.useCallback)((async()=>{try{if(!c.account.isAddress(a))return;await s(be({owner:a})).unwrap()}catch(e){await z(e)}}),[s,a]),o=(0,m.useCallback)((async()=>{if(!c.account.isAddress(a))return console.warn("Wallet is not connected");if(vt)return console.warn("Already watched");const e=[{dataSize:89},{memcmp:{bytes:a,offset:32}}];vt=Ct.watch(((e,t)=>{if(e)return console.error(e);const{type:r,address:n,data:a}=t;return"debt"===r?s(ve({address:n,data:a})):void 0}),e)}),[s,a]);return(0,m.useEffect)((()=>{St&&l>St&&s(be({owner:a})),St=l}),[s,a,l]),(0,m.useEffect)((()=>(i(),o(),()=>{(async()=>{try{await Ct.unwatch(vt)}catch(e){}})(),vt=0})),[i,o]),t},{sol:{farming:kt,senAddress:Tt}}=p;let Et=0;const Rt=e=>{let{children:t,style:s={}}=e;const n=(0,r.useDispatch)(),[a,l]=(0,m.useState)(!1),o=(0,m.useCallback)((async()=>{try{l(!0),await n(me()).unwrap()}catch(e){await z(e)}finally{l(!1)}}),[n]),d=(0,m.useCallback)((async()=>{if(Et)return console.warn("Already watched");const e=[{dataSize:209},{memcmp:{bytes:Tt,offset:97}}];Et=kt.watch(((e,t)=>{if(e)return console.error(e);const{type:s,address:r,data:a}=t;return"farm"===s?n(ye({address:r,data:a})):void 0}),e)}),[n]);return(0,m.useEffect)((()=>(o(),d(),()=>{(async()=>{try{kt.unwatch(Et)}catch(e){}})(),Et=0})),[o,d]),(0,j.jsx)(i.Spin,{spinning:a,style:s,children:t})},_t=e=>{let{children:t,style:s}=e;return(0,j.jsx)(Rt,{style:s,children:(0,j.jsx)(At,{children:t})})},{route:{farmRoute:zt}}=p,Ft=()=>{const{search:e,pathname:t}=(0,a.useLocation)(),{search:s}=(0,r.useSelector)((e=>e.main)),n=(0,r.useDispatch)(),o=(0,a.useHistory)();return(0,j.jsx)(_t,{children:(0,j.jsxs)(i.Row,{gutter:[24,24],style:{paddingBottom:12},justify:"center",children:[(0,j.jsx)(i.Col,{xs:24,lg:18,children:(0,j.jsx)(k,{})}),(0,j.jsx)(i.Col,{xs:24,lg:18,children:(0,j.jsxs)(i.Row,{gutter:[8,8],children:[(0,j.jsx)(i.Col,{xs:24,lg:8,children:(0,j.jsx)(i.Card,{bodyStyle:{padding:0},style:{borderRadius:8,background:"transparent",boxShadow:"unset"},children:(0,j.jsx)(i.Input,{placeholder:"Search by name, address",value:s,onChange:s=>(new URLSearchParams(e).get("search")&&o.push(t),n(Te({search:s.target.value}))),prefix:s?(0,j.jsx)(i.Button,{type:"text",style:{width:"auto",height:"auto",background:"transparent"},onClick:()=>(n(Te({search:""})),o.push(zt)),icon:(0,j.jsx)(l.Z,{name:"close-outline"})}):(0,j.jsx)(l.Z,{name:"search-outline"}),bordered:!1,size:"large"})})}),(0,j.jsx)(i.Col,{span:24,children:(0,j.jsx)(bt,{})})]})})]})})};var Bt=s(45597);const{manifest:{appId:Pt}}=p,It=()=>(0,j.jsx)(n.UIProvider,{appId:Pt,antd:!0,children:(0,j.jsx)(n.PoolProvider,{children:(0,j.jsx)(n.MintProvider,{children:(0,j.jsx)(n.AccountProvider,{children:(0,j.jsx)(n.WalletProvider,{children:(0,j.jsx)(r.Provider,{store:Re,children:(0,j.jsx)(Ft,{})})})})})})})},83272:(e,t,s)=>{"use strict";e.exports=s.p+"static/media/README.dd3222bdab290f263138.md"},70854:(e,t,s)=>{"use strict";e.exports=s.p+"static/media/panel.b9f205289419b34b5909.png"},27803:(e,t,s)=>{"use strict";e.exports=s.p+"static/media/panel1.18a27df4f6df24a4cda6.png"},85468:(e,t,s)=>{"use strict";e.exports=s.p+"static/media/panel2.c1dd88a37d9553466530.png"},46601:()=>{},89214:()=>{},85568:()=>{},52361:()=>{},94616:()=>{},55024:()=>{}}]);
//# sourceMappingURL=src_bootstrap_app_tsx.25e49699.chunk.js.map